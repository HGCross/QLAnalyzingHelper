time,user,host,query_time,lock_time,rows_send,rows_examined,query_string
2015-04-27 02:30:57,ishome[ishome],114.207.114.57,302.115452,0.000046,1,1,"select objectname_kor 						,headline 						,origin_path 						,thumb_path 						,pic_mediatime 						,media_type 					from tz_cms_contents where contents_no = '2010727h1822857'; "
2015-04-27 02:30:57,ishome[ishome],192.168.150.41,180.106550,0.000113,1,1,"SELECT d.product_nm               ,b.start_de               ,b.end_de          FROM tz_purchase_student a              ,tz_student  b             ,tz_purchase c             ,tz_product  d         WHERE a.temp_student_no = b.student_no           AND c.PRODUCT_NO      = d.PRODUCT_NO           AND a.PURCHASE_NO     = c.PURCHASE_NO           AND b.student_no = '272749'; "
2015-04-27 02:30:57,ishome[ishome],192.168.150.41,205.183205,0.001318,12,408,"SELECT IFNULL(modu.head_gbn, '') AS head_gbn /*말머리 구분(10129)*/               ,sbj.grade_gbn               ,CASE WHEN sbj.semester_gbn = 3 THEN '공통' ELSE sbj.semester_gbn END AS semester_gbn_nm               ,ishomedb.uf_code_nm(10101, sbj.subj_gbn) AS subj_gbn_nm               ,CASE WHEN modu.head_gbn = 10001 THEN CONCAT(                     CASE                         WHEN                             sbj.subj_gbn = 10021                         THEN                             IFNULL(les.chapter_key, 0)                         ELSE les.sort                     END                     , '장. ', les.subj_lesson_nm) /*예복습*/                     WHEN modu.head_gbn = 10005 AND sbj.subj_gbn = 10023 AND modu.useq = 1 THEN CONCAT(IF(les.subj_no = 174 || les.subj_no = 175, les.chapter_key, les.sort), '장. ', les.subj_lesson_nm, ' (실력기본)')                     WHEN modu.head_gbn = 10005 AND sbj.subj_gbn = 10023 AND modu.useq = 2 THEN CONCAT(IF(les.subj_no = 174 || les.subj_no = 175, les.chapter_key, les.sort), '장. ', les.subj_lesson_nm, ' (실력중급)')                     WHEN modu.head_gbn = 10005 AND sbj.subj_gbn = 10023 AND modu.useq = 3 THEN CONCAT(IF(les.subj_no = 174 || les.subj_no = 175, les.chapter_key, les.sort), '장. ', les.subj_lesson_nm, ' (실력상급)')                      WHEN modu.head_gbn = 10005 THEN CONCAT(les.sort, '장. ', les.subj_lesson_nm, ' (', modu.useq, '회차)') /*실력평가*/                     WHEN modu.head_gbn = 10002 AND sbj.subj_gbn = 10023 AND modu.useq = 1 THEN CONCAT(les.sort, '. ', les.subj_lesson_nm, ' (단원중급)')                      WHEN modu.head_gbn = 10002 AND sbj.subj_gbn = 10023 AND modu.useq = 2 THEN CONCAT(les.sort, '. ', les.subj_lesson_nm, ' (단원상급)')                      WHEN modu.head_gbn = 10002 AND sbj.subj_gbn = 10023 AND modu.useq = 3 THEN CONCAT(les.sort, '. ', les.subj_lesson_nm, ' (단원기본)')                      WHEN modu.head_gbn = 10002 THEN CONCAT(les.sort, '. ', les.subj_lesson_nm, ' (', modu.useq, '회차)') /*단원평가*/                     ELSE CONCAT(les.subj_lesson_nm, ' (', modu.useq, '회차)') /*중기말*/                END AS subj_lesson_nm               ,IF(les.lesson_gbn = 10002 OR les.lesson_gbn = 10003, '', CONCAT(' ', SUBSTRING(les.order_key, 1, 2))) AS unit_no               ,CASE WHEN act.clear_dt IS NOT NULL THEN '완료'                     ELSE (SELECT IF(COUNT(1) = 0, '학습전', '학습중')                           FROM tz_lms_act_element                            WHERE student_no = act.student_no                               AND plan_de = act.plan_de                               AND module_no = modu.module_no                          )                END AS clear_txt               ,CASE WHEN modu.head_gbn = '10001' THEN '0' ELSE '1' END AS lesson_gbn               ,CASE WHEN act.clear_dt IS NOT NULL THEN 'state complete' ELSE 'state imperfective' END AS clear_css                                           /* 완료 여부 표시 css */               ,CASE WHEN act.clear_dt IS NOT NULL THEN 'end'                     ELSE (SELECT IF(COUNT(1) = 0, 'st', 'st02')                           FROM tz_lms_act_element                            WHERE student_no = act.student_no                               AND plan_de = act.plan_de                               AND module_no = modu.module_no                          )                END AS clear_img               ,CASE WHEN act.clear_dt IS NOT NULL THEN '1' ELSE  '0' END AS start_txt /*실력평가분리 후 clear_txt, clear_img와 동일*/               ,'' AS f_test_dt               ,modu.module_no               ,les.subj_no               ,les.subj_lesson_no               ,'' AS sort  /*추가 황진우 한자서당 장표시를 위해*/               ,act.act_dt               ,act.clear_dt               ,pln.plan_de               ,DATE_FORMAT(pln.plan_de,  '%Y') AS yy               ,DATE_FORMAT(pln.plan_de,  '%m') AS mm               ,DATE_FORMAT(pln.plan_de,  '%d') AS dd               ,CASE WHEN DAYNAME(pln.plan_de) = 0 THEN '월'                     WHEN DAYNAME(pln.plan_de) = 1 THEN '화'                     WHEN DAYNAME(pln.plan_de) = 2 THEN '수'                     WHEN DAYNAME(pln.plan_de) = 3 THEN '목'                     WHEN DAYNAME(pln.plan_de) = 4 THEN '금'                     WHEN DAYNAME(pln.plan_de) = 5 THEN '토'                     WHEN DAYNAME(pln.plan_de) = 6 THEN '일'                END AS ww               ,les.contents_xml_type               ,(SELECT IFNULL(SUM(tc.pic_mediatime),0)                      FROM tz_lcms_contents tl                     LEFT OUTER JOIN tz_cms_contents tc ON tc.contents_no = tl.porting_value                     WHERE tl.contents_no = les.contents_no) AS media_time                ,(SELECT IFNULL(SUM(study_time),0)                     FROM tz_lms_act_element                     WHERE student_no = pln.student_no                     AND plan_de = pln.plan_de                     AND module_no = pln.module_no) AS study_duration         FROM ishomedb.tz_lms_plan_module pln             INNER JOIN         ishomedb.tz_lms_module modu ON pln.module_no = modu.module_no             LEFT OUTER JOIN         ishomedb.tz_lms_act_module act ON pln.student_no = act.student_no AND pln.plan_de = act.plan_de AND modu.module_no = act.module_no             INNER JOIN         ishomedb.tz_lcms_study_lesson les ON modu.subj_lesson_no = les.subj_lesson_no AND les.use_yn = 'Y'             INNER JOIN         ishomedb.tz_lms_course cou ON modu.course_no = cou.course_no             INNER JOIN         ishomedb.tz_lcms_subj sbj ON cou.subj_no = sbj.subj_no         WHERE pln.student_no = '272749'             AND pln.plan_de >= '2015.04.27'             AND pln.plan_de <= '2015.05.03'                  UNION ALL                                  SELECT '' AS head_gbn               ,SUBSTRING_INDEX(REPLACE(ishomedb.uf_lcms_theme_category_connect_by_path('-', b.upper_no, 14), '마쓰연산', '마쓰'), '-', 3) AS grade_gbn               ,'1' AS semester_gbn_nm               ,'마쓰' AS subj_gbn_nm               ,b.category_nm AS subj_lesson_nm               ,'' AS unit_no               ,CASE WHEN IFNULL(a.clear_dt, '') != '' THEN '완료' ELSE '학습전' END AS clear_txt                 ,'' AS lesson_gbn               ,CASE WHEN IFNULL(a.clear_dt, '') != '' THEN 'state complete' ELSE 'state imperfective' END AS clear_css                 ,CASE WHEN IFNULL(a.clear_dt, '') != '' THEN 'end' ELSE 'st' END AS clear_img               ,'' AS start_txt               ,'' AS f_test_dt               ,'' AS module_no               ,'' AS subj_no               ,'' AS subj_lesson_no               ,'' AS sort  /*추가 황진우 한자서당 장표시를 위해*/               ,a.act_dt AS act_dt               ,a.clear_dt AS clear_dt               ,a.plan_de               ,DATE_FORMAT(a.plan_de, '%Y') AS yy               ,DATE_FORMAT(a.plan_de, '%m') AS mm               ,DATE_FORMAT(a.plan_de, '%d') AS dd               ,CASE WHEN DAYNAME(a.plan_de) = 0 THEN '월'                     WHEN DAYNAME(a.plan_de) = 1 THEN '화'                     WHEN DAYNAME(a.plan_de) = 2 THEN '수'                     WHEN DAYNAME(a.plan_de) = 3 THEN '목'                     WHEN DAYNAME(a.plan_de) = 4 THEN '금'                     WHEN DAYNAME(a.plan_de) = 5 THEN '토'                     WHEN DAYNAME(a.plan_de) = 6 THEN '일'                END AS ww               ,'' AS contents_xml_type               ,'' AS media_time               ,'' AS study_duration         FROM tz_lcms_plan_math a         INNER JOIN tz_lcms_theme_category b         ON a.category_no = b.category_no          WHERE a.student_no = '272749'             AND a.plan_de >= '2015.04.27'             AND a.plan_de <= '2015.05.03'                  UNION ALL                  SELECT '' AS head_gbn               ,SUBSTRING_INDEX(REPLACE(REPLACE(                   ishomedb.uf_lcms_theme_category_connect_by_path('-', ltm.category_no, 7), '심화특별학습', '심화'), '선사시대 ~ 통일신라', '~통일신라'), '-', 5                ) AS grade_gbn               ,'1' AS semester_gbn_nm               ,'테마자료' AS subj_gbn_nm               ,ltm.title AS subj_lesson_nm               ,'' AS unit_no               ,CASE WHEN IFNULL(lpt.clear_dt, '') != '' THEN '완료' ELSE IF(lpt.act_dt<>'','학습중','학습전') END AS clear_txt                 ,'' AS lesson_gbn     /* 학습시작일 */               ,CASE WHEN IFNULL(lpt.clear_dt, '') != '' THEN 'state complete' ELSE 'state imperfective' END AS clear_css                 ,CASE WHEN IFNULL(lpt.clear_dt, '') != '' THEN 'end' ELSE IF(lpt.act_dt<>'','st02','st') END AS clear_img               ,'' AS start_txt               ,'' AS f_test_dt               ,'' AS module_no               ,'' AS subj_no               ,'' AS subj_lesson_no               , ltm.sort               ,lpt.act_dt AS act_dt               ,lpt.clear_dt AS clear_dt               ,lpt.plan_de               ,DATE_FORMAT(lpt.plan_de, '%Y') AS yy               ,DATE_FORMAT(lpt.plan_de, '%m') AS mm               ,DATE_FORMAT(lpt.plan_de, '%d') AS dd               ,CASE WHEN DAYNAME(lpt.plan_de) = 0 THEN '월'                     WHEN DAYNAME(lpt.plan_de) = 1 THEN '화'                     WHEN DAYNAME(lpt.plan_de) = 2 THEN '수'                     WHEN DAYNAME(lpt.plan_de) = 3 THEN '목'                     WHEN DAYNAME(lpt.plan_de) = 4 THEN '금'                     WHEN DAYNAME(lpt.plan_de) = 5 THEN '토'                     WHEN DAYNAME(lpt.plan_de) = 6 THEN '일'                END AS ww               ,'' AS contents_xml_type               ,'' AS media_time               ,'' AS study_duration         FROM tz_lms_plan_theme lpt         INNER JOIN tz_lcms_theme_material ltm         ON lpt.material_no = ltm.material_no         WHERE lpt.student_no = '272749'             AND lpt.plan_de >= '2015.04.27'             AND lpt.plan_de <= '2015.05.03'         ORDER BY plan_de; "
2015-04-27 02:32:32,ishome[ishome],114.207.114.57,418.544940,0.001370,27059,252656,"SELECT		sd.dictionary_no                                 ,date_format(l.reg_dt,'%Y%m%d%H%i%s') as Date                                ,concat(s.grade_gbn, '-', s.semester_gbn) as grade_semester_gbn 							   ,concat(s.grade_gbn, '-', s.semester_gbn) as grade_semester_gbn                                ,s.subj_gbn                                ,ishomedb.uf_code_subj_nm(s.subj_gbn)         AS subj_nm                                ,l.subj_lesson_nm                                ,(select porting_value from ishomedb.tz_lcms_contents lc where contents_no = sd.contents_no ) as porting_value                                ,l.subj_lesson_no                                ,l.subj_lesson_nm  							   ,l.subj_no 							   ,ishomedb.uf_code_subj_nm(s.subj_gbn)         AS subj_nm 							   ,ishomedb.uf_code_local_nm(s.local_gbn)       AS local_nm 							   ,ishomedb.uf_code_approval_nm(s.approval_gbn) AS approval_nm 							   ,l.upper_no 							   ,l.lvl 							   ,l.reg_id                                ,s.textbook_dic_yn 							   ,(select porting_value from ishomedb.tz_lcms_contents lc where contents_no = sd.contents_no ) as porting_value  							   ,l.subj_no                                ,l.subj_lesson_no                                ,concat('학습사전>교과서사전>', ishomedb.uf_code_subj_nm(s.subj_gbn), '>', s.grade_gbn,  							          case when s.semester_gbn = 3 then '학년' else concat('-', s.semester_gbn) end,                                         (select uf_lcms_study_lesson_connect_by_path('>', l.subj_lesson_no, 1) as path                                        from tz_lcms_study_lesson                                        where subj_lesson_no = l.subj_lesson_no)                                     ) as path 								,sd.dictionary_no 								,'교과서사전' as CATENAME1 				FROM   ishomedb.tz_lcms_study_lesson l 						INNER  JOIN ishomedb.tz_lcms_subj s 						ON     l.subj_no = s.subj_no 						AND    s.textbook_dic_yn IN ('C', 'U') 						LEFT   OUTER JOIN ishomedb.tz_lcms_study_dictionary sd 						ON     l.subj_lesson_no = sd.subj_lesson_no 						AND    sd.dictionary_type = 1 				WHERE  (lesson_gbn IS NULL 							OR  (l.lesson_gbn != 10002 							AND  l.lesson_gbn != 10003)) 						AND s.textbook_dic_yn is not null 						AND sd.dictionary_type = 1 						AND sd.dictionary_no IS NOT NULL 						AND l.use_yn  = 'Y'; "
2015-04-27 02:37:43,ishome[ishome],114.207.114.57,299.813367,0.000104,1,7329,"SELECT concat(sk.subj_knd_nm_short, ' ', bp.start_page, '~', bp.end_page) as result 					 FROM ishomedb.tz_lcms_book_page bp 					 INNER JOIN ishomedb.tz_lcms_subj_knd sk 					 ON sk.subj_knd_no = bp.subj_knd_no 					 WHERE EXISTS ( 								 SELECT 1 								 FROM ishomedb.tz_lcms_study_lesson l 								 INNER JOIN ishomedb.tz_lcms_subj s 								 ON l.subj_no = s.subj_no 								 WHERE l.subj_lesson_no = bp.subj_lesson_no 								 and l.subj_no = 25 								 and l.subj_lesson_no = 1414 							 ); "
2015-04-27 02:37:57,ishome[ishome],114.207.114.57,320.325074,0.001295,4360,72088,"SELECT		sd.dictionary_no                                 ,date_format(l.reg_dt,'%Y%m%d%H%i%s') as Date                                ,concat(s.grade_gbn, '-', s.semester_gbn) as grade_semester_gbn 							   ,concat(s.grade_gbn, '-', s.semester_gbn) as grade_semester_gbn                                ,s.subj_gbn                                ,ishomedb.uf_code_subj_nm(s.subj_gbn)         AS subj_nm                                ,l.subj_lesson_nm                                ,(select porting_value from ishomedb.tz_lcms_contents lc where contents_no = sd.contents_no ) as porting_value                                ,l.subj_lesson_no                                ,l.subj_lesson_nm  							   ,l.subj_no 							   ,ishomedb.uf_code_subj_nm(s.subj_gbn)         AS subj_nm 							   ,ishomedb.uf_code_local_nm(s.local_gbn)       AS local_nm 							   ,ishomedb.uf_code_approval_nm(s.approval_gbn) AS approval_nm 							   ,l.upper_no 							   ,l.lvl 							   ,l.reg_id                                ,s.basic_ency_yn 							   ,(select porting_value from ishomedb.tz_lcms_contents lc where contents_no = sd.contents_no ) as porting_value  							   ,l.subj_no                                ,l.subj_lesson_no                                ,concat('학습사전>기본학습백과>', ishomedb.uf_code_subj_nm(s.subj_gbn), '>', s.grade_gbn,  							           case when s.semester_gbn = 3 then '학년' else concat('-', s.semester_gbn) end,                                         (select uf_lcms_study_lesson_connect_by_path('>', l.subj_lesson_no, 1) as path                                        from tz_lcms_study_lesson                                        where subj_lesson_no = l.subj_lesson_no)                                     ) as path                                ,sd.dictionary_no 								,'기본학습백과' as CATENAME1 				FROM   ishomedb.tz_lcms_study_lesson l 						INNER  JOIN ishomedb.tz_lcms_subj s 						ON     l.subj_no = s.subj_no 						AND    s.basic_ency_yn IN ('C', 'U') 						LEFT   OUTER JOIN ishomedb.tz_lcms_study_dictionary sd 						ON     l.subj_lesson_no = sd.subj_lesson_no 						AND    sd.dictionary_type = 2 				WHERE  (lesson_gbn IS NULL 							OR  (l.lesson_gbn != 10002 							AND  l.lesson_gbn != 10003)) 						AND s.textbook_dic_yn is not null 						AND sd.dictionary_type = 2 						AND l.use_yn  = 'Y'; "
2015-04-27 02:43:23,ishome[ishome],114.207.114.57,322.494332,0.000675,6245,58901,"SELECT		sd.dictionary_no 								,date_format(sd.reg_dt,'%Y%m%d%H%i%s') as Date                                 ,'' as CATECODE2                                 ,'' as CATENAME2                                 ,'' as CATECODE3 								,'' as CATENAME3 							   ,'' as subj_lesson_nm 							   ,(select porting_value from ishomedb.tz_lcms_contents lc where contents_no = sd.contents_no ) as porting_value 							   ,sd.subj_lesson_no 							   ,'' as subj_lesson_nm 							   ,'' as subj_no  							   ,'' as  subj_nm 							   ,'' as local_nm 							   ,'' as approval_nm 							   ,'' as upper_no 							   ,'' as lvl 							   ,'' as reg_id                                ,'U' as DATA_YN 							   ,lc.porting_value                                ,'' as ACRO                                ,concat('학습사전>',(select uf_lcms_theme_category_connect_by_path('>',category_no, 7) from tz_lcms_theme_category where category_no = sd.deep_category_no)) AS PATH 							   ,sd.dictionary_no 							   ,'심화학습백과' as CATENAME1 				FROM   ishomedb.tz_lcms_study_dictionary sd 						LEFT	OUTER JOIN tz_lcms_contents lc 						ON     lc.contents_no = sd.contents_no 						AND    sd.contents_no IS NOT NULL 				WHERE  sd.dictionary_type = 3 						AND sd.dictionary_no IS NOT NULL 						AND sd.deep_category_no IS NOT NULL; "
2015-04-27 02:44:06,ishome[ishome],114.207.114.57,37.315899,0.000123,211580,211580,"SELECT		ed_id as DOCID 									,'' as Date 									,'' as CATECODE2 									,'' as CATENAME2 									,'' as CATECODE3 									,'' as CATENAME3 									,entryname as SUB_TITLE 									,'' as CONTENT_NO 									,'' as SUBJ_LESSON_NO 									,'' as SUBJ_LESSON_NM 									,'' as SUBJ_NO 									,'' as SUBJ_NM 									,pronoun1 as LOCAL_NM 									,'' as APPROVAL_NM 									,'' as UPPER_NO 									,'' as LEVEL 									,'' as REG_ID 									,'' as DATA_YN 									,searchword1 as TITLE 									,body as CONTENT 									,'' as SERVICE_PATH 									,'' as THUMB_PATH 									,'' as MEDIA_TIME 									,'' as MEDIA_TYPE 									,'' as ACRO 									,'' as CATE_LEVEL 									,ed_id as KEYVALUE 									,'영어사전' as CATENAME1 						FROM		tz_english_dictionary 						WHERE		ed_id is not null; "
2015-04-27 02:44:41,ishome[ishome],114.207.114.57,31.828116,0.000135,234174,234174,"SELECT		id as DOCID 								,'' as Date 								,'' as CATECODE2 								,'' as CATENAME2 								,'' as CATECODE3 								,'' as CATENAME3 								,entryname as SUB_TITLE 								,'' as CONTENT_NO 								,'' as SUBJ_LESSON_NO 								,'' as SUBJ_LESSON_NM 								,'' as SUBJ_NO 								,hanja as SUBJ_NM 								,pronoun as LOCAL_NM 								,'' as APPROVAL_NM 								,'' as UPPER_NO 								,'' as LEVEL 								,'' as REG_ID 								,'' as DATA_YN 								,searchword as TITLE 								,body as CONTENT 								,'' as SERVICE_PATH 								,'' as THUMB_PATH 								,'' as MEDIA_TIME 								,'' as MEDIA_TYPE 								,'' as ACRO 								,'' as CATE_LEVEL 								,id as KEYVALUE 								,'국어사전' as CATENAME1 					FROM		tz_korea_dictionary 					WHERE		id is not null; "
2015-04-27 02:47:02,ishome[ishome],114.207.114.57,6.438351,0.002527,2,9833958,"SELECT  concat(sh.homework_no, cc2.contents_no) AS DOCID 									, date_format(l.reg_dt,'%Y%m%d%H%i%s') AS Date 									, 'HOMEWORK' AS SUBJECT 									, ishomedb.uf_code_subj_nm(s.subj_gbn) AS SUBJ_TITLE 									, cc2.contents_no 									, l.subj_no 									, l.subj_lesson_no 									, concat('학교숙제해결>숙제자료>' 										  , ishomedb.uf_code_subj_nm(s.subj_gbn), '>' 										  , s.grade_gbn, case when s.semester_gbn = 3 then '학년' else concat('-', s.semester_gbn) end 										  , ( 												SELECT uf_lcms_study_lesson_connect_by_path('>', l.subj_lesson_no,	1) as path 																  FROM	 tz_lcms_study_lesson 																  WHERE  subj_lesson_no	= l.subj_lesson_no 											) 									) AS CATE_LEVEL 									, '숙제자료' AS CATENAME1 									, cc2.org_vector AS URL 									, 'HOMEWORK' AS CATECODE1 						FROM    ( 														SELECT	ishomedb.uf_lcms_study_lesson_connect_by(@maxlevel)	AS id 															   ,CAST(@level	AS SIGNED) AS hlvl 														FROM   ( 																SELECT	@start_with	:= 0, 																		@id			:= @start_with, 																		@level		:= 0, 																		@maxlevel	:= 5 															   ) vars, ishomedb.tz_lcms_study_lesson 														WHERE	@id	IS NOT NULL 													   ) cb 								INNER JOIN ishomedb.tz_lcms_study_lesson l 								ON    l.subj_lesson_no = cb.id 								INNER JOIN ishomedb.tz_lcms_subj s 								ON    s.subj_no = l.subj_no 								AND   s.homework_data_yn = 'U' 								INNER JOIN ishomedb.tz_lcms_subj_homework sh   								ON    sh.subj_lesson_no = cb.id 								INNER JOIN ishomedb.tz_lcms_contents lc 								ON    lc.contents_no = sh.contents_no 								INNER JOIN ishomedb.tz_cms_contents cc 								ON    cc.contents_no = lc.porting_value 								INNER JOIN ishomedb.tz_cms_contents_code cct 								ON    cct.contents_no = cc.contents_no 								AND   cct.contents_type = 5 								INNER JOIN ishomedb.tz_cms_contents cc2 								ON    cc2.contents_no = cct.code 								AND   cc2.media_type = 'MOD' 						 WHERE  (lesson_gbn IS NULL OR (l.lesson_gbn != 10002 AND l.lesson_gbn != 10003))  										AND l.use_yn  = 'Y' 								AND lc.porting_value IS NOT NULL 								AND cc2.contents_no IS NOT NULL 						UNION ALL 						SELECT  concat(sd.dictionary_no, cc2.contents_no) AS DOCID 									, date_format(l.reg_dt,'%Y%m%d%H%i%s') AS Date 									, 'TEXTBOOK' AS SUBJECT 									, ishomedb.uf_code_subj_nm(s.subj_gbn) AS SUBJ_TITLE 									, cc2.contents_no 									, l.subj_no 									, l.subj_lesson_no 									, concat('학습사전>교과서사전>' 									, ishomedb.uf_code_subj_nm(s.subj_gbn), '>' 									, s.grade_gbn, case when s.semester_gbn = 3 then '학년' else concat('-', s.semester_gbn) end 									, ( 												SELECT uf_lcms_study_lesson_connect_by_path('>', l.subj_lesson_no,	1) as path 																  FROM	 tz_lcms_study_lesson 																  WHERE  subj_lesson_no	= l.subj_lesson_no 											) 									) AS CATE_LEVEL 									, '교과서사전' AS CATENAME1 									, cc2.org_vector AS URL 									, 'TEXTBOOK' AS CATECODE1 						FROM    ( 											  SELECT	ishomedb.uf_lcms_study_lesson_connect_by(@maxlevel)	AS id 															  , CAST(@level	AS SIGNED) AS hlvl 												FROM    ( 																	SELECT	@start_with	:= 0 														, @id	:= @start_with 														, @level := 0 														, @maxlevel	:= 5 															   ) vars 											 , ishomedb.tz_lcms_study_lesson 												WHERE	@id	IS NOT NULL 										) cb 								INNER JOIN ishomedb.tz_lcms_study_lesson l 								ON    l.subj_lesson_no = cb.id 								INNER JOIN ishomedb.tz_lcms_subj s 								ON    s.subj_no = l.subj_no 								AND   s.textbook_dic_yn IN ('C', 'U') 								INNER JOIN ishomedb.tz_lcms_study_dictionary sd 								ON    sd.subj_lesson_no = cb.id 								AND   sd.dictionary_type = 1 								INNER JOIN ishomedb.tz_lcms_contents lc 								ON    lc.contents_no = sd.contents_no 								INNER JOIN ishomedb.tz_cms_contents cc 								ON    cc.contents_no = lc.porting_value 								INNER JOIN ishomedb.tz_cms_contents_code cct 								ON    cct.contents_no = cc.contents_no 								AND   cct.contents_type = 5 								INNER JOIN ishomedb.tz_cms_contents cc2 								ON    cc2.contents_no = cct.code 								AND   cc2.media_type = 'MOD' 						 WHERE  (lesson_gbn IS NULL OR (l.lesson_gbn != 10002 AND l.lesson_gbn != 10003))  										AND l.use_yn  = 'Y' 								AND lc.porting_value IS NOT NULL 								AND cc2.contents_no IS NOT NULL 						UNION ALL 						SELECT  concat(sd.dictionary_no, cc2.contents_no) AS DOCID 									, date_format(l.reg_dt,'%Y%m%d%H%i%s') AS Date 									, 'BASIC' AS SUBJECT 									, ishomedb.uf_code_subj_nm(s.subj_gbn) AS SUBJ_TITLE 									, cc2.contents_no 									, l.subj_no 									, l.subj_lesson_no 									, concat('학습사전>기본학습백과>' 										  , ishomedb.uf_code_subj_nm(s.subj_gbn), '>' 										  , s.grade_gbn, case when s.semester_gbn = 3 then '학년' else concat('-', s.semester_gbn) end 										  , ( 												SELECT uf_lcms_study_lesson_connect_by_path('>', l.subj_lesson_no,	1) as path 																  FROM	 tz_lcms_study_lesson 																  WHERE  subj_lesson_no	= l.subj_lesson_no 											) 									) AS CATE_LEVEL 									, '기본학습백과' AS CATENAME1 									, cc2.org_vector AS URL 									, 'BASIC' AS CATECODE1 						FROM    ( 											  SELECT	ishomedb.uf_lcms_study_lesson_connect_by(@maxlevel)	AS id 															  , CAST(@level	AS SIGNED) AS hlvl 												FROM    ( 																	SELECT	@start_with	:= 0 														, @id	:= @start_with 														, @level := 0 														, @maxlevel	:= 5 															   ) vars 											 , ishomedb.tz_lcms_study_lesson 												WHERE	@id	IS NOT NULL 										) cb 								INNER JOIN ishomedb.tz_lcms_study_lesson l 								ON    l.subj_lesson_no = cb.id 								INNER JOIN ishomedb.tz_lcms_subj s 								ON    s.subj_no = l.subj_no 								AND   s.textbook_dic_yn IN ('C', 'U') 								INNER JOIN ishomedb.tz_lcms_study_dictionary sd 								ON    sd.subj_lesson_no = cb.id 								AND   sd.dictionary_type = 2 								INNER JOIN ishomedb.tz_lcms_contents lc 								ON    lc.contents_no = sd.contents_no 								INNER JOIN ishomedb.tz_cms_contents cc 								ON    cc.contents_no = lc.porting_value 								INNER JOIN ishomedb.tz_cms_contents_code cct 								ON    cct.contents_no = cc.contents_no 								AND   cct.contents_type = 5 								INNER JOIN ishomedb.tz_cms_contents cc2 								ON    cc2.contents_no = cct.code 								AND   cc2.media_type = 'MOD' 						 WHERE  (lesson_gbn IS NULL OR (l.lesson_gbn != 10002 AND l.lesson_gbn != 10003))  										AND l.use_yn  = 'Y' 								AND lc.porting_value IS NOT NULL 								AND cc2.contents_no IS NOT NULL 						UNION ALL 						SELECT	concat(sd.dictionary_no, cc2.contents_no) AS DOCID 									, date_format(sd.reg_dt,'%Y%m%d%H%i%s') AS Date 									, 'DEEP' AS SUBJECT 									, '' AS SUBJ_TITLE 									, cc2.contents_no 									, '' AS subj_no 									, '' AS subj_lesson_no 									, ( 											  select uf_lcms_theme_category_connect_by_path('>',category_no, 7)  											  from tz_lcms_theme_category  											  where category_no = sd.deep_category_no 									) AS CATE_LEVEL 									, '심화학습백과' AS CATENAME1 									, cc2.org_vector AS URL    									, 'DEEP' AS CATECODE1 						FROM    ishomedb.tz_lcms_study_dictionary sd 								LEFT OUTER JOIN tz_lcms_contents lc 								ON    lc.contents_no = sd.contents_no 								AND   sd.contents_no IS NOT NULL 								INNER JOIN ishomedb.tz_cms_contents cc 								ON    lc.porting_value = cc.contents_no 								INNER JOIN ishomedb.tz_cms_contents_code cct 								ON    cc.contents_no = cct.contents_no 								AND   cct.contents_type = 5 								INNER JOIN ishomedb.tz_cms_contents cc2 								ON    cct.code = cc2.contents_no 								AND   cc2.media_type = 'MOD' 						WHERE   sd.dictionary_type = 3 								AND sd.deep_category_no IS NOT NULL 								AND lc.porting_value IS NOT NULL 								AND cc2.contents_no IS NOT NULL; "
2015-04-27 02:52:30,ishome[ishome],114.207.114.57,300.732065,0.000049,1,1,"select objectname_kor 						,headline 						,org_vector as service_path 						,thumb_path 						,pic_mediatime 						,media_type 					from tz_cms_contents where contents_no = '2081103w5309796'; "
2015-04-27 02:52:41,ishome[ishome],114.207.114.57,318.270449,0.001301,3689,40613,"SELECT sh.homework_no 						   ,date_format(l.reg_dt,'%Y%m%d%H%i%s') as Date 						   ,concat(s.grade_gbn, '-', s.semester_gbn) as grade_semester_gbn 						   ,concat(s.grade_gbn, '-', s.semester_gbn) as grade_semester_gbn 						   ,s.subj_gbn 						   ,ishomedb.uf_code_subj_nm(s.subj_gbn)         AS subj_nm 						   ,sh.title 						   ,(select porting_value from ishomedb.tz_lcms_contents lc where contents_no = sh.contents_no) as porting_value 						   ,l.subj_lesson_no 						   ,l.subj_lesson_nm 						   ,l.subj_no 						   ,ishomedb.uf_code_subj_nm(s.subj_gbn)         AS subj_nm 						   ,ishomedb.uf_code_local_nm(s.local_gbn)       AS local_nm 						   ,ishomedb.uf_code_approval_nm(s.approval_gbn) AS approval_nm 						   ,l.upper_no 						   ,l.lvl 						   ,l.reg_id 						   ,s.homework_data_yn 						   ,(select porting_value from ishomedb.tz_lcms_contents lc where contents_no = sh.contents_no) as porting_value 						   ,l.subj_no 						   ,l.subj_lesson_no 						   ,concat('학교숙제해결>숙제자료>',ishomedb.uf_code_subj_nm(s.subj_gbn),'>', s.grade_gbn,  						       case when s.semester_gbn = 3 then '학년' else concat('-', s.semester_gbn) end,  (select uf_lcms_study_lesson_connect_by_path('>', l.subj_lesson_no, 1) as path 								   from tz_lcms_study_lesson 								   where subj_lesson_no = l.subj_lesson_no)) as path 							,sh.homework_no 						   ,'' as placeCount 						   ,'숙제자료' as CATENAME1 					FROM   ishomedb.tz_lcms_study_lesson l 					INNER  JOIN ishomedb.tz_lcms_subj s 					ON     l.subj_no = s.subj_no 					AND    s.homework_data_yn = 'U' 					AND    l.lvl = 1 					LEFT   OUTER JOIN ishomedb.tz_lcms_subj_homework sh 					ON     l.subj_lesson_no = sh.subj_lesson_no 					 WHERE  (lesson_gbn IS NULL 						OR  (l.lesson_gbn != 10002 						AND  l.lesson_gbn != 10003)) 						and sh.homework_no is not null 						and sh.use_yn  = 'Y'; "
2015-04-27 02:53:44,ishome[ishome],114.207.114.57,59.732959,0.001747,8116,1689738,"SELECT        sd.dictionary_no 								   ,date_format(l.reg_dt,'%Y%m%d%H%i%s') as Date 								   ,concat(s.grade_gbn, '-', s.semester_gbn) as grade_semester_gbn 								   ,concat(s.grade_gbn, '-', s.semester_gbn) as grade_semester_gbn 								   ,s.subj_gbn 								   ,ishomedb.uf_code_subj_nm(s.subj_gbn)         AS subj_nm 								   ,l.subj_lesson_nm 								   ,(select porting_value from ishomedb.tz_lcms_contents lc where contents_no = sd.contents_no) as porting_value 								   ,l.subj_lesson_no 								   ,l.subj_lesson_nm 								   ,l.subj_no 								   ,ishomedb.uf_code_subj_nm(s.subj_gbn)         AS subj_nm 								   ,ishomedb.uf_code_local_nm(s.local_gbn)       AS local_nm 								   ,ishomedb.uf_code_approval_nm(s.approval_gbn) AS approval_nm 								   ,l.upper_no 								   ,l.lvl 								   ,l.reg_id 								   ,s.core_junkwa_yn 								   ,(select porting_value from ishomedb.tz_lcms_contents lc where contents_no = sd.contents_no) as porting_value 								   ,l.subj_no 								   ,l.subj_lesson_no 								  ,concat('학교숙제해결>핵심전과>', ishomedb.uf_code_subj_nm(s.subj_gbn), '>', s.grade_gbn,  								         case when s.semester_gbn = 3 then '학년' else concat('-', s.semester_gbn) end,                                         (select uf_lcms_study_lesson_connect_by_path('>', l.subj_lesson_no, 1) as path                                        from tz_lcms_study_lesson                                        where subj_lesson_no = l.subj_lesson_no)                                     ) as path 								   ,l.subj_lesson_no 								   ,'' as placeCount 								   ,'핵심전과' as CATENAME1 					FROM			( 									SELECT  ishomedb.uf_lcms_study_lesson_connect_by(@maxlevel) AS id 										   ,CAST(@level AS SIGNED) AS hlvl 									FROM   ( 											SELECT  @start_with := 0, 													@id         := @start_with, 													@level      := 0, 													@maxlevel   := 5 										   ) vars, ishomedb.tz_lcms_study_lesson 									WHERE   @id IS NOT NULL 								   ) cb 									INNER  JOIN ishomedb.tz_lcms_study_lesson l 									ON     l.subj_lesson_no = cb.id 									INNER  JOIN ishomedb.tz_lcms_subj s 									ON     l.subj_no = s.subj_no 									AND    s.core_junkwa_yn IN('C', 'U')                                                                         AND    s.use_yn = 'Y' 									LEFT   OUTER JOIN ishomedb.tz_code c 									ON     c.code_gbn = 10104 									AND    c.code_no  = l.lesson_gbn 									LEFT   OUTER JOIN ishomedb.tz_lcms_dic_essence sd 									ON     sd.subj_lesson_no = cb.id 					 WHERE			(lesson_gbn IS NULL 									OR  (l.lesson_gbn != 10002 									AND  l.lesson_gbn != 10003)) 									AND sd.dictionary_no is not null 									AND sd.use_yn  = 'Y'; "
2015-04-27 02:54:06,ishome[ishome],114.207.114.57,14.118848,0.000215,9564,88408,"SELECT  c.codeid as DOCID 							,case b.reg_date when '' then '19710101000000' else  date_format(b.reg_date,'%Y%m%d%H%i%s') end as Date 							,c.parentid 							,(select name from ishomedb.tz_cms_common_code where codeid = c.parentid) as name 							,'' as CATECODE3 							,'' as CATENAME3 							,'' as SUB_TITLE 							,b.contents_no 							,'' as SUBJ_LESSON_NO 							,'' as SUBJ_LESSON_NM 							,'' as SUBJ_NO 							,'' as SUBJ_NM 							,'' as LOCAL_NM 							,'' as APPROVAL_NM 							,'' as UPPER_NO 							,'' as LEVEL 							,b.reg_id 							,'' as DATA_YN 							,b.objectname_kor 							,b.headline 							,b.service_path 							,b.thumb_path 							,b.pic_mediatime 							,b.media_type 							,'' as ACRO 							,'' as CATE_LEVEL 							,b.contents_no 							,b.contents_no 							,b.contents_no 							,'우리지역사진' as CATENAME1  					FROM   ishomedb.tz_cms_contents_code a 						INNER  JOIN ishomedb.tz_cms_contents b 						ON     a.contents_no = b.contents_no 						INNER JOIN ishomedb.tz_cms_common_code c 						ON a.codeid = c.codeid 					WHERE ( c.parentid = '692' OR c.parentid = '693') 						AND b.pic_level = '1' 						AND a.contents_type = '1' 						AND b.status = '승인' 						AND b.media_type = 'JPG'; "
2015-04-27 02:54:48,ishome[ishome],114.207.114.57,10.256552,0.000217,6502,61378,"SELECT  c.codeid as DOCID 							,case b.reg_date when '' then '19710101000000' else  date_format(b.reg_date,'%Y%m%d%H%i%s') end as Date 							,c.parentid 							,(select name from ishomedb.tz_cms_common_code where codeid = c.parentid) as name 							,'' as CATECODE3 							,'' as CATENAME3 							,'' as SUB_TITLE 							,b.contents_no 							,'' as SUBJ_LESSON_NO 							,'' as SUBJ_LESSON_NM 							,'' as SUBJ_NO 							,'' as SUBJ_NM 							,'' as LOCAL_NM 							,'' as APPROVAL_NM 							,'' as UPPER_NO 							,'' as LEVEL 							,b.reg_id 							,'' as DATA_YN 							,b.objectname_kor 							,b.headline 							,b.service_path 							,b.thumb_path 							,b.pic_mediatime 							,b.media_type 							,'' as ACRO 							,'' as CATE_LEVEL 							,b.contents_no 							,b.contents_no 							,b.contents_no 							,'우리지역사진' as CATENAME1  					FROM   ishomedb.tz_cms_contents_code a 						INNER  JOIN ishomedb.tz_cms_contents b 						ON     a.contents_no = b.contents_no 						INNER JOIN ishomedb.tz_cms_common_code c 						ON a.codeid = c.codeid 					WHERE ( c.parentid = '700') 						AND b.pic_level = '1' 						AND a.contents_type = '1' 						AND b.status = '승인' 						AND b.media_type = 'JPG'; "
2015-04-27 02:56:27,ishome[ishome],114.207.114.57,5.117333,0.000212,64476,211316,"select	a.subjectlistid 							,case  when c.reg_date is NULL OR c.reg_date = '' then '19710101000000'  									else  date_format(c.reg_date,'%Y%m%d%H%i%s')  							end as Date 							,a.subjectid as CATECODE2 							,'' as CATENAME2 							,b.subjectname 							,case when (a.subject = '' or a.subject is null) then c.objectname_kor else a.subject end as title 							,c.headline 							,c.service_path 							,c.thumb_path 							,a.contents_no 							,'' as PLACECNT 							,'주제별이미지묶음' as CATENAME1 						from	ishomedb.tz_cms_contents_subject_list  a 						LEFT OUTER JOIN ishomedb.tz_cms_contents_subject  b 						ON        a.subjectid= b.subjectid 						INNER JOIN ishomedb.tz_cms_contents c 						ON         c.contents_no = a.contents_no 						WHERE	c.media_type = 'JPG'; "
2015-04-27 02:56:42,ishome[ishome],114.207.114.57,7.641335,0.000160,101568,203139,"SELECT   							a.contents_no 							, case  when b.reg_date is NULL OR b.reg_date = '' then '19710101000000'  									else  date_format(b.reg_date,'%Y%m%d%H%i%s')  							end as Date 							, '' 							, ''  							, a.keyword as subject 							, a.title as title 							, a.description as content 							, a.service_path  							, a.thumb_path 							, a.contents_no 							, '' AS PLACECNT 							, '낱장이미지' as CATENAME1 						FROM  							ishomedb.tz_cms_contents_nonclass a, ishomedb.tz_cms_contents b 						WHERE  							a.contents_div = 'IMG_ETC' 							and a.contents_no = b.contents_no; "
2015-04-27 02:58:09,ishome[ishome],114.207.114.57,85.638852,0.000239,67128,733745,"SELECT  distinct  b.contents_no as DOCID 							,case  when b.reg_date is NULL OR b.reg_date = '' then '19710101000000'  									else  date_format(b.reg_date,'%Y%m%d%H%i%s')  							end as Date 							,c.parentid 							,(select name from ishomedb.tz_cms_common_code where codeid = c.parentid) as CATENAME2 							,'' as SUBJECT 							,b.objectname_kor  							,b.headline 							,b.service_path 							,b.thumb_path 							,b.contents_no 							,b.contents_no 							,b.contents_no 							,'우리지역사진' as CATENAME1 						FROM   ishomedb.tz_cms_contents_code a 						INNER  JOIN ishomedb.tz_cms_contents b 						ON     a.contents_no = b.contents_no 						INNER JOIN ishomedb.tz_cms_common_code c 						ON a.codeid = c.codeid 						WHERE  c.parentid in ( '692','693','694','695','696','697','698','699','700','701','702','703','704','705','706','707') 						AND b.pic_level = '1' 						AND a.contents_type = '1' 						AND b.status = '승인' 						AND b.media_type = 'JPG'; "
2015-04-27 02:59:22,ishome[ishome],114.207.114.57,12.773839,0.001830,1538,1630336,"SELECT	distinct  							l.subj_lesson_no as docid 							,date_format(l.reg_dt,'%Y%m%d%H%i%s') as Date 							,CONCAT( s.grade_gbn, '-' ,s.semester_gbn) AS grade_semester_gbn   							,l.contents_xml_type 							,subj_gbn 							,ishomedb.uf_code_subj_nm(s.subj_gbn)         AS subj_nm   							,l.subj_lesson_nm 							,(select porting_value from ishomedb.tz_lcms_contents lc where contents_no = l.contents_no) as porting_value 							,l.subj_lesson_no 							,l.subj_lesson_nm 							,s.subj_no 							,ishomedb.uf_code_subj_nm(s.subj_gbn)         AS subj_nm   							,ishomedb.uf_code_local_nm(s.local_gbn)       AS local_nm   							,ishomedb.uf_code_approval_nm(s.approval_gbn) AS approval_nm  							,l.upper_no       							,cb.hlvl AS org_lvl 							,l.reg_id 							,s.school_study_yn 							 ,(select porting_value from ishomedb.tz_lcms_contents lc where contents_no = l.contents_no) as porting_value 							 ,l.subj_no   							,l.subj_lesson_no 							 ,concat('학교공부예복습>', ishomedb.uf_code_subj_nm(s.subj_gbn), '>', s.grade_gbn,  							 case when s.semester_gbn = 3 then '학년' else concat('-', s.semester_gbn) end, 							(select uf_lcms_study_lesson_connect_by_path('>', l.subj_lesson_no, 1) as path 									from tz_lcms_study_lesson 									where subj_lesson_no = l.subj_lesson_no) 							) as path 							,l.subj_lesson_no 							, '' 					FROM   ( 							SELECT  ishomedb.uf_lcms_study_lesson_connect_by(@maxlevel) AS id 									 ,CAST(@level AS SIGNED) AS hlvl 							FROM   ( 											SELECT  @start_with := 0, 														@id         := @start_with, 														@level      := 0, 												   @maxlevel   := 5 									 ) vars, ishomedb.tz_lcms_study_lesson 							WHERE   @id IS NOT NULL 						 ) cb 					INNER  JOIN ishomedb.tz_lcms_study_lesson l 					ON     l.subj_lesson_no = cb.id 					INNER  JOIN ishomedb.tz_lcms_subj s 					ON     l.subj_no = s.subj_no 					AND    s.school_study_yn IN ('C','U') 					AND    s.use_yn = 'Y' 					INNER JOIN    ishomedb.tz_lcms_study_lesson_element le 					ON     l.subj_lesson_no = le.subj_lesson_no 					where (l.lesson_gbn <> 10001) OR l.lesson_gbn IS NULL 					and ((select porting_value from ishomedb.tz_lcms_contents lc where contents_no = l.contents_no) is not null) 					and l.use_yn = 'Y'; "
2015-04-27 03:00:17,ishome[ishome],114.207.114.57,49.954456,0.002505,5788,19721,"select  		CONCAT(e.subj_lesson_no, '_', e.subj_lesson_element_no) as docid 	   , date_format(e.Date,'%Y%m%d%H%i%s') 	   , e.grade_semester_gbn 	   , e.contents_xml_type 	   , e.subj_gbn 	   , e.subj_nm 	   , e.subj_lesson_nm 	   , e.porting_value 	   , e.subj_lesson_no1 	   , e.subj_lesson_nm1 	   , e.subj_no 	   , e.subj_nm  	   , e.local_nm 	   , e.approval_nm 	   , e.upper_no       	   , e.org_lvl 	   , e.reg_id 	   , e.school_study_yn 	   , e.porting_value 	   , e.subj_no 	   , e.subj_lesson_no2 	   , e.path 	   , e.subj_lesson_element_no 	   , (case when e.sort = 1 then (select @rownum := 1) else @rownum := @rownum + 1 end ) from (select @rownum := 1) r, (     SELECT   a.subj_lesson_no as docid           , a.Date           , CONCAT(a.grade_gbn, '-', a.semester_gbn) AS grade_semester_gbn           , a.contents_xml_type           , a.subj_gbn           , a.subj_nm           , a.subj_lesson_nm           , b.porting_value           , a.subj_lesson_no           , a.subj_lesson_nm as subj_lesson_nm1           , a.subj_gbn as subj_gbn1           , a.subj_nm as subj_nm1           , a.local_nm           , a.approval_nm           , a.upper_no                 , a.org_lvl           , a.reg_id           , a.school_study_yn           , b.porting_value as porting_value1           , a.subj_no           , a.subj_lesson_no as subj_lesson_no1           , concat(a.path, '>', b.element_nm) as path           , a.subj_lesson_no as subj_lesson_no2           , b.subj_lesson_element_no           , b.sort     FROM (     SELECT  ishomedb.uf_code_grade_nm(s.grade_gbn)       AS grade_nm    /* 년도 구분 */                   ,ishomedb.uf_code_semester_nm(s.semester_gbn) AS semester_nm /* 학기 구분 */                   ,ishomedb.uf_code_subj_nm(s.subj_gbn)         AS subj_nm     /* 과목 구분 */                   ,ishomedb.uf_code_local_nm(s.local_gbn)       AS local_nm    /* 지역 구분 */                   ,ishomedb.uf_code_approval_nm(s.approval_gbn) AS approval_nm /* 지역 구분 */                   ,s.grade_gbn                   ,s.semester_gbn                   ,l.subj_lesson_nm                   ,s.subj_gbn                   ,s.local_gbn                   ,s.approval_gbn                   ,l.upper_no          /* 상위 목차 번호 */                   ,cb.hlvl AS org_lvl                   ,l.reg_id                   , date_format(l.reg_dt,'%Y%m%d%H%i%s') as Date                   ,s.school_study_yn                   ,l.subj_no                    ,concat('학교공부예복습>', ishomedb.uf_code_subj_nm(s.subj_gbn), '>', s.grade_gbn,  				      case when s.semester_gbn = 3 then '학년' else concat('-', s.semester_gbn) end,                       (select uf_lcms_study_lesson_connect_by_path('>', l.subj_lesson_no, 1) as path                       from tz_lcms_study_lesson                       where subj_lesson_no = l.subj_lesson_no)                      ) as path                   ,l.subj_lesson_no    /* 목차 번호 */                   ,CASE WHEN cb.hlvl >= @maxlevel THEN 1                         ELSE COALESCE(                             (                             SELECT  0                             FROM    ishomedb.tz_lcms_study_lesson l                             WHERE   l.upper_no = cb.id                             LIMIT 1                             ), 1)                     END AS isleaf                   ,l.contents_xml_type             FROM   (                     SELECT  ishomedb.uf_lcms_study_lesson_connect_by(@maxlevel) AS id                           ,CAST(@level AS SIGNED) AS hlvl                     FROM   (                             SELECT  @start_with := 0,                                     @id         := @start_with,                                     @level      := 0,                                     @maxlevel   := 5                           ) vars, ishomedb.tz_lcms_study_lesson                     WHERE   @id IS NOT NULL                   ) cb             INNER  JOIN ishomedb.tz_lcms_study_lesson l             ON     l.subj_lesson_no = cb.id             INNER  JOIN ishomedb.tz_lcms_subj s             ON     l.subj_no = s.subj_no             AND    s.use_yn = 'Y'             WHERE s.school_study_yn IN ('C', 'U')               and l.use_yn = 'Y'     ) a     INNER JOIN     (     SELECT  le.subj_lesson_element_no                   ,le.subj_lesson_no                    ,le.element_no                   ,lc.porting_value                   ,le.contents_title                   ,le.sort                   ,CONCAT(el.code_nm, ' / ', es.code_nm) AS element_nm             FROM   ishomedb.tz_lcms_study_lesson_element le             INNER  JOIN ishomedb.tz_lcms_study_element se             ON     le.element_no = se.element_no             LEFT   OUTER JOIN ishomedb.tz_lcms_contents lc             ON     le.contents_no = lc.contents_no             LEFT   OUTER JOIN                   (                     SELECT  code_no                           ,code_nm                      FROM   ishomedb.tz_code                      WHERE  code_gbn = 10105                   ) el             ON     se.element_gbn = el.code_no             LEFT   OUTER JOIN                   (                     SELECT  code_no                           ,code_nm                      FROM   ishomedb.tz_code                      WHERE  code_gbn = 10106                   ) es             ON     se.sub_element_gbn = es.code_no             WHERE  EXISTS (                         SELECT  1                         FROM   ishomedb.tz_lcms_study_lesson l                         INNER  JOIN ishomedb.tz_lcms_subj s                         ON     l.subj_no        = s.subj_no                         AND    s.use_yn = 'Y'                         WHERE  l.subj_lesson_no = le.subj_lesson_no                           and l.use_yn = 'Y'                   )             AND    se.element_type = 1             AND el.code_no <> '10006'     ) b     ON a.subj_lesson_no = b.subj_lesson_no     WHERE a.isleaf = 1      order by a.subj_lesson_no, b.sort ) e where e.porting_value is not null; "
2015-04-27 08:54:05,ishome[ishome],192.168.150.41,26.415878,0.000119,2,41939956,"SELECT             tph.history_no,             tph.student_id,             tph.point,             uf_common_replaceHTML(tph.comment) AS comment,             tph.reg_dt,             tph.show_yn,             tph.top_yn,             tm.nm_kor,             tm.login_id,             DATE_FORMAT(tph.reg_dt,'%Y') AS reg_year         FROM             ishomedb.tz_point_history tph                 INNER JOIN             ishomedb.tz_member tm ON tph.student_id = tm.user_id                    WHERE  tph.guide_no = '136'                                                                     AND tph.top_yn = 'Y'                ORDER BY           tph.history_no DESC         LIMIT 0, 25; "
2015-04-27 08:56:37,ishome[ishome],192.168.150.41,12.479371,0.000524,49509,5219922,"SELECT  	date_format(s_mem.reg_dt, '%Y-%m-%d') AS 가입일     ,date_format(pur.purchase_dt, '%Y-%m-%d') AS 주문일시     ,pur.purchase_no AS 주문번호     ,'' AS 입금자     ,p_mem.nm_kor AS 학부모명     ,p_mem.login_id AS 학부모ID     ,s_mem.nm_kor AS 학생명     ,s_mem.login_id AS 학생ID     ,t_mem.nm_kor AS 관리교사명     ,IFNULL(stu.manage_start_de, '') AS 배정일     ,sch.schoolname AS 학교     ,s_mem.grade_gbn AS 학년     ,s_mem.class_gbn AS 반     ,s_mem.gender AS 성별     ,pro.product_nm AS 상품     ,code.code_nm AS 상태     ,pur.start_de AS 학습시작일     ,pur.end_de AS 학습종료일     ,(SELECT MIN(date_format(login_dt, '%Y-%m-%d')) FROM tz_connect_log WHERE user_id = s_mem.user_id) AS 최초로그인     ,p_mem.zipcode AS 우편번호     ,p_mem.addr1 AS 지역     ,p_mem.addr2 AS 상세주소     ,CONCAT(p_mem.mobile1,'-',p_mem.mobile2,'-',p_mem.mobile3) as 학부모휴대전화     ,p_mem.email as 학부모이메일     ,CASE (SELECT COUNT(purchase_no) FROM tz_purchase WHERE purchase_id = p_mem.user_id AND product_no = '15') > 0      WHEN true THEN 'Y' ELSE 'N' END AS 웹체험여부     ,CASE WHEN p_mem.join_gbn IS NOT NULL THEN       uf_code_nm(10160,p_mem.join_gbn)      ELSE       p_mem.join_gbn_dir      END as 유입경로    ,CASE pro.service_homebook_yn WHEN 'Y' THEN 'B형' ELSE 'A형' END AS 기기구분값 FROM tz_purchase pur  LEFT JOIN tz_member p_mem ON pur.purchase_id = p_mem.user_id LEFT JOIN tz_member s_mem ON pur.student_id = s_mem.user_id LEFT JOIN tz_student stu ON pur.student_id = stu.student_id LEFT JOIN tz_member t_mem ON stu.teacher_id = t_mem.user_id LEFT JOIN tz_product pro ON pur.product_no = pro.product_no LEFT JOIN tz_code code ON pur.status_gbn = code.code_no AND code.code_gbn = '10118' LEFT JOIN tz_school sch ON s_mem.school_no = sch.school_no WHERE pur.purchase_dt <= '2015-03-31 23:59:59'     AND pur.purchase_dt >= '2015-01-01 00:00:00'; "
2015-04-27 09:12:20,ishome[ishome],192.168.150.41,11.080280,0.000462,30,5834628,"SELECT              a.f_errreport_id             ,a.f_user_cd             ,m.login_id             ,m.nm_kor AS f_user_nm             ,a.f_test_id             ,a.f_problem_id             ,a.f_cproblem_id             ,edubasestudydb.tCodeRefNm(t.f_grade_cd) AS f_grade_nm             ,edubasestudydb.tCodeRefNm(t.f_term_cd) AS f_term_nm             ,edubasestudydb.tCodeRefNm(t.f_subject_cd) AS f_subject_nm             ,a.f_kind_cd             ,a.f_process_cd             ,IF(LENGTH(a.f_content) > 60,  CONCAT(SUBSTRING(a.f_content, 1, 25), '...'), a.f_content) AS f_content             ,DATE_FORMAT(a.f_reg_dt, '%Y.%m.%d') AS f_reg_dt             ,a.f_isdelete             ,CASE WHEN a.f_answer_state='Y' THEN '답변완료'             ELSE '준비중'             END AS f_answer_st             ,edubasestudydb.tCodeRefNm(a.f_kind_cd) AS f_kind_nm             ,edubasestudydb.tCodeRefNm(a.f_process_cd) AS f_process_nm             ,edubasestudydb.tCodeRefNm(t.f_kind_cd) AS f_test_nm             ,a.f_content AS f_content_all             ,IFNULL((                 SELECT sub_m.nm_kor                  FROM ishomedb.tz_errreport_log e                                     LEFT JOIN ishomedb.tz_member sub_m                  ON e.reg_id = sub_m.user_id                                     WHERE e.errreport_id = a.f_errreport_id                  AND e.process_cd = 'EP03'                   ORDER BY e.reg_dt DESC                  LIMIT 1              ),'') as mody_nm_kor             ,IFNULL((                 SELECT sub_m.nm_kor                  FROM ishomedb.tz_errreport_log e                                   LEFT JOIN ishomedb.tz_member sub_m                  ON e.reg_id = sub_m.user_id                                   WHERE e.errreport_id = a.f_errreport_id                  AND e.process_cd = 'EP10'                  ORDER BY e.reg_dt DESC                  LIMIT 1              ),'') as an_nm_kor              ,IFNULL(stt.f_stu_test_id,'') as f_stu_test_id              ,(select count(tp2.f_stu_test_id) from edubasestudydb.t_student_test2_problem tp2 where tp2.f_stu_test_id = stt.f_stu_test_id ) as problem2_cnt              ,CONCAT(mt.nm_kor, ' <br /> (', mt.login_id, ')') as teacher_nm              ,ttt.team_nm as team_nm /* 팀이름 */              ,mt.nm_kor as teacher_nm2 /* 교사명 */         FROM edubasestudydb.t_bank_errreport a         INNER JOIN edubasestudydb.t_test_problem tp         ON a.f_test_id = tp.f_test_id         AND a.f_problem_id = tp.f_problem_id         INNER JOIN edubasestudydb.t_test t         ON t.f_test_id = tp.f_test_id AND t.f_isdelete = 'N'         INNER JOIN ishomedb.tz_student s          ON a.f_user_cd = s.student_no         INNER JOIN ishomedb.tz_member m          ON s.student_id = m.user_id         LEFT  JOIN edubasestudydb.t_student_test stt         ON stt.f_test_id = t.f_test_id         AND stt.f_user_cd = s.student_no         LEFT JOIN ishomedb.tz_member mt         ON mt.user_id = s.teacher_id         /* 선생님 정보 */         LEFT OUTER JOIN ishomedb.tz_teacher tt          ON tt.teacher_id = s.teacher_id         /* 선생님 팀정보 */         LEFT OUTER JOIN ishomedb.tz_teacher_team_part ttp          ON ttp.part_no = tt.part_no         /* 선생님 파트정보 */         LEFT OUTER JOIN ishomedb.tz_teacher_team ttt          ON ttt.team_no = ttp.team_no                                                                         ORDER BY a.f_reg_dt DESC                       LIMIT 0, 30; "
2015-04-27 14:54:31,ishome[ishome],192.168.150.41,8.419357,0.000186,4,987767,"SELECT cs.cs_seq_no               ,cs.user_id               ,CASE WHEN mb.nm_kor IS NOT NULL THEN mb.nm_kor ELSE nb.nm_kor END AS nm_kor               ,CASE WHEN mb.login_id IS NOT NULL THEN mb.login_id ELSE '-' END AS login_id               ,CASE WHEN mb.tel1 IS NOT NULL THEN CONCAT(mb.tel1, '-', mb.tel2, '-', mb.tel3)                     ELSE CONCAT(nb.tel1, '-', nb.tel2, '-', nb.tel3)                END AS tel               ,CASE WHEN mb.mobile1 IS NOT NULL THEN CONCAT(mb.mobile1, '-', mb.mobile2, '-', mb.mobile3)                     ELSE CONCAT(nb.mobile1, '-', nb.mobile2, '-', nb.mobile3)                END AS mobile               ,ishomedb.uf_code_nm(10002, cs.user_gbn) AS user_gbn               ,mb.parent_id               ,cs.mem_gbn /*회원/비회원 구분*/               ,cs.question               ,cs.answer               ,cs.record_url /*녹취파일 경로*/               ,CASE WHEN cs.progress=0 THEN '답변중'                     WHEN cs.progress=1 THEN '접수완료' 	                WHEN cs.progress=2 THEN '접수취소' 	                WHEN cs.progress=3 THEN '자체처리' 	                WHEN cs.progress=4 THEN '수리완료' 	                WHEN cs.progress=5 THEN '처리완료' 	                WHEN cs.progress=9 THEN '답변완료'                     ELSE '-'                 END AS progress /*상담진행상태*/               ,cs.as_no               ,CASE WHEN cs.grp_opt1='10001' THEN '인입'                     WHEN cs.grp_opt1='10002' THEN '아웃콜'                     WHEN cs.grp_opt1='10003' THEN '화상상담'                     WHEN cs.grp_opt1='10004' THEN '부재'                     ELSE '-'                 END AS grp_opt1 /*분류1*/               ,ishomedb.uf_code_gbn_nm(cs.grp_opt2) AS grp_opt2  /*분류2*/               ,ishomedb.uf_code_nm(cs.grp_opt2, cs.grp_opt3) AS grp_opt3  /*분류3*/               ,CASE WHEN cs.grp_opt4='10001' THEN '일반상담'                     WHEN cs.grp_opt4='10002' THEN '원격지원'                     ELSE '-'                 END AS grp_opt4 /*분류4*/               ,cs.contact /*상담원명*/               ,cs.contact_no /*상담원 내선번호*/               ,cs.reg_id               ,cs.reg_dt               ,cs.reg_ip               ,cs.upd_id               ,cs.upd_dt               ,cs.upd_ip         FROM ishomedb.tz_callservice cs 		LEFT OUTER JOIN ishomedb.tz_member mb 		ON mb.user_id = cs.user_id 		AND mb.user_gbn = cs.user_gbn 		LEFT OUTER JOIN ishomedb.tz_non_member nb 		ON nb.user_id = cs.user_id                    WHERE  (mb.nm_kor LIKE CONCAT('민은홍', '%') OR nb.nm_kor LIKE CONCAT('민은홍', '%'))                 ORDER BY cs_seq_no DESC         LIMIT 0, 10; "
2015-04-27 16:22:54,ishome[ishome],192.168.150.41,5.600787,0.000289,8,2118638,"SELECT  			thci.seq, 																			 		 /*시퀀스*/ 			thci.phone_gbn, 																			 /* 수,발신구분 */ 			DATE_FORMAT(thci.record_dt,'%Y-%m-%d')AS record_ymd, 										 /* 통화 일자(Y-m-d) */             CASE                 WHEN date_add(NOW(), interval - 14 day)  <=  DATE_FORMAT(thci.record_dt,'%Y-%m-%d') THEN 'Y'                 ELSE                     'N'             END AS new_yn,                                                                               /* 오늘 날짜 기준으로 통화한지 14일 이전인지 여부 */ 			DATE_FORMAT(thci.record_dt,'%H:%i:%s')AS start_record_dt,                           		 /*통화 시작 시간*/ 			SUBSTRING(thci.record_dt+ INTERVAL (thci.record_time/1000) second,12,8) AS end_record_dt,	 /*통화 종료 시간*/ 			thci.record_time, 																			 /*녹취 파일 시간 */ 			SEC_TO_TIME(thci.record_time/ 1000)as hms,                      						     /*통화 시:분:초 */ 			CASE 	    	WHEN thci.phone_gbn = 'R' then thci.send_no 	        ELSE thci.receive_no 	        END as target_no,																			 /*대상자번호*/ 	        CASE 	    	WHEN thci.phone_gbn = 'R' then thci.send_uid 	        ELSE thci.receive_uid 	        END as target_uid,   																		 /*uid검색*/ 	        floor(record_time/1000)as timeSecond,														 /*통화시간 초*/ 	        thci.teacher_id, 																			 /* 관리교사 아이디 */ 			tm.nm_kor as teacher_name, 																	 /* 관리교사 한글 이름 */ 			tm.login_id, 																				 /*로그인 아이디 */ 			tm.nm_kor as send_name, 																	 /*발신자 이름*/ 			tm.login_id as send_loginid ,																 /*발신자 아이디 */ 			thci.send_no, 																				 /* 발신 번호 */ 			thci.receive_uid, 																   		  	 /* 수신자 아이디 */ 			tm1.nm_kor as receive_name, 																 /* 수신자 이름*/ 			tm1.login_id as receive_loginid, 												  			 /*수신자 아이디*/ 			CASE 	    	WHEN thci.phone_gbn = 'S' and receive_uid is not null 	    		then tm1.nm_kor 	    	WHEN thci.phone_gbn = 'R'  and send_uid is not null 	    		then tm.nm_kor 	        ELSE "-" 	        END as target_user, 			thci.receive_no, 																			 /* 수신 번호 */ 			thm.mdn, 																					 /*홈런폰 사용자 번호*/ 			thci.record_file,																			 /*녹취 파일 */ 			thci.uuid 																						 /*단말기와 일치시켜주기 위한 id */ 		FROM tz_hpm_call_info thci 		INNER JOIN tz_hpm_member thm 		ON thm.teacher_id = thci.teacher_id 		INNER JOIN tz_member tm 		ON tm.user_id = thci.teacher_id 		LEFT OUTER JOIN tz_member tm1 		ON tm1.user_id = thci.receive_uid 		  		 WHERE  tm1.login_id LIKE CONCAT('%', LOWER('eungu5656'), '%') 			 			 			 			 			 			 			 			 			 			 				AND thci.record_dt  >= CONCAT('2015-01-01', ' 00:00:00') 			 				AND thci.record_dt  <= CONCAT('2015-04-30', ' 23:59:59')  	  		  ORDER BY thci.reg_dt DESC            		LIMIT 0, 30; "
2015-04-27 18:03:37,ishome[ishome],192.168.150.41,9.431765,0.000544,14762,2941185,"SELECT paid.split_paid_no               ,pur.purchase_no               ,pb.nm_kor AS paid_nm_kor               ,p_mem.nm_kor AS p_mem_name               ,p_mem.login_id AS p_mem_id               ,s_mem.nm_kor AS s_mem_name               ,s_mem.login_id AS s_mem_id               ,mng_std.grade_gbn AS grade_gbn               ,p_mem.zipcode AS zip_code               ,CONCAT(p_mem.addr1, ' ', p_mem.addr2) AS addr               ,CONCAT(p_mem.tel1, p_mem.tel2, p_mem.tel3) AS tel_no               ,CONCAT(p_mem.mobile1, p_mem.mobile2, p_mem.mobile3) AS mobile_no               ,prd.product_nm               ,paid.batch_key               ,paid.paid_day               ,DATE_FORMAT(paid.reg_dt, '%Y-%m-%d') AS paid_reg_dt               ,DATE_FORMAT(MIN(auth_ymd),'%Y-%m-%d') AS first_batch_dt               ,DATE_FORMAT(MAX(pb.auth_ymd),'%Y-%m-%d') AS last_batch_dt               ,SUM(IF(pb.progress = 'Y', 1, 0)) AS succ_cnt               ,paid.split_month               ,pb.error_cnt + 1 AS paid_request_cnt               ,pb.result_msg AS last_paid_status               ,purchase_code.code_nm AS status_gbn               ,CASE WHEN paid.del_yn = 'Y' Then '삭제'                     ELSE code.code_nm                END AS code_nm                ,tt.team_nm as team_nm /* 담당교사 팀 */               ,upd_mem.nm_kor AS upd_nm_kor /* 담당선생님 */               ,CONCAT(manage_mem.nm_kor, '(', manage_mem.login_id, ')') AS manage_info               ,manage_dt               ,ishomedb.uf_purchase_side_delivery_info(pur.purchase_no) as side_info               ,(                 SELECT c.product_nm                 FROM ishomedb.tz_purchase a                 INNER JOIN ishomedb.tz_product c ON c.product_no = a.product_no                  AND c.use_yn = 'Y' AND c.service_experience_yn = 'Y'                 WHERE a.student_id = paid.student_id and a.start_de != '' and a.start_de IS NOT NULL                 ORDER BY a.purchase_no DESC                 LIMIT 1               ) AS prev_product_nm                 ,(                 SELECT concat(a.start_de,'~',a.end_de)                 FROM ishomedb.tz_purchase a                 INNER JOIN ishomedb.tz_product c ON c.product_no = a.product_no                  AND c.use_yn = 'Y' AND c.service_experience_yn = 'Y'                 WHERE a.student_id = paid.student_id and a.start_de != '' and a.start_de IS NOT NULL                 ORDER BY a.purchase_no DESC                 LIMIT 1               ) AS pre_study_de         FROM ishomedb.tz_split_paid paid          LEFT OUTER JOIN ishomedb.tz_purchase pur          ON paid.purchase_no = pur.purchase_no         LEFT OUTER JOIN ishomedb.tz_purchase_batch pb         ON paid.split_paid_no = pb.split_paid_no         /* 신청자정보 */         LEFT JOIN ishomedb.tz_member p_mem         ON paid.parent_id = p_mem.user_id         /* 학습자정보 */         LEFT JOIN ishomedb.tz_member s_mem         ON paid.student_id = s_mem.user_id         /* 담당자 - 담당선생  */         LEFT JOIN ishomedb.tz_student mng_std         ON paid.student_id = mng_std.student_id         LEFT JOIN ishomedb.tz_member upd_mem         ON mng_std.teacher_id = upd_mem.user_id         /* 상품정보 */         LEFT JOIN ishomedb.tz_product prd         ON prd.product_no = paid.product_no         /* 출하상태  10118 */         LEFT JOIN ishomedb.tz_code purchase_code         ON pur.status_gbn = purchase_code.code_no         AND purchase_code.code_gbn = 10118         /* 월결제상태  10177 */         LEFT JOIN ishomedb.tz_code code         ON paid.paid_status = code.code_no         AND code.code_gbn = 10177                 /* 담당자 - 담당선생  팀파트*/         LEFT OUTER JOIN ishomedb.tz_teacher tec         ON tec.teacher_id = upd_mem.user_id         LEFT OUTER JOIN ishomedb.tz_teacher_team_part ttp         ON ttp.part_no = tec.part_no         LEFT JOIN ishomedb.tz_teacher_team tt         ON ttp.team_no = tt.team_no         /* 담당자 정보 */         LEFT JOIN ishomedb.tz_member manage_mem         ON paid.manage_id = manage_mem.user_id          WHERE  paid.reg_dt  >=  CONCAT('2015.01.27', ' 00:00:00')                                           AND paid.reg_dt  <=  CONCAT('2015.04.27', ' 23:59:59')           GROUP BY paid.split_paid_no         ORDER BY paid.split_paid_no DESC; "
2015-04-28 02:31:15,ishome[ishome],192.168.150.41,290.267644,0.000066,3,6,"SELECT  category_no     /* 카테고리 번호 */                ,category_nm     /* 카테고리명 */         FROM   ishomedb.tz_board_category         WHERE  master_no = '148'             AND use_yn = 'Y'         ORDER  BY  sort; "
2015-04-28 02:31:15,ishome[ishome],192.168.150.41,32.768684,0.000209,1,0,"SELECT COUNT(a.f_stu_test_id) AS cnt         FROM (             SELECT st.f_stu_test_id             FROM edubasestudydb.t_student_test st             INNER JOIN ishomedb.tz_student s             ON st.f_user_cd = s.student_no             INNER JOIN ishomedb.tz_purchase_student ps             ON s.student_no = ps.temp_student_no             INNER JOIN ishomedb.tz_purchase p             ON ps.purchase_no = p.purchase_no             AND IFNULL(p.status_gbn, 10001) != 10010             WHERE DATE_FORMAT(IFNULL(s.end_de, NOW()), '%Y-%m-%d') >= DATE_FORMAT(NOW(), '%Y-%m-%d')                 AND s.teacher_id = 417992                 AND st.f_ischeckpoint = 'N'             GROUP BY st.f_test_id, st.f_user_cd         ) a; "
2015-04-28 02:31:15,ishome[ishome],192.168.150.41,291.639077,0.001137,31,44744,"SELECT x.board_num               ,ADDDATE(DATE_FORMAT(x.reg_dt, '%Y%m%d'), x.new_days) - DATE_FORMAT(NOW(), '%Y%m%d') AS new_day               ,x.nm /* 게시글구분 - 1(공지글), 2(게시글) */               ,x.master_no               ,x.board_no               ,x.category_no               ,x.upper_no               ,x.ref_sort /* 답변정렬순서 */               ,x.ref_lvl /* 답변 레벨 */               ,x.title               ,x.content               ,x.top_yn /* 최상단 표시 여부 */               ,x.use_yn               ,x.summary               ,x.file_attach_cnt               ,IFNULL(x.read_cnt, 0) AS read_cnt               ,x.view_gbn /* 공개여부 */               ,x.reg_id               ,x.reg_dt               ,DATE_FORMAT(x.reg_dt, '%Y.%m.%d')as reg_date               ,x.user_nm               ,upd.nm_kor as nm_kor_upd               ,x.main_team               ,x.status /* 처리상황 */               ,(SELECT category_nm FROM ishomedb.tz_board_category WHERE category_no = x.category_no AND master_no = x.master_no) AS category_nm               ,(SELECT sort FROM ishomedb.tz_board_category WHERE category_no = x.category_no AND master_no = x.master_no) AS sort               ,mem.nm_kor               ,mem.login_id               ,mem.addr1               ,x.count_no /* 게시물 답변 갯수 */               ,x.recom_cnt               ,x.down_cnt               ,(SELECT DISTINCT upload_seq FROM ishomedb.tz_education_column_simage_file_seq WHERE upload_seq = x.sub_thumbnail_file_seq) AS sub_thumbnail_upload_seq /* 메인 썸네일 업로드 일련번호 */               ,(SELECT DISTINCT file_seq FROM ishomedb.tz_education_column_simage_file_seq WHERE upload_seq = x.sub_thumbnail_file_seq) AS sub_thumbnail_file_seq /* 메인 썸네일 파일 일련번호 */               ,upb.reg_id AS upper_reg_id               ,x.board_cnt               ,x.nickname               ,x.read_auth               ,x.sub_category_no               ,DATE_FORMAT(x.upd_dt, '%Y.%m.%d') as upd_date               ,x.upd_dt         FROM (             SELECT 1 AS nm                   ,NULL AS board_num                              ,bm.new_days                   ,b.master_no                   ,b.board_no                   ,b.category_no                   ,b.upper_no                   ,b.ref_sort                   ,b.ref_lvl                   ,b.title                   ,b.content                    ,b.top_yn                   ,b.summary                   ,b.file_seq                   ,b.file_attach_cnt                   ,b.sub_thumbnail_file_seq                   ,b.read_cnt                   ,b.view_gbn                   ,b.use_yn                   ,b.reg_id                   ,b.reg_dt                   ,b.upd_id                   ,b.user_nm                   ,c.code_nm as main_team                   ,b.status                   ,b.read_auth                   ,b.upd_dt                   ,p.nickname                   ,(SELECT COUNT(1) FROM tz_board_recommend WHERE board_no = b.board_no) AS recom_cnt                   ,(SELECT SUM(download_cnt) FROM ishomedb.tz_board_file_seq WHERE upload_seq = b.file_seq) AS down_cnt                   ,(SELECT COUNT(1) FROM tz_board_comment WHERE board_no = b.board_no) AS board_cnt                   ,(SELECT COUNT(1) FROM ishomedb.tz_board WHERE upper_no = b.upper_no) AS count_no /* 게시물 답변 갯수 */                   ,b.sub_category_no             FROM ishomedb.tz_board b             LEFT JOIN ishomedb.tz_code c             ON b.main_team = c.code_no             AND c.code_gbn = '10168'             LEFT OUTER JOIN ishomedb.tz_board_master bm             ON b.master_no = bm.master_no             LEFT JOIN ishomedb.tz_profile p             ON b.reg_id = p.reg_id             WHERE b.top_yn = 'Y'                  AND b.master_no = '189'                      UNION ALL                      (SELECT 2 AS nm                             ,((          SELECT COUNT(b.board_no)         FROM ishomedb.tz_board b         LEFT JOIN tz_member m         ON b.reg_id = m.user_id         LEFT JOIN tz_member mu         ON b.upd_id = mu.user_id         LEFT JOIN tz_code c         ON b.main_team = c.code_no         AND c.code_gbn = '10168'         LEFT JOIN ishomedb.tz_profile p         ON b.reg_id = p.reg_id         INNER JOIN tz_board upb         ON ABS(b.upper_no) = upb.board_no                    WHERE  IFNULL(b.top_yn, 'N') = 'N'                                                    AND b.master_no = '189'                                                                                      /* 기간  start */             AND DATE_FORMAT(b.reg_dt,'%Y.%m.%d')  >=  DATE_FORMAT('2015.01.28', '%Y.%m.%d')                           /* 기간  end */             AND DATE_FORMAT(b.reg_dt,'%Y.%m.%d')  <=  DATE_FORMAT('2015.04.28', '%Y.%m.%d')             ) - 0 - (@rownum := @rownum + 1)) + 1 AS board_num /*게시글일련번호*/                                  ,bm.new_days                   ,b.master_no                   ,b.board_no                   ,b.category_no                   ,b.upper_no                   ,b.ref_sort                   ,b.ref_lvl                   ,b.title                   ,b.content                        ,b.top_yn                   ,b.summary                   ,b.file_seq                   ,b.file_attach_cnt                   ,b.sub_thumbnail_file_seq                   ,b.read_cnt                   ,IF(ref_lvl >= 1, (                       SELECT view_gbn FROM ishomedb.tz_board WHERE board_no = ABS(b.upper_no)                    ), view_gbn) AS view_gbn /* 답변글일 경우 상위 글의 공개 여부를 가져옴 */                   ,b.use_yn                   ,b.reg_id                   ,b.reg_dt                   ,b.upd_id                   ,b.user_nm                    ,c.code_nm                   ,b.status                   ,b.read_auth                   ,b.upd_dt                   ,p.nickname                   ,(SELECT COUNT(1) FROM tz_board_recommend WHERE board_no = b.board_no) AS recom_cnt                   ,(SELECT SUM(download_cnt) FROM ishomedb.tz_board_file_seq WHERE upload_seq = b.file_seq) AS down_cnt                   ,(SELECT COUNT(1) FROM tz_board_comment WHERE board_no = b.board_no) AS board_cnt                   ,(SELECT COUNT(1) FROM ishomedb.tz_board WHERE upper_no = b.upper_no) AS count_no /* 게시물 답변 갯수 */                   ,b.sub_category_no             FROM ishomedb.tz_board b             LEFT JOIN ishomedb.tz_member m             ON b.reg_id = m.user_id             LEFT JOIN ishomedb.tz_member mu             ON b.upd_id = mu.user_id             LEFT JOIN ishomedb.tz_code c             ON b.main_team = c.code_no             AND c.code_gbn = '10168'             LEFT JOIN ishomedb.tz_board_master bm             ON b.master_no = bm.master_no             AND bm.master_no = '189'             LEFT JOIN ishomedb.tz_profile p             ON b.reg_id = p.reg_id                           INNER JOIN (SELECT @rownum := 0) rownum                                                    WHERE  IFNULL(b.top_yn, 'N') = 'N'                                                    AND b.master_no = '189'                                                                                      /* 기간  start */             AND DATE_FORMAT(b.reg_dt,'%Y.%m.%d')  >=  DATE_FORMAT('2015.01.28', '%Y.%m.%d')                           /* 기간  end */             AND DATE_FORMAT(b.reg_dt,'%Y.%m.%d')  <=  DATE_FORMAT('2015.04.28', '%Y.%m.%d')                                  ORDER BY b.upper_no, b.ref_sort                             LIMIT 0, 30             )         ) x         LEFT OUTER JOIN tz_member mem         ON x.reg_id = mem.user_id         LEFT OUTER JOIN tz_member upd         ON x.upd_id = upd.user_id         INNER JOIN tz_board upb         ON ABS(x.upper_no) = upb.board_no                       ORDER BY nm, upper_no, ref_sort; "
2015-04-28 02:31:15,ishome[ishome],192.168.150.41,32.869002,0.001185,114,8151,"SELECT  a.menu_no   /* 메뉴 ID */                ,a.upper_no  /* 부모 메뉴 ID */                ,a.menu_nm   /* 메뉴 한글명  */                ,mth.func_rw /* 메뉴 Read, Write */                ,a.sort      /* 정렬 */                ,ishomedb.uf_menu_connect_by_path(' > ', a.menu_no, 4) AS path  /* 메뉴한글 Path */                ,IFNULL((CASE WHEN a.menu_url = '' THEN ''                              ELSE CONCAT('/sigong', a.menu_url)                         END), '') AS menu_url   /* 메뉴 URL */                                         ,(CASE WHEN (CASE  WHEN b.level >= @maxlevel THEN 1                                   ELSE COALESCE( ( SELECT  0                                                    FROM    ishomedb.tz_menu a                                                    WHERE   a.upper_no = b.menu_no                                                    LIMIT   1), 1)                              END) = 1 THEN 'page'                                       ELSE 'folder'                 END) AS leaf                    /* 마지막 노드 구분 */                  FROM   ishomedb.tz_menu a                  INNER  JOIN ( SELECT  ishomedb.uf_menu_connect_by(@maxlevel) AS menu_no                              ,CAST(@level AS SIGNED) AS level                        FROM    ( SELECT  @start_with := -1, /* start upper_no code*/                                         @id := @start_with,                                          @level := 0,                                         @maxlevel := 10                                ) vars,                                  ishomedb.tz_menu                       WHERE   @id IS NOT NULL                      ) b         ON     a.menu_no = b.menu_no 		 		INNER  JOIN ishomedb.tz_menu_auth mth 		ON     a.menu_no = mth.menu_no 		 		INNER  JOIN ishomedb.tz_manager mag 		ON     mth.auth_gbn = mag.auth_gbn 		AND    mag.manager_id = 417992 		AND    mag.auth_gbn = '10007'          WHERE  a.use_yn = 'Y'         AND    a.menu_sort = 'adminTeacher'; "
2015-04-28 02:37:58,ishome[ishome],192.168.150.80,215.379996,0.000180,1,0,"SELECT COUNT(a.manager_id) AS cnt           FROM   ishomedb.tz_manager a                   INNER  JOIN ( SELECT  code_no                              ,code_nm                       FROM   ishomedb.tz_code                       WHERE  code_gbn = 10001                     ) b         ON      b.code_no = a.auth_gbn                  WHERE   a.manager_id = 147           AND   a.auth_gbn = 10010; "
2015-04-28 02:37:58,ishome[ishome],192.168.150.41,155.290530,0.000120,1,1,"SELECT ttt.team_nm, COUNT(1) as total_count         FROM tz_teacher tt         INNER JOIN tz_teacher_team_part ttp ON tt.part_no = ttp.part_no         INNER JOIN tz_teacher_team ttt ON ttp.team_no = ttt.team_no         WHERE tt.teacher_id = 417992; "
2015-04-28 02:37:58,ishome[ishome],192.168.150.41,34.587498,0.000146,0,0,"SELECT IFNULL(attend_dt, '-') as attend_dt               , IFNULL(leave_dt, '-') as leave_dt         FROM tz_teacher_attend          WHERE  work_de = curdate()                    AND attend_dt >= curdate()                                                          AND teacher_id = 417992; "
2015-04-28 02:37:58,ishome[ishome],192.168.150.41,90.512774,0.000141,1,158,"SELECT count(*) as cnt     		FROM ishomedb.tz_student 		WHERE teacher_id = 417992 		  AND manage_start_de is null 		  AND end_de >= now(); "
2015-04-28 02:37:58,ishome[ishome],192.168.150.41,177.454501,0.000904,3,28,"select              a.f_stu_test_id             ,a.f_test_id             ,a.f_user_cd             ,c.f_subject_cd /*과목CD */             ,c.f_grade_cd /*학년CD */             ,c.f_kind_cd             ,edubasestudydb.testNmCreate (c.f_grade_cd, c.f_term_cd, c.f_test_nm, c.f_no) f_test_nm             ,edubasestudydb.testNmCreateA(c.f_grade_cd, c.f_term_cd, c.f_test_nm, c.f_no) f_test_nm_all                    ,m.login_id             ,m.user_id             /*명칭*/             ,m.nm_kor user_nm             ,m.class_nm             ,d.f_point             ,b.f_rpoint             ,(case when b.f_input_path is null then '' else b.f_input_path end) f_input_path             ,b.f_result             ,b.f_num             ,d.f_problem_id             ,b.f_advice             ,b.f_input             ,'0' re_score         from             edubasestudydb.t_student_test a             inner join ishomedb.tz_student s on a.f_user_cd  = s.student_no             inner join ishomedb.tz_member  m on s.student_id = m.user_id            ,edubasestudydb.t_student_test_problem b            ,edubasestudydb.t_test c            ,edubasestudydb.t_test_problem d         where 1=1           and a.f_stu_test_id  = b.f_stu_test_id           and a.f_test_id      = c.f_test_id           and a.f_test_id      = d.f_test_id           and b.f_num          = d.f_num           and a.f_stu_test_id = 972318412                           and b.f_result = 'A' /* 채점해야할문항만 */                                   order by f_num; "
2015-04-28 02:37:58,ishome[ishome],192.168.150.41,298.126609,0.000201,1,25,"SELECT DISTINCT  		         'Y' AS is_finish 		        ,st.f_test_id 		        ,st.f_ischeckpoint 		        ,st.f_stu_test_id 		        ,t.f_problem_cnt 		        ,SUM(IF(stp.f_result='1', 1, 0)) AS f_correct_cnt 		        ,SUM(IF(stp.f_result   <>   '1', 1, 0)) AS f_incorrect_cnt 		        ,st.f_point 		        ,st2.f_test_dt         /* 틀린문제 풀이 날짜 (틀린문제 풀이 유무 판단) */ 		FROM edubasestudydb.t_student_test st 		INNER JOIN edubasestudydb.t_test t 		        ON t.f_test_id = st.f_test_id	 		LEFT OUTER JOIN edubasestudydb.t_student_test2 st2 		        ON st2.f_stu_test_id = st.f_stu_test_id AND st2.f_kind_cd = '01' 		LEFT OUTER JOIN edubasestudydb.t_student_test_problem stp 		        ON stp.f_stu_test_id = st.f_stu_test_id 		WHERE st.f_stu_test_id = '972343717' 		LIMIT 1; "
2015-04-28 02:37:58,ishome[ishome],192.168.150.80,282.044383,0.000272,1,109,"SELECT CONCAT(m.nm_kor, '(', m.login_id, ')') as answerInfo             ,date_format(q.f_reg_dt, '%Y.%m.%d') f_reg_dt             ,(CASE WHEN q.f_answer_state = 'N' THEN                 '답변중'             ELSE                 '답변완료'             END) answer_state             ,q.f_answer_state             ,edubasestudydb.tCodeRefNm(f_subject_cd) AS f_subject_nm             ,CONCAT(edubasestudydb.tCodeRefNm(q.f_kind_cd),              (CASE WHEN f_no=1 THEN                  '(기본)'                 WHEN f_no=2 THEN                 '(심화)'                 WHEN f_no=3 THEN                 '(보충)'                END)             ) f_test_nm             ,CONCAT(q.f_grade_cd, '학년 ', q.f_term_cd, '학기') f_grade_term             ,q.f_sg_qna_path             ,q.f_txt_answer             ,q.f_answer             ,q.file_seq             ,qf.save_file_nm         FROM edubasestudydb.t_math_qna q         LEFT OUTER JOIN edubasestudydb.t_math_qna_file_seq qf         ON q.file_seq = qf.upload_seq         LEFT OUTER JOIN ishomedb.tz_student s         ON s.student_no = q.f_user_cd         LEFT OUTER JOIN ishomedb.tz_member m         ON s.student_id = m.user_id         WHERE q.f_math_id = '2643'; "
2015-04-28 02:37:58,ishome[ishome],192.168.150.41,70.910491,0.001755,104,156898,"SELECT student_no               ,student_id               ,parent_id               ,teacher_id               ,group_nm               ,grade_gbn               ,gender                              ,user_id               ,login_id               ,p_login_id               ,p_nm_kor               ,nm_kor               ,tel               ,mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,pur_start_de               ,pur_end_de               ,product_no               ,last_dt               ,student_consult_dt               ,student_consult_gbn               ,student_consult_content               ,parent_consult_dt               ,parent_consult_gbn               ,parent_consult_content               ,product_nm               ,status               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status                   ,              (SELECT stat_day19 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day20 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day21 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day22 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day23 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day24 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day6         ,              (SELECT stat_day25 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day7         ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day8         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day9         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day10         ,              '-'                       as stat_day11         ,                         '-'                       as stat_day12         ,                         '-'                      as stat_day13         ,              '-'                       as stat_day14                       FROM (               SELECT a.student_no                   ,a.student_id                   ,c.parent_id                   ,a.teacher_id                   ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm                   ,a.grade_gbn                   ,CASE WHEN c.gender = 'M' THEN '남'                         WHEN c.gender = 'F' THEN '여'                         ELSE '-'                   END AS gender                                  ,c.user_id                   ,c.login_id                   ,p.login_id AS p_login_id                   ,p.nm_kor AS p_nm_kor                   ,c.nm_kor                   ,CONCAT(c.tel1,'-',c.tel2,'-',c.tel3) AS tel                   ,CONCAT(c.mobile1,'-',c.mobile2,'-',c.mobile3) AS mobile                   ,c.blacklist_yn                   ,IFNULL(a.manage_start_de,'9999.99.99') as manage_start_de                   ,DATE_FORMAT(a.start_de, '%Y.%m.%d') AS start_de                   ,DATE_FORMAT(a.end_de, '%Y.%m.%d') AS end_de                   ,DATE_FORMAT(pur.start_de, '%Y.%m.%d') AS pur_start_de                   ,DATE_FORMAT(pur.end_de, '%Y.%m.%d') AS pur_end_de                   ,pur.product_no                   ,(SELECT MAX(login_dt)   FROM ishomedb.tz_connect_log WHERE user_id = a.student_id) AS last_dt                   ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=c.user_id                      AND content IS NOT NULL) AS student_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=c.user_id                      AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=c.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_content                         ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=p.user_id                       AND content IS NOT NULL) AS parent_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=p.user_id                     AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=p.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_content                   ,ishomedb.uf_study_product_nm(a.student_no) as product_nm                   ,CASE WHEN c.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보 */                         'Android'                         WHEN COALESCE(s.user_id, -1) > 0 THEN 'ON'                          ELSE 'OFF'                     END AS status                                      ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                   ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                   ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                   ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                   ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                   ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                   ,tee.app_reason             FROM ishomedb.tz_student a                             	            INNER JOIN ishomedb.tz_purchase_student pch 	            ON a.student_no = pch.temp_student_no 	            INNER JOIN ishomedb.tz_purchase pur 	            ON pch.purchase_no = pur.purchase_no 	            INNER JOIN tz_product pd 	            ON pur.product_no = pd.product_no 	                                        AND pd.service_com_yn = 'Y'                               INNER JOIN ishomedb.tz_member c             ON a.student_id = c.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = c.parent_id             INNER JOIN ishomedb.tz_teacher d             ON a.teacher_id = d.teacher_id             LEFT OUTER JOIN ishomedb.tz_connect_session s             ON a.student_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = a.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de             LEFT OUTER JOIN ishomedb.tz_experience tee              ON tee.purchase_no = pur.purchase_no and tee.parent_id = pur.purchase_no and tee.student_id = pur.student_id                            WHERE               c.search_yn = 'Y'             AND a.teacher_id = 417992             AND IFNULL(c.user_gbn_cls, '10001') != '10002'                                	             	              	                AND ( 	                    a.end_de is not null 	                    AND 	                    date_format(a.end_de, '%Y%m%d')   >=   date_format(NOW(), '%Y%m%d') 	                )  	                  	                                                                                                                                                                                                                                              GROUP BY a.student_no         ) A           ORDER BY manage_start_de DESC; "
2015-04-28 02:43:20,ishome[ishome],192.168.150.41,302.274425,0.000636,20,78099,"SELECT a.f_stu_test_id 		    ,a.f_test_id 		    ,a.f_user_cd 		    ,a.f_point 		    ,a.f_ischeckpoint 		    ,c.f_subject_cd /*과목CD */ 		    ,c.f_grade_cd /*학년CD */ 		    ,c.f_kind_cd 		    ,DATE_FORMAT(a.f_test_dt, '%Y.%m.%d') f_test_dt /*평가일*/ 		    ,IFNULL(DATE_FORMAT(a.f_checkpoint_dt, '%Y.%m.%d'), '미채점') f_checkpoint_dt /*채점일*/ 	        ,CONCAT('[', SUBSTRING(c.f_grade_cd, -1), '-', SUBSTRING(c.f_term_cd, -1), ' ', z.f_caption,  	          CASE WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN '] ' 	               ELSE CONCAT(' ', SUBSTRING(lsl.order_key, 1, 2), '] ') 	          END,  	            CASE WHEN lsl.lesson_gbn = 10001 THEN CONCAT(lsl.sort, '.') 	                 WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN '' 	                 ELSE CONCAT(lsl.sort, '장.')  	            END,  	            CASE WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN c.f_test_nm 	                 WHEN CHAR_LENGTH(c.f_test_nm) > 12 THEN CONCAT(SUBSTRING(c.f_test_nm, 1, 9), '...')  	                 ELSE c.f_test_nm END,  	            CONCAT('(', c.f_no, '회차)')) AS f_test_nm 	        ,CONCAT('[', SUBSTRING(c.f_grade_cd, -1), '-', SUBSTRING(c.f_term_cd, -1), ' ', z.f_caption,  	          CASE WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN '] ' 	               ELSE CONCAT(' ', SUBSTRING(lsl.order_key, 1, 2), '] ') 	          END,  	            CASE WHEN lsl.lesson_gbn = 10001 THEN CONCAT(lsl.sort, '.') 	                 WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN '' 	                 ELSE CONCAT(lsl.sort, '장.')  	            END, c.f_test_nm,  	            CONCAT('(', c.f_no, '회차)')) AS f_test_nm_all 		    ,m.login_id 		    ,m.user_id 		    ,m.nm_kor user_nm 		    ,a.student_no 		    ,a.teacher_id 		    ,x.f_caption f_kind_cd_nm    /*평가구분*/ 		    ,y.f_caption f_grade_cd_nm   /*학년구분*/ 		    ,z.f_caption f_subject_cd_nm /*과목구분*/ 		    ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm  		    ,c.f_problem_cnt             ,SUM(IF(stp.f_result='0', 0, 1)) AS r_cnt             ,SUM(IF(stp.f_result='0', 1, 0)) AS w_cnt 	    FROM ( 	        SELECT st.* 	            ,ist.student_no 	            ,ist.student_id 	            ,ist.teacher_id 	            ,ist.group_no 	        FROM edubasestudydb.t_student_test st 	        INNER JOIN ( 	            SELECT MAX(f_stu_test_id) AS f_stu_test_id, s.* 	            FROM edubasestudydb.t_student_test st 	            INNER JOIN ishomedb.tz_student s  	            ON st.f_user_cd = s.student_no 	            WHERE s.teacher_id = 417992                 AND DATE_FORMAT(IFNULL(s.end_de, NOW()), '%Y-%m-%d') >= DATE_FORMAT(NOW(), '%Y-%m-%d') 	            GROUP BY f_test_id, f_user_cd 	        ) ist 	        ON st.f_stu_test_id = ist.f_stu_test_id 	    ) a 		INNER JOIN ishomedb.tz_purchase_student pch  		ON a.student_no = pch.temp_student_no 		INNER JOIN ishomedb.tz_purchase pur 		ON pch.purchase_no = pur.purchase_no 		INNER JOIN ishomedb.tz_member m 		ON a.student_id = m.user_id     		INNER JOIN edubasestudydb.t_test c 		ON a.f_test_id = c.f_test_id         INNER JOIN ishomedb.tz_lcms_study_lesson lsl         ON lsl.subj_lesson_no = c.f_chapter_cd 		INNER JOIN edubasestudydb.t_code_ref x 		ON c.f_kind_cd = CONCAT(x.f_group_id, x.f_detail_id) AND x.f_group_id = 'T1' 		INNER JOIN edubasestudydb.t_code_ref y  		ON c.f_grade_cd = CONCAT(y.f_group_id, y.f_detail_id) AND y.f_group_id = 'GR' 		INNER JOIN edubasestudydb.t_code_ref z  		ON c.f_subject_cd = CONCAT(z.f_group_id, z.f_detail_id) AND z.f_group_id = 'SB' 		LEFT OUTER JOIN edubasestudydb.t_student_test_problem stp 		ON stp.f_stu_test_id = a.f_stu_test_id         WHERE IFNULL(pur.status_gbn, '') != 10010                                                  AND a.f_ischeckpoint = 'N'                                                                                           GROUP BY a.f_stu_test_id         ORDER BY                    f_ischeckpoint DESC, f_test_dt DESC, c.f_grade_cd, c.f_term_cd, c.f_subject_cd, c.f_kind_cd, c.f_no; "
2015-04-28 10:23:12,ishome[ishome],192.168.150.41,77.606931,0.000439,10,2839124,"SELECT a.purchase_no /* 주문번호 */ 		      ,a.delivery_invoice_no /* 운송장 번호 */ 		      ,i.serial_no /* 시리얼 번호 */ 		      ,i.status_gbn AS device_status_gbn /* 단말기상태코드 */ 		      ,d.code_nm AS status /* 구매상태 */ 		      ,z.code_nm AS device_status /* 단말기상태값 */ 		      ,g.code_nm AS payhow /* 결제방법 */ 		      ,no_mem.member_no AS no_member_no /* 직접입력 고객번호 */   		      ,no_mem.nm_kor AS no_nm_kor     /* 직접입력 고객이름 */ 		      ,no_mem.ticket_number AS ticket_number /* 수강권번호 */ 		      ,DATE_FORMAT(a.ship_req_dt, '%Y.%m.%d') AS ship_req_dt /* 출하요청일 */ 		      ,CONCAT(e.nm_kor, ' (', e.login_id, ')') AS purchase_nm /* 주문자(아이디) */ 		      ,CONCAT(c.product_nm, IF(a.model_code IS NULL, '', CONCAT(' / ', a.model_code))) AS product_model /* 상품코드/모델코드 */ 		      ,DATE_FORMAT(a.purchase_dt,'%Y.%m.%d %H:%i') AS purchase_dt /* 주문일시 */ 		      ,IFNULL((SELECT paid_yn FROM ishomedb.tz_experience WHERE parent_id = a.purchase_id LIMIT 1),'N') AS paid_yn /* 유료확정여부 */ 		      ,(SELECT nm_kor FROM ishomedb.tz_member WHERE user_id = a.student_id) AS s_name /* 학생명 */ 		      ,(SELECT login_id FROM ishomedb.tz_member WHERE user_id = a.student_id) AS s_login_id /* 학생아이디 */  		      ,e.addr1 AS purchase_addr /* 구매자지역 */ 		      ,a.status_gbn AS purchase_status_gbn /* 구매상태 */ 		      ,a.withdraw_dt AS purchase_withdraw_dt /* 회수일 */   		      ,a.product_no /* 상품번호 */ 		      ,a.purchase_device_gbn /* 구매단말기 구분*/ 		      ,uf_code_nm(10218,a.purchase_device_gbn) AS purchase_device_gbn_nm 		      ,a.ipshar_yn /* 공유기 유무 */ 		      ,y.code_nm as device_area /* 처리장소 */ 		      ,tdm.model_gbn as model_gbn /* 기기구분 */ 		      ,uf_code_nm(10230,tdm.model_gbn) as model_gbn_nm /* 기기구분명 */ 		      ,ishomedb.uf_purchase_side_delivery_info(a.purchase_no) as side_info 		      ,a.purchase_device_dt /* 기기선택일자 */            		       		FROM ishomedb.tz_purchase a 		/* 상품 정보 */ 		INNER JOIN ishomedb.tz_product c 		ON a.product_no = c.product_no 		AND c.use_yn = 'Y' 		AND c.service_com_yn = 'Y' 		/* 구매 상태  10118 */ 		LEFT OUTER JOIN ishomedb.tz_code d 		ON d.code_gbn = 10118 		AND d.use_yn = 'Y' 		AND a.status_gbn = d.code_no 		/* 주문자 정보 */ 		LEFT OUTER JOIN ishomedb.tz_member e 		ON a.purchase_id = e.user_id 		/* 직접등록 주문자정보 */ 		LEFT OUTER JOIN ishomedb.tz_member_no_join no_mem 		ON a.purchase_no = no_mem.purchase_no 		/* 결제 방법 10117 */ 		LEFT OUTER JOIN ishomedb.tz_code g 		ON g.code_gbn = 10117 		AND g.use_yn = 'Y' 		AND a.payhow_gbn = g.code_no 		/* 단말기 정보 */ 		LEFT OUTER JOIN ishomedb.tz_device i 		ON a.purchase_no = i.purchase_no		 		/* 단말기 상태  10200 */ 		LEFT OUTER JOIN ishomedb.tz_code z 		ON z.code_gbn = 10200 		AND z.use_yn = 'Y' 		AND i.status_gbn = z.code_no 		/* 출하 용도  10142 */ 		LEFT OUTER JOIN ishomedb.tz_code j 		AND j.use_yn = 'Y' 		AND j.code_gbn = 10142 		/* 출하 구분  10144 */ 		LEFT OUTER JOIN ishomedb.tz_code l 		ON a.ship_gbn = l.code_no 		AND l.use_yn = 'Y' 		AND l.code_gbn = 10144 		/* 모델구분 */         LEFT OUTER JOIN ishomedb.tz_device_model tdm         ON i.model_code = tdm.model_code         /* 처리장소 */         LEFT OUTER JOIN ishomedb.tz_code y         ON i.stock_lt = y.code_no         AND y.code_gbn = 10141                    WHERE  a.student_id is not null AND a.student_id != ''         AND a.product_no != '263' /* 학교배포용 학습기 제외 */                          ORDER BY a.purchase_dt DESC                           LIMIT 0, 10; "
2015-04-28 10:28:34,ishome[ishome],192.168.150.41,7.318430,0.000320,1,0,"SELECT             COUNT(a.split_paid_no)         FROM         (             SELECT DISTINCT paid.split_paid_no             FROM ishomedb.tz_split_paid paid              LEFT OUTER JOIN ishomedb.tz_purchase pur              ON paid.purchase_no = pur.purchase_no             LEFT OUTER JOIN ishomedb.tz_purchase_batch pb             ON paid.split_paid_no = pb.split_paid_no             /* 신청자정보 */             LEFT JOIN ishomedb.tz_member p_mem             ON paid.parent_id = p_mem.user_id             /* 학습자정보 */             LEFT JOIN ishomedb.tz_member s_mem             ON paid.student_id = s_mem.user_id             /* 담당자 - 담당선생  */             LEFT JOIN ishomedb.tz_student mng_std             ON paid.student_id = mng_std.student_id             LEFT JOIN ishomedb.tz_member upd_mem             ON mng_std.teacher_id = upd_mem.user_id             /* 출하상태  10118 */             LEFT JOIN ishomedb.tz_code purchase_code             ON pur.status_gbn = purchase_code.code_no             AND purchase_code.code_gbn = 10118             /* 월결제상태  10177 */             LEFT JOIN ishomedb.tz_code code             ON paid.paid_status = code.code_no             AND code.code_gbn = 10177             LEFT OUTER JOIN ishomedb.tz_teacher tec             ON tec.teacher_id = upd_mem.user_id             LEFT OUTER JOIN ishomedb.tz_teacher_team_part ttp             ON ttp.part_no = tec.part_no             /* 담당자 정보 */             LEFT JOIN ishomedb.tz_member manage_mem             ON paid.manage_id = manage_mem.user_id             /* 구매단말기구분  10218 */             LEFT OUTER JOIN ishomedb.tz_code h              ON h.code_no = pur.purchase_device_gbn AND h.use_yn = 'Y' AND h.code_gbn = 10218             /* 단말기 정보 */             LEFT OUTER JOIN ishomedb.tz_device i             ON pur.purchase_no = i.purchase_no             AND i.status_gbn IN (10002, 10005, 10007)             /* 모델구분 */             LEFT OUTER JOIN ishomedb.tz_device_model tdm             ON i.model_code = tdm.model_code                       WHERE  manage_mem.nm_kor LIKE CONCAT('이은숙', '%')                 ) a; "
2015-04-28 13:39:20,ishome[ishome],192.168.150.41,6.421695,0.000353,100,1269103,"SELECT stu.student_no               ,stu.student_id               ,stu.grade_gbn               ,(SELECT product_nm FROM ishomedb.tz_product WHERE product_no = pur.product_no) as product_nm               ,stu.group_no               ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = stu.group_no), '미지정') AS group_nm               ,mem.user_id               ,mem.nm_kor               ,mem.login_id               ,mem.parent_id               ,mem.recom_teacher               ,prn.nm_kor AS parent_nm               ,stu.end_de AS service_end_de               ,prn.login_id AS parent_login               ,pch.first_start_de AS service_start_de               ,(SELECT MAX(consult_dt)                  FROM ishomedb.tz_lms_consult                  WHERE student_no = stu.student_no                      AND content IS NOT NULL               ) AS consult_time               ,(SELECT MAX(consult_dt)                  FROM ishomedb.tz_lms_consult                  WHERE student_no = stu.student_no                      AND content IS NOT NULL               ) AS consult_time               ,(SELECT content                 FROM ishomedb.tz_lms_consult lc1                 WHERE lc1.student_no = stu.student_no                     AND lc1.content IS NOT NULL                     AND lc1.consult_no = (                         SELECT MAX(consult_no)                         FROM ishomedb.tz_lms_consult lc2                         WHERE lc2.student_no = stu.student_no                             AND lc2.content IS NOT NULL                     )               ) AS consult_content               ,IFNULL(stu.web_start_de, '') as web_service_start_de               ,IFNULL(stu.web_end_de, '') as web_service_end_de         FROM ishomedb.tz_student stu         INNER JOIN ishomedb.tz_purchase_student pch         ON stu.student_no = pch.temp_student_no         INNER JOIN ishomedb.tz_purchase pur         ON pch.purchase_no = pur.purchase_no         INNER JOIN ishomedb.tz_member mem         ON stu.student_id = mem.user_id         INNER JOIN ishomedb.tz_member prn         ON mem.parent_id = prn.user_id         WHERE pur.status_gbn != 10010             AND pur.product_no != '263' /* 학교배포용 학습기 제외 */                                AND IFNULL(stu.teacher_id, 0) = 0             AND (stu.end_de  >=  DATE_FORMAT(NOW(), '%Y-%m-%d') OR stu.end_de IS NULL)                                                                         AND pur.product_no IN (SELECT product_no FROM tz_product WHERE service_experience_yn = 'Y' and service_com_yn = 'N')                                                                                                                   ORDER BY service_start_de DESC          LIMIT  0, 100; "
2015-04-28 17:36:18,ishome[ishome],192.168.150.41,5.616585,0.000197,0,2165861,"SELECT  			thci.seq, 																			 		 /*시퀀스*/ 			thci.phone_gbn, 																			 /* 수,발신구분 */ 			DATE_FORMAT(thci.record_dt,'%Y-%m-%d')AS record_ymd, 										 /* 통화 일자(Y-m-d) */             CASE                 WHEN date_add(NOW(), interval - 14 day)  <=  DATE_FORMAT(thci.record_dt,'%Y-%m-%d') THEN 'Y'                 ELSE                     'N'             END AS new_yn,                                                                               /* 오늘 날짜 기준으로 통화한지 14일 이전인지 여부 */ 			DATE_FORMAT(thci.record_dt,'%H:%i:%s')AS start_record_dt,                           		 /*통화 시작 시간*/ 			SUBSTRING(thci.record_dt+ INTERVAL (thci.record_time/1000) second,12,8) AS end_record_dt,	 /*통화 종료 시간*/ 			thci.record_time, 																			 /*녹취 파일 시간 */ 			SEC_TO_TIME(thci.record_time/ 1000)as hms,                      						     /*통화 시:분:초 */ 			CASE 	    	WHEN thci.phone_gbn = 'R' then thci.send_no 	        ELSE thci.receive_no 	        END as target_no,																			 /*대상자번호*/ 	        CASE 	    	WHEN thci.phone_gbn = 'R' then thci.send_uid 	        ELSE thci.receive_uid 	        END as target_uid,   																		 /*uid검색*/ 	        floor(record_time/1000)as timeSecond,														 /*통화시간 초*/ 	        thci.teacher_id, 																			 /* 관리교사 아이디 */ 			tm.nm_kor as teacher_name, 																	 /* 관리교사 한글 이름 */ 			tm.login_id, 																				 /*로그인 아이디 */ 			tm.nm_kor as send_name, 																	 /*발신자 이름*/ 			tm.login_id as send_loginid ,																 /*발신자 아이디 */ 			thci.send_no, 																				 /* 발신 번호 */ 			thci.receive_uid, 																   		  	 /* 수신자 아이디 */ 			tm1.nm_kor as receive_name, 																 /* 수신자 이름*/ 			tm1.login_id as receive_loginid, 												  			 /*수신자 아이디*/ 			CASE 	    	WHEN thci.phone_gbn = 'S' and receive_uid is not null 	    		then tm1.nm_kor 	    	WHEN thci.phone_gbn = 'R'  and send_uid is not null 	    		then tm.nm_kor 	        ELSE "-" 	        END as target_user, 			thci.receive_no, 																			 /* 수신 번호 */ 			thm.mdn, 																					 /*홈런폰 사용자 번호*/ 			thci.record_file,																			 /*녹취 파일 */ 			thci.uuid 																						 /*단말기와 일치시켜주기 위한 id */ 		FROM tz_hpm_call_info thci 		INNER JOIN tz_hpm_member thm 		ON thm.teacher_id = thci.teacher_id 		INNER JOIN tz_member tm 		ON tm.user_id = thci.teacher_id 		LEFT OUTER JOIN tz_member tm1 		ON tm1.user_id = thci.receive_uid 		  		 WHERE  tm1.nm_kor LIKE CONCAT('%', LOWER('andy3070'), '%') 			 			 			 			 			 			 			 			 			 			 			 				AND thci.record_dt  >= CONCAT('2015-01-01', ' 00:00:00') 			 				AND thci.record_dt  <= CONCAT('2015-04-30', ' 23:59:59')  	  		  ORDER BY thci.reg_dt DESC            		LIMIT 0, 30; "
2015-04-28 20:35:12,ishome[ishome],192.168.150.41,18.323565,0.000175,15,3081863,"SELECT mem_gbn             ,user_id             ,CASE WHEN user_gbn = 10001 THEN '학생'              WHEN user_gbn = 10002 THEN '학부모'              WHEN user_gbn = 99999 THEN '비회원'              ELSE '-' END as user_gbn             ,nm_kor             ,login_id             ,CONCAT(tel1,'-',tel2,'-',tel3) tel             ,tel1             ,tel2             ,tel3             ,CONCAT(mobile1,'-',mobile2,'-',mobile3) mobile             ,mobile1             ,mobile2             ,mobile3             ,email             ,zipcode             ,addr1             ,addr2             ,parent_id         FROM (             SELECT 'M' as mem_gbn                 ,user_id                 ,user_gbn                 ,nm_kor                 ,login_id                 ,tel1                 ,tel2                 ,tel3                 ,mobile1                 ,mobile2                 ,mobile3                 ,email                 ,zipcode                 ,addr1                 ,addr2                 ,parent_id             FROM tz_member                        WHERE  (             IFNULL(user_gbn_cls, '10001') IN ('10001','10003','10004','10006')             or (IFNULL(user_gbn_cls, '10001') = '10005' and IFNULL(tempid_modify_gbn, '10001') != '10001')             )                     UNION             SELECT 'G' as mem_gbn                 ,user_id                 ,'99999' as user_gbn                 ,nm_kor                 ,'' login_id                 ,tel1                 ,tel2                 ,tel3                 ,mobile1                 ,mobile2                 ,mobile3                 ,email                 ,zipcode                 ,addr1                 ,addr2                 ,'0' as parent_id             FROM tz_non_member                                                         ) mem         ORDER BY mem.nm_kor ASC         LIMIT 0, 15; "
2015-04-28 20:50:35,ishome[ishome],192.168.150.41,5.687192,0.000189,30,1298464,"SELECT  			thci.seq, 																			 		 /*시퀀스*/ 			thci.phone_gbn, 																			 /* 수,발신구분 */ 			DATE_FORMAT(thci.record_dt,'%Y-%m-%d')AS record_ymd, 										 /* 통화 일자(Y-m-d) */             CASE                 WHEN date_add(NOW(), interval - 14 day)  <=  DATE_FORMAT(thci.record_dt,'%Y-%m-%d') THEN 'Y'                 ELSE                     'N'             END AS new_yn,                                                                               /* 오늘 날짜 기준으로 통화한지 14일 이전인지 여부 */ 			DATE_FORMAT(thci.record_dt,'%H:%i:%s')AS start_record_dt,                           		 /*통화 시작 시간*/ 			SUBSTRING(thci.record_dt+ INTERVAL (thci.record_time/1000) second,12,8) AS end_record_dt,	 /*통화 종료 시간*/ 			thci.record_time, 																			 /*녹취 파일 시간 */ 			SEC_TO_TIME(thci.record_time/ 1000)as hms,                      						     /*통화 시:분:초 */ 			CASE 	    	WHEN thci.phone_gbn = 'R' then thci.send_no 	        ELSE thci.receive_no 	        END as target_no,																			 /*대상자번호*/ 	        CASE 	    	WHEN thci.phone_gbn = 'R' then thci.send_uid 	        ELSE thci.receive_uid 	        END as target_uid,   																		 /*uid검색*/ 	        floor(record_time/1000)as timeSecond,														 /*통화시간 초*/ 	        thci.teacher_id, 																			 /* 관리교사 아이디 */ 			tm.nm_kor as teacher_name, 																	 /* 관리교사 한글 이름 */ 			tm.login_id, 																				 /*로그인 아이디 */ 			tm.nm_kor as send_name, 																	 /*발신자 이름*/ 			tm.login_id as send_loginid ,																 /*발신자 아이디 */ 			thci.send_no, 																				 /* 발신 번호 */ 			thci.receive_uid, 																   		  	 /* 수신자 아이디 */ 			tm1.nm_kor as receive_name, 																 /* 수신자 이름*/ 			tm1.login_id as receive_loginid, 												  			 /*수신자 아이디*/ 			CASE 	    	WHEN thci.phone_gbn = 'S' and receive_uid is not null 	    		then tm1.nm_kor 	    	WHEN thci.phone_gbn = 'R'  and send_uid is not null 	    		then tm.nm_kor 	        ELSE "-" 	        END as target_user, 			thci.receive_no, 																			 /* 수신 번호 */ 			thm.mdn, 																					 /*홈런폰 사용자 번호*/ 			thci.record_file,																			 /*녹취 파일 */ 			thci.uuid 																						 /*단말기와 일치시켜주기 위한 id */ 		FROM tz_hpm_call_info thci 		INNER JOIN tz_hpm_member thm 		ON thm.teacher_id = thci.teacher_id 		INNER JOIN tz_member tm 		ON tm.user_id = thci.teacher_id 		LEFT OUTER JOIN tz_member tm1 		ON tm1.user_id = thci.receive_uid 		  		 WHERE  thci.record_dt  >= CONCAT('2015-04-01', ' 00:00:00') 			 				AND thci.record_dt  <= CONCAT('2015-04-30', ' 23:59:59')  	  		  ORDER BY thci.reg_dt DESC            		LIMIT 0, 30; "
2015-04-29 02:31:14,ishome[ishome],192.168.150.80,131.612350,0.001878,1,5433,"SELECT student_no               ,student_id               ,parent_id               ,teacher_id               ,group_nm               ,grade_gbn               ,gender                              ,user_id               ,login_id               ,p_login_id               ,p_nm_kor               ,nm_kor               ,tel               ,mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,pur_start_de               ,pur_end_de               ,product_no               ,last_dt               ,student_consult_dt               ,student_consult_gbn               ,student_consult_content               ,parent_consult_dt               ,parent_consult_gbn               ,parent_consult_content               ,product_nm               ,status               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status                   ,              (SELECT stat_day19 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day20 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day21 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day22 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day23 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day24 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day6         ,              (SELECT stat_day25 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day7         ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day8         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day9         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day10         ,              (SELECT stat_day29 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day11         ,                         '-'                       as stat_day12         ,                         '-'                      as stat_day13         ,              '-'                       as stat_day14                       FROM (               SELECT a.student_no                   ,a.student_id                   ,c.parent_id                   ,a.teacher_id                   ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm                   ,a.grade_gbn                   ,CASE WHEN c.gender = 'M' THEN '남'                         WHEN c.gender = 'F' THEN '여'                         ELSE '-'                   END AS gender                                  ,c.user_id                   ,c.login_id                   ,p.login_id AS p_login_id                   ,p.nm_kor AS p_nm_kor                   ,c.nm_kor                   ,CONCAT(c.tel1,'-',c.tel2,'-',c.tel3) AS tel                   ,CONCAT(c.mobile1,'-',c.mobile2,'-',c.mobile3) AS mobile                   ,c.blacklist_yn                   ,IFNULL(a.manage_start_de,'9999.99.99') as manage_start_de                   ,DATE_FORMAT(a.start_de, '%Y.%m.%d') AS start_de                   ,DATE_FORMAT(a.end_de, '%Y.%m.%d') AS end_de                   ,DATE_FORMAT(pur.start_de, '%Y.%m.%d') AS pur_start_de                   ,DATE_FORMAT(pur.end_de, '%Y.%m.%d') AS pur_end_de                   ,pur.product_no                   ,(SELECT MAX(login_dt)   FROM ishomedb.tz_connect_log WHERE user_id = a.student_id) AS last_dt                   ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=c.user_id                      AND content IS NOT NULL) AS student_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=c.user_id                      AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=c.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_content                         ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=p.user_id                       AND content IS NOT NULL) AS parent_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=p.user_id                     AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=p.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_content                   ,ishomedb.uf_study_product_nm(a.student_no) as product_nm                   ,CASE WHEN c.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보 */                         'Android'                         WHEN COALESCE(s.user_id, -1) > 0 THEN 'ON'                          ELSE 'OFF'                     END AS status                                      ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                   ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                   ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                   ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                   ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                   ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                   ,tee.app_reason             FROM ishomedb.tz_student a                             	            INNER JOIN ishomedb.tz_purchase_student pch 	            ON a.student_no = pch.temp_student_no 	            INNER JOIN ishomedb.tz_purchase pur 	            ON pch.purchase_no = pur.purchase_no 	            INNER JOIN tz_product pd 	            ON pur.product_no = pd.product_no 	                                        AND pd.service_com_yn = 'Y'                               INNER JOIN ishomedb.tz_member c             ON a.student_id = c.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = c.parent_id             INNER JOIN ishomedb.tz_teacher d             ON a.teacher_id = d.teacher_id             LEFT OUTER JOIN ishomedb.tz_connect_session s             ON a.student_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = a.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de             LEFT OUTER JOIN ishomedb.tz_experience tee              ON tee.purchase_no = pur.purchase_no and tee.parent_id = pur.purchase_no and tee.student_id = pur.student_id                            WHERE               c.search_yn = 'Y'             AND a.teacher_id = 332802             AND IFNULL(c.user_gbn_cls, '10001') != '10002'                                	             	              	                AND ( 	                    a.end_de is not null 	                    AND 	                    date_format(a.end_de, '%Y%m%d')   >=   date_format(NOW(), '%Y%m%d') 	                )  	                  	                                                                                                                AND c.nm_kor   LIKE CONCAT('이준희', '%')                                                                                                                                                                                                                                                   GROUP BY a.student_no         ) A           ORDER BY manage_start_de DESC; "
2015-04-29 02:31:15,ishome[ishome],192.168.150.80,126.243170,0.001611,138,230886,"SELECT student_no               ,student_id               ,parent_id               ,teacher_id               ,group_nm               ,grade_gbn               ,gender                              ,user_id               ,login_id               ,p_login_id               ,p_nm_kor               ,nm_kor               ,tel               ,mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,pur_start_de               ,pur_end_de               ,product_no               ,last_dt               ,student_consult_dt               ,student_consult_gbn               ,student_consult_content               ,parent_consult_dt               ,parent_consult_gbn               ,parent_consult_content               ,product_nm               ,status               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status                   ,              (SELECT stat_day19 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day20 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day21 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day22 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day23 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day24 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day6         ,              (SELECT stat_day25 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day7         ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day8         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day9         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day10         ,              (SELECT stat_day29 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day11         ,                         '-'                       as stat_day12         ,                         '-'                      as stat_day13         ,              '-'                       as stat_day14                       FROM (               SELECT a.student_no                   ,a.student_id                   ,c.parent_id                   ,a.teacher_id                   ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm                   ,a.grade_gbn                   ,CASE WHEN c.gender = 'M' THEN '남'                         WHEN c.gender = 'F' THEN '여'                         ELSE '-'                   END AS gender                                  ,c.user_id                   ,c.login_id                   ,p.login_id AS p_login_id                   ,p.nm_kor AS p_nm_kor                   ,c.nm_kor                   ,CONCAT(c.tel1,'-',c.tel2,'-',c.tel3) AS tel                   ,CONCAT(c.mobile1,'-',c.mobile2,'-',c.mobile3) AS mobile                   ,c.blacklist_yn                   ,IFNULL(a.manage_start_de,'9999.99.99') as manage_start_de                   ,DATE_FORMAT(a.start_de, '%Y.%m.%d') AS start_de                   ,DATE_FORMAT(a.end_de, '%Y.%m.%d') AS end_de                   ,DATE_FORMAT(pur.start_de, '%Y.%m.%d') AS pur_start_de                   ,DATE_FORMAT(pur.end_de, '%Y.%m.%d') AS pur_end_de                   ,pur.product_no                   ,(SELECT MAX(login_dt)   FROM ishomedb.tz_connect_log WHERE user_id = a.student_id) AS last_dt                   ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=c.user_id                      AND content IS NOT NULL) AS student_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=c.user_id                      AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=c.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_content                         ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=p.user_id                       AND content IS NOT NULL) AS parent_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=p.user_id                     AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=p.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_content                   ,ishomedb.uf_study_product_nm(a.student_no) as product_nm                   ,CASE WHEN c.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보 */                         'Android'                         WHEN COALESCE(s.user_id, -1) > 0 THEN 'ON'                          ELSE 'OFF'                     END AS status                                      ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                   ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                   ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                   ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                   ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                   ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                   ,tee.app_reason             FROM ishomedb.tz_student a                             	            INNER JOIN ishomedb.tz_purchase_student pch 	            ON a.student_no = pch.temp_student_no 	            INNER JOIN ishomedb.tz_purchase pur 	            ON pch.purchase_no = pur.purchase_no 	            INNER JOIN tz_product pd 	            ON pur.product_no = pd.product_no 	                                        AND pd.service_com_yn = 'Y'                               INNER JOIN ishomedb.tz_member c             ON a.student_id = c.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = c.parent_id             INNER JOIN ishomedb.tz_teacher d             ON a.teacher_id = d.teacher_id             LEFT OUTER JOIN ishomedb.tz_connect_session s             ON a.student_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = a.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de             LEFT OUTER JOIN ishomedb.tz_experience tee              ON tee.purchase_no = pur.purchase_no and tee.parent_id = pur.purchase_no and tee.student_id = pur.student_id                            WHERE               c.search_yn = 'Y'             AND a.teacher_id = 332802             AND IFNULL(c.user_gbn_cls, '10001') != '10002'                                	             	              	                AND ( 	                    a.end_de is not null 	                    AND 	                    date_format(a.end_de, '%Y%m%d')   >=   date_format(NOW(), '%Y%m%d') 	                )  	                  	                                                                                                                                                                                                                                              GROUP BY a.student_no         ) A           ORDER BY manage_start_de DESC; "
2015-04-29 10:08:40,ishome[ishome],192.168.150.41,5.415466,0.000098,323,981407,"SELECT  contents_no                ,objectname_kor                ,headline                ,pic_src_memo                ,pic_srcname         FROM   ishomedb.tz_cms_contents         WHERE  media_type   = 'MOV'         AND    (contents_no = '사회'                OR objectname_kor LIKE CONCAT('%', '사회', '%')); "
2015-04-29 10:42:59,ishome[ishome],192.168.150.41,18.833081,0.000409,13689,59314181,"SELECT  	date_format(s_mem.reg_dt, '%Y-%m-%d') AS 가입일     ,date_format(pur.purchase_dt, '%Y-%m-%d') AS 주문일시     ,pur.purchase_no AS 주문번호     ,'' AS 입금자     ,p_mem.nm_kor AS 학부모명     ,p_mem.login_id AS 학부모ID     ,s_mem.nm_kor AS 학생명     ,s_mem.login_id AS 학생ID     ,t_mem.nm_kor AS 관리교사명     ,IFNULL(stu.manage_start_de, '') AS 배정일     ,sch.schoolname AS 학교     ,s_mem.grade_gbn AS 학년     ,s_mem.class_gbn AS 반     ,s_mem.gender AS 성별     ,pro.product_nm AS 상품     ,code.code_nm AS 상태     ,pur.start_de AS 학습시작일     ,pur.end_de AS 학습종료일     ,(SELECT MIN(date_format(login_dt, '%Y-%m-%d')) FROM tz_connect_log WHERE user_id = s_mem.user_id) AS 최초로그인     ,p_mem.zipcode AS 우편번호     ,p_mem.addr1 AS 지역     ,p_mem.addr2 AS 상세주소     ,CONCAT(p_mem.mobile1,'-',p_mem.mobile2,'-',p_mem.mobile3) as 학부모휴대전화     ,p_mem.email as 학부모이메일     ,CASE (SELECT COUNT(purchase_no) FROM tz_purchase WHERE purchase_id = p_mem.user_id AND product_no = '15') > 0      WHEN true THEN 'Y' ELSE 'N' END AS 웹체험여부     ,CASE WHEN p_mem.join_gbn IS NOT NULL THEN       uf_code_nm(10160,p_mem.join_gbn)      ELSE       p_mem.join_gbn_dir      END as 유입경로 ,CASE pro.service_homebook_yn WHEN 'Y' THEN 'B형' ELSE 'A형' END AS 기기구분값 ,(SELECT tgb.title 	FROM ishomedb.tz_gift_log tgl 	INNER JOIN ishomedb.tz_gift_book tgb ON tgl.giftbook_no = tgb.giftbook_no 	WHERE tgl.product_no = pur.product_no and tgl.reg_id = pur.reg_id 	LIMIT 1) as 우대권명 FROM tz_purchase pur  LEFT JOIN tz_member p_mem ON pur.purchase_id = p_mem.user_id LEFT JOIN tz_member s_mem ON pur.student_id = s_mem.user_id LEFT JOIN tz_student stu ON pur.student_id = stu.student_id LEFT JOIN tz_member t_mem ON stu.teacher_id = t_mem.user_id LEFT JOIN tz_product pro ON pur.product_no = pro.product_no LEFT JOIN tz_code code ON pur.status_gbn = code.code_no AND code.code_gbn = '10118' LEFT JOIN tz_school sch ON s_mem.school_no = sch.school_no WHERE pur.purchase_dt <= '2015-06-30 23:59:59'     AND pur.purchase_dt >= '2015-04-01 00:00:00'; "
2015-04-30 02:43:26,ishome[ishome],192.168.150.80,293.533692,0.001841,1,247,"SELECT student_no               ,student_id               ,parent_id               ,teacher_id               ,group_nm               ,grade_gbn               ,gender                              ,user_id               ,login_id               ,p_login_id               ,p_nm_kor               ,nm_kor               ,tel               ,mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,pur_start_de               ,pur_end_de               ,product_no               ,last_dt               ,student_consult_dt               ,student_consult_gbn               ,student_consult_content               ,parent_consult_dt               ,parent_consult_gbn               ,parent_consult_content               ,product_nm               ,status               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status                   ,              (SELECT stat_day19 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day20 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day21 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day22 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day23 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day24 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day6         ,              (SELECT stat_day25 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day7         ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day8         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day9         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day10         ,              (SELECT stat_day29 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day11         ,              (SELECT stat_day30 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day12         ,                         '-'                      as stat_day13         ,              '-'                       as stat_day14                       FROM (               SELECT a.student_no                   ,a.student_id                   ,c.parent_id                   ,a.teacher_id                   ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm                   ,a.grade_gbn                   ,CASE WHEN c.gender = 'M' THEN '남'                         WHEN c.gender = 'F' THEN '여'                         ELSE '-'                   END AS gender                                  ,c.user_id                   ,c.login_id                   ,p.login_id AS p_login_id                   ,p.nm_kor AS p_nm_kor                   ,c.nm_kor                   ,CONCAT(c.tel1,'-',c.tel2,'-',c.tel3) AS tel                   ,CONCAT(c.mobile1,'-',c.mobile2,'-',c.mobile3) AS mobile                   ,c.blacklist_yn                   ,IFNULL(a.manage_start_de,'9999.99.99') as manage_start_de                   ,DATE_FORMAT(a.start_de, '%Y.%m.%d') AS start_de                   ,DATE_FORMAT(a.end_de, '%Y.%m.%d') AS end_de                   ,DATE_FORMAT(pur.start_de, '%Y.%m.%d') AS pur_start_de                   ,DATE_FORMAT(pur.end_de, '%Y.%m.%d') AS pur_end_de                   ,pur.product_no                   ,(SELECT MAX(login_dt)   FROM ishomedb.tz_connect_log WHERE user_id = a.student_id) AS last_dt                   ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=c.user_id                      AND content IS NOT NULL) AS student_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=c.user_id                      AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=c.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_content                         ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=p.user_id                       AND content IS NOT NULL) AS parent_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=p.user_id                     AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=p.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_content                   ,ishomedb.uf_study_product_nm(a.student_no) as product_nm                   ,CASE WHEN c.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보 */                         'Android'                         WHEN COALESCE(s.user_id, -1) > 0 THEN 'ON'                          ELSE 'OFF'                     END AS status                                      ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                   ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                   ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                   ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                   ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                   ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                   ,tee.app_reason             FROM ishomedb.tz_student a                             	            INNER JOIN ishomedb.tz_purchase_student pch 	            ON a.student_no = pch.temp_student_no 	            INNER JOIN ishomedb.tz_purchase pur 	            ON pch.purchase_no = pur.purchase_no 	            INNER JOIN tz_product pd 	            ON pur.product_no = pd.product_no 	                                        AND pd.service_com_yn = 'Y'                               INNER JOIN ishomedb.tz_member c             ON a.student_id = c.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = c.parent_id             INNER JOIN ishomedb.tz_teacher d             ON a.teacher_id = d.teacher_id             LEFT OUTER JOIN ishomedb.tz_connect_session s             ON a.student_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = a.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de             LEFT OUTER JOIN ishomedb.tz_experience tee              ON tee.purchase_no = pur.purchase_no and tee.parent_id = pur.purchase_no and tee.student_id = pur.student_id                            WHERE               c.search_yn = 'Y'             AND a.teacher_id = 620141             AND IFNULL(c.user_gbn_cls, '10001') != '10002'                                	             	              	                AND ( 	                    a.end_de is not null 	                    AND 	                    date_format(a.end_de, '%Y%m%d')   >=   date_format(NOW(), '%Y%m%d') 	                )  	                  	                                                                                                                AND c.nm_kor   LIKE CONCAT('채영은', '%')                                                                                                                                                                                                                                                   GROUP BY a.student_no         ) A           ORDER BY manage_start_de DESC; "
2015-04-30 02:43:26,ishome[ishome],192.168.150.80,279.607594,0.001230,60,51413,"SELECT student_no               ,student_id               ,parent_id               ,teacher_id               ,group_nm               ,grade_gbn               ,gender                              ,user_id               ,login_id               ,p_login_id               ,p_nm_kor               ,nm_kor               ,tel               ,mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,pur_start_de               ,pur_end_de               ,product_no               ,last_dt               ,student_consult_dt               ,student_consult_gbn               ,student_consult_content               ,parent_consult_dt               ,parent_consult_gbn               ,parent_consult_content               ,product_nm               ,status               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status                   ,              (SELECT stat_day19 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day20 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day21 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day22 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day23 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day24 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day6         ,              (SELECT stat_day25 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day7         ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day8         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day9         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day10         ,              (SELECT stat_day29 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day11         ,              (SELECT stat_day30 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day12         ,                         '-'                      as stat_day13         ,              '-'                       as stat_day14                       FROM (               SELECT a.student_no                   ,a.student_id                   ,c.parent_id                   ,a.teacher_id                   ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm                   ,a.grade_gbn                   ,CASE WHEN c.gender = 'M' THEN '남'                         WHEN c.gender = 'F' THEN '여'                         ELSE '-'                   END AS gender                                  ,c.user_id                   ,c.login_id                   ,p.login_id AS p_login_id                   ,p.nm_kor AS p_nm_kor                   ,c.nm_kor                   ,CONCAT(c.tel1,'-',c.tel2,'-',c.tel3) AS tel                   ,CONCAT(c.mobile1,'-',c.mobile2,'-',c.mobile3) AS mobile                   ,c.blacklist_yn                   ,IFNULL(a.manage_start_de,'9999.99.99') as manage_start_de                   ,DATE_FORMAT(a.start_de, '%Y.%m.%d') AS start_de                   ,DATE_FORMAT(a.end_de, '%Y.%m.%d') AS end_de                   ,DATE_FORMAT(pur.start_de, '%Y.%m.%d') AS pur_start_de                   ,DATE_FORMAT(pur.end_de, '%Y.%m.%d') AS pur_end_de                   ,pur.product_no                   ,(SELECT MAX(login_dt)   FROM ishomedb.tz_connect_log WHERE user_id = a.student_id) AS last_dt                   ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=c.user_id                      AND content IS NOT NULL) AS student_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=c.user_id                      AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=c.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_content                         ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=p.user_id                       AND content IS NOT NULL) AS parent_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=p.user_id                     AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=p.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_content                   ,ishomedb.uf_study_product_nm(a.student_no) as product_nm                   ,CASE WHEN c.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보 */                         'Android'                         WHEN COALESCE(s.user_id, -1) > 0 THEN 'ON'                          ELSE 'OFF'                     END AS status                                      ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                   ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                   ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                   ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                   ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                   ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                   ,tee.app_reason             FROM ishomedb.tz_student a                             	            INNER JOIN ishomedb.tz_purchase_student pch 	            ON a.student_no = pch.temp_student_no 	            INNER JOIN ishomedb.tz_purchase pur 	            ON pch.purchase_no = pur.purchase_no 	            INNER JOIN tz_product pd 	            ON pur.product_no = pd.product_no 	                                        AND pd.service_com_yn = 'Y'                               INNER JOIN ishomedb.tz_member c             ON a.student_id = c.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = c.parent_id             INNER JOIN ishomedb.tz_teacher d             ON a.teacher_id = d.teacher_id             LEFT OUTER JOIN ishomedb.tz_connect_session s             ON a.student_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = a.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de             LEFT OUTER JOIN ishomedb.tz_experience tee              ON tee.purchase_no = pur.purchase_no and tee.parent_id = pur.purchase_no and tee.student_id = pur.student_id                            WHERE               c.search_yn = 'Y'             AND a.teacher_id = 620141             AND IFNULL(c.user_gbn_cls, '10001') != '10002'                                	             	              	                AND ( 	                    a.end_de is not null 	                    AND 	                    date_format(a.end_de, '%Y%m%d')   >=   date_format(NOW(), '%Y%m%d') 	                )  	                  	                                                                                                                                                                                                                                              GROUP BY a.student_no         ) A           ORDER BY manage_start_de DESC; "
2015-04-30 02:52:52,ishome[ishome],114.207.114.57,303.110111,0.000114,2,7331,"SELECT concat(sk.subj_knd_nm_short, ' ', bp.start_page, '쪽~', bp.end_page,'쪽') as result 					 FROM ishomedb.tz_lcms_book_page bp 					 INNER JOIN ishomedb.tz_lcms_subj_knd sk 					 ON sk.subj_knd_no = bp.subj_knd_no 					 WHERE EXISTS ( 								 SELECT 1 								 FROM ishomedb.tz_lcms_study_lesson l 								 INNER JOIN ishomedb.tz_lcms_subj s 								 ON l.subj_no = s.subj_no 								 WHERE l.subj_lesson_no = bp.subj_lesson_no 								 and l.subj_no = 27 								 and l.subj_lesson_no = 118 							 ); "
2015-04-30 09:49:47,ishome[ishome],192.168.150.80,13.052010,0.000446,13917,10431461,"SELECT a.f_stu_test_id 		    ,a.f_test_id 		    ,a.f_user_cd 		    ,a.f_point 		    ,a.f_ischeckpoint 		    ,c.f_subject_cd /*과목CD */ 		    ,c.f_grade_cd /*학년CD */ 		    ,c.f_kind_cd 		    ,DATE_FORMAT(a.f_test_dt, '%Y.%m.%d') f_test_dt /*평가일*/ 		    ,IFNULL(DATE_FORMAT(a.f_checkpoint_dt, '%Y.%m.%d'), '미채점') f_checkpoint_dt /*채점일*/ 	        ,CONCAT('[', SUBSTRING(c.f_grade_cd, -1), '-', SUBSTRING(c.f_term_cd, -1), ' ', z.f_caption,  	          CASE WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN '] ' 	               ELSE CONCAT(' ', SUBSTRING(lsl.order_key, 1, 2), '] ') 	          END,  	            CASE WHEN lsl.lesson_gbn = 10001 THEN CONCAT(lsl.sort, '.') 	                 WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN '' 	                 ELSE CONCAT(lsl.sort, '장.')  	            END,  	            CASE WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN c.f_test_nm 	                 WHEN CHAR_LENGTH(c.f_test_nm) > 12 THEN CONCAT(SUBSTRING(c.f_test_nm, 1, 9), '...')  	                 ELSE c.f_test_nm END,  	            CONCAT('(', c.f_no, '회차)')) AS f_test_nm 	        ,CONCAT('[', SUBSTRING(c.f_grade_cd, -1), '-', SUBSTRING(c.f_term_cd, -1), ' ', z.f_caption,  	          CASE WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN '] ' 	               ELSE CONCAT(' ', SUBSTRING(lsl.order_key, 1, 2), '] ') 	          END,  	            CASE WHEN lsl.lesson_gbn = 10001 THEN CONCAT(lsl.sort, '.') 	                 WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN '' 	                 ELSE CONCAT(lsl.sort, '장.')  	            END, c.f_test_nm,  	            CONCAT('(', c.f_no, '회차)')) AS f_test_nm_all 		    ,m.login_id 		    ,m.user_id 		    ,m.nm_kor user_nm 		    ,a.student_no 		    ,a.teacher_id 		    ,x.f_caption f_kind_cd_nm    /*평가구분*/ 		    ,y.f_caption f_grade_cd_nm   /*학년구분*/ 		    ,z.f_caption f_subject_cd_nm /*과목구분*/ 		    ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm  		    ,c.f_problem_cnt             ,SUM(IF(stp.f_result='0', 0, 1)) AS r_cnt             ,SUM(IF(stp.f_result='0', 1, 0)) AS w_cnt 	    FROM ( 	        SELECT st.* 	            ,ist.student_no 	            ,ist.student_id 	            ,ist.teacher_id 	            ,ist.group_no 	        FROM edubasestudydb.t_student_test st 	        INNER JOIN ( 	            SELECT MAX(f_stu_test_id) AS f_stu_test_id, s.* 	            FROM edubasestudydb.t_student_test st 	            INNER JOIN ishomedb.tz_student s  	            ON st.f_user_cd = s.student_no 	            WHERE s.teacher_id = 366200                 AND DATE_FORMAT(IFNULL(s.end_de, NOW()), '%Y-%m-%d') >= DATE_FORMAT(NOW(), '%Y-%m-%d') 	            GROUP BY f_test_id, f_user_cd 	        ) ist 	        ON st.f_stu_test_id = ist.f_stu_test_id 	    ) a 		INNER JOIN ishomedb.tz_purchase_student pch  		ON a.student_no = pch.temp_student_no 		INNER JOIN ishomedb.tz_purchase pur 		ON pch.purchase_no = pur.purchase_no 		INNER JOIN ishomedb.tz_member m 		ON a.student_id = m.user_id     		INNER JOIN edubasestudydb.t_test c 		ON a.f_test_id = c.f_test_id         INNER JOIN ishomedb.tz_lcms_study_lesson lsl         ON lsl.subj_lesson_no = c.f_chapter_cd 		INNER JOIN edubasestudydb.t_code_ref x 		ON c.f_kind_cd = CONCAT(x.f_group_id, x.f_detail_id) AND x.f_group_id = 'T1' 		INNER JOIN edubasestudydb.t_code_ref y  		ON c.f_grade_cd = CONCAT(y.f_group_id, y.f_detail_id) AND y.f_group_id = 'GR' 		INNER JOIN edubasestudydb.t_code_ref z  		ON c.f_subject_cd = CONCAT(z.f_group_id, z.f_detail_id) AND z.f_group_id = 'SB' 		LEFT OUTER JOIN edubasestudydb.t_student_test_problem stp 		ON stp.f_stu_test_id = a.f_stu_test_id         WHERE IFNULL(pur.status_gbn, '') != 10010                                                                                                                 GROUP BY a.f_stu_test_id         ORDER BY                    f_ischeckpoint DESC, f_test_dt DESC, c.f_grade_cd, c.f_term_cd, c.f_subject_cd, c.f_kind_cd, c.f_no; "
2015-04-30 11:19:17,ishome[ishome],192.168.150.41,12.352482,0.000228,10,16006126,"SELECT  a.history_no    /* seq 번호 */                ,a.student_no    /* 학생등록번호 */                ,a.student_id    /* 학생회원ID */                ,b.nm_kor                ,b.login_id                ,a.point_gbn     /* 콘 구분 코드 */                ,CASE a.point_gbn                     WHEN '10131' THEN '수행콘'                     WHEN '10132' THEN '성과콘'                     WHEN '10133' THEN '이벤트콘'                 END as gbn_nm                ,a.point_grp    /* 콘 분류 */                ,ishomedb.uf_code_nm(a.point_gbn, a.point_grp) grp_nm   /* 콘 구분 코드명 */                ,CASE a.point_type          /* 적립/소멸 */                   WHEN 1 THEN '적립'                  WHEN 2 THEN '소멸'                  ELSE '-'                 END                  as point_type                ,ishomedb.uf_point_nm(a.point_gbn, a.point_grp, a.guide_no) point_nm   /* 콘 명칭 */                ,CONCAT(                 CASE a.point_type          /* 적립/소멸 */                   WHEN 2 THEN '-'                  ELSE ''                 END , a.point) as point         /* 적립포인트 */                ,a.reg_id        /* 등록 ID */                ,a.reg_dt        /* 등록일 */                ,a.reg_ip        /* 등록 IP */                ,a.upd_id        /* 수정 ID */                ,a.upd_dt        /* 수정일 */                ,a.upd_ip        /* 수정 IP */         FROM   tz_point_history a, tz_member b                    WHERE a.student_id = b.user_id             AND a.guide_no = '127'                    ORDER  BY a.history_no DESC         LIMIT  20, 10; "
2015-04-30 12:12:41,ishome[ishome],192.168.150.41,9.846093,0.000561,15636,3224668,"SELECT paid.split_paid_no               ,pur.purchase_no               ,pb.nm_kor AS paid_nm_kor               ,p_mem.nm_kor AS p_mem_name               ,p_mem.login_id AS p_mem_id               ,s_mem.nm_kor AS s_mem_name               ,s_mem.login_id AS s_mem_id               ,mng_std.grade_gbn AS grade_gbn               ,p_mem.zipcode AS zip_code               ,CONCAT(p_mem.addr1, ' ', p_mem.addr2) AS addr               ,CONCAT(p_mem.tel1, p_mem.tel2, p_mem.tel3) AS tel_no               ,CONCAT(p_mem.mobile1, p_mem.mobile2, p_mem.mobile3) AS mobile_no               ,prd.product_nm               ,paid.batch_key               ,paid.paid_day               ,DATE_FORMAT(paid.reg_dt, '%Y-%m-%d') AS paid_reg_dt               ,DATE_FORMAT(MIN(auth_ymd),'%Y-%m-%d') AS first_batch_dt               ,DATE_FORMAT(MAX(pb.auth_ymd),'%Y-%m-%d') AS last_batch_dt               ,SUM(IF(pb.progress = 'Y', 1, 0)) AS succ_cnt               ,paid.split_month               ,pb.error_cnt + 1 AS paid_request_cnt               ,pb.result_msg AS last_paid_status               ,purchase_code.code_nm AS status_gbn               ,CASE WHEN paid.del_yn = 'Y' Then '삭제'                     ELSE code.code_nm                END AS code_nm                ,tt.team_nm as team_nm /* 담당교사 팀 */               ,upd_mem.nm_kor AS upd_nm_kor /* 담당선생님 */               ,CONCAT(manage_mem.nm_kor, '(', manage_mem.login_id, ')') AS manage_info               ,manage_dt               ,ishomedb.uf_purchase_side_delivery_info(pur.purchase_no) as side_info               ,(                 SELECT c.product_nm                 FROM ishomedb.tz_purchase a                 INNER JOIN ishomedb.tz_product c ON c.product_no = a.product_no                  AND c.use_yn = 'Y' AND c.service_experience_yn = 'Y'                 WHERE a.student_id = paid.student_id and a.start_de != '' and a.start_de IS NOT NULL                 ORDER BY a.purchase_no DESC                 LIMIT 1               ) AS prev_product_nm                 ,(                 SELECT concat(a.start_de,'~',a.end_de)                 FROM ishomedb.tz_purchase a                 INNER JOIN ishomedb.tz_product c ON c.product_no = a.product_no                  AND c.use_yn = 'Y' AND c.service_experience_yn = 'Y'                 WHERE a.student_id = paid.student_id and a.start_de != '' and a.start_de IS NOT NULL                 ORDER BY a.purchase_no DESC                 LIMIT 1               ) AS pre_study_de         FROM ishomedb.tz_split_paid paid          LEFT OUTER JOIN ishomedb.tz_purchase pur          ON paid.purchase_no = pur.purchase_no         LEFT OUTER JOIN ishomedb.tz_purchase_batch pb         ON paid.split_paid_no = pb.split_paid_no         /* 신청자정보 */         LEFT JOIN ishomedb.tz_member p_mem         ON paid.parent_id = p_mem.user_id         /* 학습자정보 */         LEFT JOIN ishomedb.tz_member s_mem         ON paid.student_id = s_mem.user_id         /* 담당자 - 담당선생  */         LEFT JOIN ishomedb.tz_student mng_std         ON paid.student_id = mng_std.student_id         LEFT JOIN ishomedb.tz_member upd_mem         ON mng_std.teacher_id = upd_mem.user_id         /* 상품정보 */         LEFT JOIN ishomedb.tz_product prd         ON prd.product_no = paid.product_no         /* 출하상태  10118 */         LEFT JOIN ishomedb.tz_code purchase_code         ON pur.status_gbn = purchase_code.code_no         AND purchase_code.code_gbn = 10118         /* 월결제상태  10177 */         LEFT JOIN ishomedb.tz_code code         ON paid.paid_status = code.code_no         AND code.code_gbn = 10177                 /* 담당자 - 담당선생  팀파트*/         LEFT OUTER JOIN ishomedb.tz_teacher tec         ON tec.teacher_id = upd_mem.user_id         LEFT OUTER JOIN ishomedb.tz_teacher_team_part ttp         ON ttp.part_no = tec.part_no         LEFT JOIN ishomedb.tz_teacher_team tt         ON ttp.team_no = tt.team_no         /* 담당자 정보 */         LEFT JOIN ishomedb.tz_member manage_mem         ON paid.manage_id = manage_mem.user_id          WHERE  paid.reg_dt  >=  CONCAT('2015.01.01', ' 00:00:00')                                           AND paid.reg_dt  <=  CONCAT('2015.04.30', ' 23:59:59')                                                                                                                       AND code.code_no IN (10003,10004,10008)           GROUP BY paid.split_paid_no         ORDER BY paid.split_paid_no DESC; "
2015-04-30 20:02:17,ishome[ishome],192.168.150.41,8.432418,0.000413,11588,2439530,"SELECT paid.split_paid_no               ,pur.purchase_no               ,pb.nm_kor AS paid_nm_kor               ,p_mem.nm_kor AS p_mem_name               ,p_mem.login_id AS p_mem_id               ,s_mem.nm_kor AS s_mem_name               ,s_mem.login_id AS s_mem_id               ,mng_std.grade_gbn AS grade_gbn               ,p_mem.zipcode AS zip_code               ,CONCAT(p_mem.addr1, ' ', p_mem.addr2) AS addr               ,CONCAT(p_mem.tel1, p_mem.tel2, p_mem.tel3) AS tel_no               ,CONCAT(p_mem.mobile1, p_mem.mobile2, p_mem.mobile3) AS mobile_no               ,prd.product_nm               ,paid.batch_key               ,paid.paid_day               ,DATE_FORMAT(paid.reg_dt, '%Y-%m-%d') AS paid_reg_dt               ,DATE_FORMAT(MIN(auth_ymd),'%Y-%m-%d') AS first_batch_dt               ,DATE_FORMAT(MAX(pb.auth_ymd),'%Y-%m-%d') AS last_batch_dt               ,SUM(IF(pb.progress = 'Y', 1, 0)) AS succ_cnt               ,paid.split_month               ,pb.error_cnt + 1 AS paid_request_cnt               ,pb.result_msg AS last_paid_status               ,purchase_code.code_nm AS status_gbn               ,CASE WHEN paid.del_yn = 'Y' Then '삭제'                     ELSE code.code_nm                END AS code_nm                ,tt.team_nm as team_nm /* 담당교사 팀 */               ,upd_mem.nm_kor AS upd_nm_kor /* 담당선생님 */               ,CONCAT(manage_mem.nm_kor, '(', manage_mem.login_id, ')') AS manage_info               ,manage_dt               ,ishomedb.uf_purchase_side_delivery_info(pur.purchase_no) as side_info               ,(                 SELECT c.product_nm                 FROM ishomedb.tz_purchase a                 INNER JOIN ishomedb.tz_product c ON c.product_no = a.product_no                  AND c.use_yn = 'Y' AND c.service_experience_yn = 'Y'                 WHERE a.student_id = paid.student_id and a.start_de != '' and a.start_de IS NOT NULL                 ORDER BY a.purchase_no DESC                 LIMIT 1               ) AS prev_product_nm                 ,(                 SELECT concat(a.start_de,'~',a.end_de)                 FROM ishomedb.tz_purchase a                 INNER JOIN ishomedb.tz_product c ON c.product_no = a.product_no                  AND c.use_yn = 'Y' AND c.service_experience_yn = 'Y'                 WHERE a.student_id = paid.student_id and a.start_de != '' and a.start_de IS NOT NULL                 ORDER BY a.purchase_no DESC                 LIMIT 1               ) AS pre_study_de         FROM ishomedb.tz_split_paid paid          LEFT OUTER JOIN ishomedb.tz_purchase pur          ON paid.purchase_no = pur.purchase_no         LEFT OUTER JOIN ishomedb.tz_purchase_batch pb         ON paid.split_paid_no = pb.split_paid_no         /* 신청자정보 */         LEFT JOIN ishomedb.tz_member p_mem         ON paid.parent_id = p_mem.user_id         /* 학습자정보 */         LEFT JOIN ishomedb.tz_member s_mem         ON paid.student_id = s_mem.user_id         /* 담당자 - 담당선생  */         LEFT JOIN ishomedb.tz_student mng_std         ON paid.student_id = mng_std.student_id         LEFT JOIN ishomedb.tz_member upd_mem         ON mng_std.teacher_id = upd_mem.user_id         /* 상품정보 */         LEFT JOIN ishomedb.tz_product prd         ON prd.product_no = paid.product_no         /* 출하상태  10118 */         LEFT JOIN ishomedb.tz_code purchase_code         ON pur.status_gbn = purchase_code.code_no         AND purchase_code.code_gbn = 10118         /* 월결제상태  10177 */         LEFT JOIN ishomedb.tz_code code         ON paid.paid_status = code.code_no         AND code.code_gbn = 10177                 /* 담당자 - 담당선생  팀파트*/         LEFT OUTER JOIN ishomedb.tz_teacher tec         ON tec.teacher_id = upd_mem.user_id         LEFT OUTER JOIN ishomedb.tz_teacher_team_part ttp         ON ttp.part_no = tec.part_no         LEFT JOIN ishomedb.tz_teacher_team tt         ON ttp.team_no = tt.team_no         /* 담당자 정보 */         LEFT JOIN ishomedb.tz_member manage_mem         ON paid.manage_id = manage_mem.user_id          WHERE  paid.reg_dt  >=  CONCAT('2015.01.28', ' 00:00:00')                                           AND paid.reg_dt  <=  CONCAT('2015.04.30', ' 23:59:59')                                                                                                                       AND code.code_no IN (10004)           GROUP BY paid.split_paid_no         ORDER BY paid.split_paid_no DESC; "
2015-05-01 02:30:57,ishome[ishome],192.168.150.80,265.830245,0.000124,1,1,"SELECT    stu.student_no                  ,stu.student_id                  ,pst.purchase_no                  ,stu.start_de                  ,stu.end_de                  ,mem.user_id                  ,mem.nm_kor                  ,mem.login_id                    ,mem.grade_gbn                  ,stu.device_no              FROM     ishomedb.tz_student stu         INNER    JOIN ishomedb.tz_member mem         ON       stu.student_id = mem.user_id         INNER    JOIN ishomedb.tz_purchase_student pst         ON       stu.student_no = pst.temp_student_no         WHERE    stu.student_no =  '148100'; "
2015-05-01 02:30:57,ishome[ishome],192.168.150.80,261.079432,0.000090,1,7,"SELECT  category_no AS code                ,category_nm AS label         FROM    ishomedb.tz_lcms_theme_category                  WHERE   /* use_yn = 'Y' */ 1=1                                AND  upper_no = '1'                                          AND  category_no NOT IN ( 3, 26, 29, 18457, 15825, 18587 )                            ORDER   BY category_no; "
2015-05-01 02:30:57,ishome[ishome],192.168.150.80,194.764473,0.000116,1,1,"SELECT IFNULL(attend_dt, '-') as attend_dt               , IFNULL(leave_dt, '-') as leave_dt         FROM tz_teacher_attend          WHERE  work_de = curdate() - INTERVAL 1 DAY                    AND attend_dt >= curdate() - INTERVAL 1 DAY                                                   AND teacher_id = 123491; "
2015-05-01 02:30:57,ishome[ishome],192.168.150.80,191.186055,0.000093,1,1,"SELECT  master_no           /* 게시판 번호 */                ,master_nm           /* 게시판명 */                ,type_gbn            /* 유형구분코드 */                ,admin_list_cnt      /* 기본출력갯수(관리자) */                ,site_list_cnt       /* 기본출력갯수(웹사이트) */                ,category_yn         /* 카테고리사용여부 */                ,file_attach_yn      /* 첨부파일기능여부 */                ,file_limit_mb       /* 총제한용량 */                ,file_limit_cnt      /* 첨부파일제한갯수 */                ,reply_yn            /* 답글기능여부 */                ,description         /* 게시판 설명 */         FROM   ishomedb.tz_board_master         WHERE  master_id = '84059af4fe1e449ab446d0e435bbc48a'; "
2015-05-01 02:30:57,ishome[ishome],192.168.150.80,230.655430,0.000423,1,184,"SELECT  b.user_id                ,b.nm_kor                ,b.login_id                ,b.login_pwd                ,b.jumin_no1                ,b.jumin_no2                ,b.birth_de                ,CASE WHEN b.gender = 'M' THEN '남'                 WHEN b.gender = 'F' THEN '여'                 ELSE '-'                 END as gender                               ,( case when b.calendar_gbn = 'S' then '양력' else '음력' end ) as calendar_gbn                ,(select schoolname from ishomedb.tz_school where school_no = b.school_no) as schoolname                ,CONCAT(b.tel1, '-', b.tel2, '-', b.tel3) AS tel                ,CONCAT(b.mobile1, '-', b.mobile2, '-', b.mobile3) AS mobile                ,b.sms_yn                ,b.email                ,b.zipcode                ,b.addr1                ,b.addr2                ,ishomedb.uf_code_grade_nm(a.grade_gbn) as grade_gbn                ,a.device_no                ,a.student_no                ,a.student_id                ,a.teacher_id                ,a.start_de                ,a.end_de                ,a.grade_gbn as s_grade_gbn                ,b.parent_id                ,c.nm_kor as p_nm_kor                ,c.login_id as p_login_id                ,CONCAT(c.tel1, '-', c.tel2, '-', c.tel3) AS p_tel                ,CONCAT(c.mobile1, '-', c.mobile2, '-', c.mobile3) AS p_mobile                ,SUBSTRING_INDEX(ishomedb.uf_experience_info(b.parent_id, a.student_id), '%|%', 1) AS exp_info_dir                ,SUBSTRING_INDEX(ishomedb.uf_experience_info(b.parent_id, a.student_id), '%|%', 2) AS exp_info_reason                ,(SELECT SUM(point) FROM tz_point_history WHERE student_id = a.student_id) as point                ,c.dual_work                ,CASE WHEN b.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보. 이영무 */                             'Android'                       WHEN COALESCE((SELECT DISTINCT user_id FROM ishomedb.tz_connect_session WHERE user_id = b.user_id), -1) > 0 THEN 'ON'                       ELSE 'OFF'                  END AS status                 ,b.user_gbn_cls /* 안드로이드 사용자 구분용. 이영무 */                 ,IFNULL(a.today_feeling, '') AS today_feeling /* 오늘의 기분. 이영무 */                 ,IF(a.today_feeling_dt is null, '', DATE_FORMAT(a.today_feeling_dt,'%Y-%m-%d %H:%i'))  AS today_feeling_dt /*오늘의 기분 설정일*/ 		 FROM  ishomedb.tz_student a, ishomedb.tz_member b, ishomedb.tz_member c 		 WHERE  a.student_id = b.user_id 		 AND  b.parent_id  = c.user_id 		 AND  a.student_no = '267703'; "
2015-05-01 02:30:57,ishome[ishome],192.168.150.80,301.090995,0.000277,4,392,"SELECT   act.grade_gbn, act.subj_gbn                                           /* 과목코드 */                 ,uf_code_nm('10101',act.subj_gbn ) as code_nm                 ,act.total_cnt                                          /* 전체 */                 ,act.act_cnt                                            /* 시작된 학습 */                 ,act.clear_cnt                                          /* 예복습완료 + 평가제출 = 완료 학습 */                 ,(act.act_cnt - clear_cnt) AS unclear_cnt               /* 미완료 */                 ,(act.total_cnt - act.act_cnt) AS befor_study_cnt       /* 학습 전 */                 ,100*(act.clear_cnt/act.total_cnt) AS act_rate         FROM    (SELECT  act.grade_gbn, act.subj_gbn                          ,COUNT(act.module_no) AS total_cnt                          ,SUM(act.act_dt) AS act_cnt                          ,SUM(act.clear_dt) AS clear_cnt                  FROM    (SELECT  sbj.grade_gbn, sbj.subj_gbn                                  ,modu.module_no                                  ,CASE WHEN act.act_dt IS NULL THEN 0 ELSE 1 END AS act_dt                                  ,CASE WHEN act.clear_dt IS NULL THEN 0 ELSE 1 END AS clear_dt                          FROM    ishomedb.tz_lms_plan_module pln                          INNER   JOIN ishomedb.tz_lms_module modu                          ON      pln.module_no = modu.module_no 				         LEFT    OUTER JOIN ishomedb.tz_lms_act_module act 				         ON      pln.student_no = act.student_no 				         AND     pln.plan_de = act.plan_de 				         AND     pln.module_no = act.module_no 				         INNER   JOIN ishomedb.tz_lcms_study_lesson les                          ON      modu.subj_lesson_no = les.subj_lesson_no                          AND     les.use_yn = 'Y'           /* 2013-10-04 JHSUN 추가 */ 				         INNER   JOIN ishomedb.tz_lms_course cou 				         ON      modu.course_no = cou.course_no 				         INNER   JOIN ishomedb.tz_lcms_subj sbj 				         ON      cou.subj_no = sbj.subj_no                         /* AND     sbj.use_yn = 'Y'         2013-10-04 JHSUN 주석처리 */                           				         WHERE   pln.student_no = '156886' 				         AND     pln.plan_de >= '2015.05.01' 				         AND     pln.plan_de <= '2015.05.31') act                  GROUP   BY act.grade_gbn, act.subj_gbn) act                  ORDER BY act.grade_gbn, act.subj_gbn; "
2015-05-01 02:30:57,ishome[ishome],192.168.150.41,183.194728,0.000410,1,2605,"SELECT  b.user_id                ,b.nm_kor                ,b.login_id                ,b.jumin_no1                ,b.jumin_no2                ,b.birth_de                ,CASE WHEN b.elementary_yn = 'Y' THEN '초등학생'                 ELSE '초등학생아님' END AS elementary_yn                ,b.gender                                ,( case when b.calendar_gbn = 'S' then '양력' else '음력' end ) as calendar_gbn                ,(select schoolname from ishomedb.tz_school where school_no = b.school_no) as schoolname                ,CONCAT(b.tel1, '-', b.tel2, '-', b.tel3) AS tel                ,b.tel1                ,b.tel2                ,b.tel3                ,CONCAT(b.mobile1, '-', b.mobile2, '-', b.mobile3) AS mobile                ,b.mobile1                ,b.mobile2                ,b.mobile3                ,b.sms_yn                ,b.email                ,b.zipcode                ,b.addr1                ,b.addr2                ,b.blacklist_yn                ,a.group_no                ,a.grade_gbn                ,a.device_no                ,a.student_no                ,a.student_id                ,a.teacher_id                ,a.start_de                ,a.end_de                ,b.parent_id                ,(SELECT SUM(point) FROM tz_point_history WHERE student_no = a.student_no) as point                ,b.start_sms_yn                ,b.end_sms_yn                ,b.search_yn                ,IFNULL(b.movie_limit_yn, 'N') as movie_limit_yn                ,IFNULL(b.movie_global_limit_yn, 'N') as movie_global_limit_yn                ,lpad(c.recom_id,4,'0') as recom_id                ,c.recom_teacher_nm           FROM  ishomedb.tz_student a            LEFT OUTER JOIN tz_member b ON a.student_id = b.user_id           LEFT OUTER JOIN (SELECT tzt.recom_id as recom_id,                  tzm.nm_kor AS recom_teacher_nm                 FROM tz_teacher tzt                 LEFT JOIN tz_member tzm ON tzt.teacher_id = tzm.user_id) c ON b.recom_teacher = c.recom_id           where  a.student_no = '248206'; "
2015-05-01 02:30:57,ishome[ishome],192.168.150.80,300.593120,0.000065,32,249,"SELECT  s.student_no     /* 학생 번호 */                ,s.student_id     /* 학생ID */                ,concat(m.nm_kor, '(', s.student_id, ')') AS user         FROM   ishomedb.tz_student s         LEFT OUTER JOIN ishomedb.tz_member m         ON     s.student_id = m.user_id         WHERE  teacher_id  = 304654         AND    group_no = 6084; "
2015-05-01 02:30:57,ishome[ishome],192.168.150.80,257.566353,0.000146,15,60,"SELECT   subj_gbn                 ,ishomedb.uf_code_subj_nm(subj_gbn) AS subj_nm                 ,CASE WHEN subj_gbn = 10004 THEN 11000                        WHEN subj_gbn = 10017 THEN 10001                       ELSE subj_gbn                   END AS subj_sort         FROM    ishomedb.tz_lcms_subj         WHERE   school_study_yn = 'C'                       AND grade_gbn = '5'                                 AND semester_gbn = '1'                       /* AND use_yn = 'Y' 2월말까지 임시 제거 */         GROUP   BY subj_gbn         ORDER   BY sort, subj_gbn ASC; "
2015-05-01 02:30:57,ishome[ishome],192.168.150.80,255.218968,0.001680,1,1,"SELECT student_no               ,student_id               ,parent_id               ,teacher_id               ,group_nm               ,grade_gbn               ,gender                              ,user_id               ,login_id               ,p_login_id               ,p_nm_kor               ,nm_kor               ,tel               ,mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,pur_start_de               ,pur_end_de               ,product_no               ,last_dt               ,student_consult_dt               ,student_consult_gbn               ,student_consult_content               ,parent_consult_dt               ,parent_consult_gbn               ,parent_consult_content               ,product_nm               ,status               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status                   ,              (SELECT stat_day19 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day20 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day21 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day22 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day23 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day24 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day6         ,              (SELECT stat_day25 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day7         ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day8         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day9         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day10         ,              (SELECT stat_day29 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day11         ,              (SELECT stat_day30 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day12         ,              (SELECT stat_day1 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day13         ,              '-'                       as stat_day14                       FROM (               SELECT a.student_no                   ,a.student_id                   ,c.parent_id                   ,a.teacher_id                   ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm                   ,a.grade_gbn                   ,CASE WHEN c.gender = 'M' THEN '남'                         WHEN c.gender = 'F' THEN '여'                         ELSE '-'                   END AS gender                                  ,c.user_id                   ,c.login_id                   ,p.login_id AS p_login_id                   ,p.nm_kor AS p_nm_kor                   ,c.nm_kor                   ,CONCAT(c.tel1,'-',c.tel2,'-',c.tel3) AS tel                   ,CONCAT(c.mobile1,'-',c.mobile2,'-',c.mobile3) AS mobile                   ,c.blacklist_yn                   ,IFNULL(a.manage_start_de,'9999.99.99') as manage_start_de                   ,DATE_FORMAT(a.start_de, '%Y.%m.%d') AS start_de                   ,DATE_FORMAT(a.end_de, '%Y.%m.%d') AS end_de                   ,DATE_FORMAT(pur.start_de, '%Y.%m.%d') AS pur_start_de                   ,DATE_FORMAT(pur.end_de, '%Y.%m.%d') AS pur_end_de                   ,pur.product_no                   ,(SELECT MAX(login_dt)   FROM ishomedb.tz_connect_log WHERE user_id = a.student_id) AS last_dt                   ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=c.user_id                      AND content IS NOT NULL) AS student_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=c.user_id                      AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=c.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_content                         ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=p.user_id                       AND content IS NOT NULL) AS parent_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=p.user_id                     AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=p.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_content                   ,ishomedb.uf_study_product_nm(a.student_no) as product_nm                   ,CASE WHEN c.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보 */                         'Android'                         WHEN COALESCE(s.user_id, -1) > 0 THEN 'ON'                          ELSE 'OFF'                     END AS status                                      ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                   ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                   ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                   ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                   ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                   ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                   ,tee.app_reason             FROM ishomedb.tz_student a                             	            INNER JOIN ishomedb.tz_purchase_student pch 	            ON a.student_no = pch.temp_student_no 	            INNER JOIN ishomedb.tz_purchase pur 	            ON pch.purchase_no = pur.purchase_no 	            INNER JOIN tz_product pd 	            ON pur.product_no = pd.product_no 	                                        AND pd.service_com_yn = 'Y'                               INNER JOIN ishomedb.tz_member c             ON a.student_id = c.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = c.parent_id             INNER JOIN ishomedb.tz_teacher d             ON a.teacher_id = d.teacher_id             LEFT OUTER JOIN ishomedb.tz_connect_session s             ON a.student_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = a.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de             LEFT OUTER JOIN ishomedb.tz_experience tee              ON tee.purchase_no = pur.purchase_no and tee.parent_id = pur.purchase_no and tee.student_id = pur.student_id                            WHERE               c.search_yn = 'Y'             AND a.teacher_id = 555386             AND IFNULL(c.user_gbn_cls, '10001') != '10002'                                	             	              	                AND ( 	                    a.end_de is not null 	                    AND 	                    date_format(a.end_de, '%Y%m%d')   >=   date_format(NOW(), '%Y%m%d') 	                )  	                  	                                                                                                                AND c.nm_kor   LIKE CONCAT('김시우', '%')                                                                                                                                                                                                                                                   GROUP BY a.student_no         ) A           ORDER BY manage_start_de DESC; "
2015-05-01 02:30:57,ishome[ishome],192.168.150.80,289.991003,0.000272,1,23132,"SELECT COUNT(t1.f_ischeckpoint) as totalCnt  		FROM edubasestudydb.t_student_test t1  		WHERE t1.f_test_id IN ( 		    SELECT tst.f_test_id 		    FROM ishomedb.tz_lms_module modu 		    INNER JOIN ishomedb.tz_lcms_study_lesson les  		    ON modu.subj_lesson_no = les.subj_lesson_no 		    LEFT OUTER JOIN ishomedb.tz_lms_module lm  		    ON lm.subj_lesson_no = les.subj_lesson_no 		    AND lm.module_no = modu.module_no AND lm.useq = modu.useq AND lm.head_gbn != '10001' 		    LEFT OUTER JOIN ishomedb.tz_lcms_prepare_test ppe  		    ON ppe.subj_lesson_no = les.subj_lesson_no AND ppe.useq = lm.useq AND ppe.test_url_gbn = '10001' 		    LEFT OUTER JOIN edubasestudydb.t_test tst 		    ON tst.f_chapter_cd = les.subj_lesson_no AND tst.f_no = ppe.useq 		    AND tst.f_kind_cd IN ('T110', 'T120', 'T130', 'T135') AND tst.f_isopen = 'Y' 		    WHERE modu.upper_no IN (81739,81740,81741,81742,81743,81744,81745,81746,81747,81748,81749,81750,81751,81752,81753,81754,81755,81756,81757,81758,81759,81760,81761,81762,81763,81764,81765,81766,81767,81768,81769) 		) AND f_ischeckpoint = 'Y' 		AND f_user_cd = '148100'; "
2015-05-01 02:30:58,ishome[ishome],192.168.150.80,248.461802,0.001661,112,133866,"SELECT student_no               ,student_id               ,parent_id               ,teacher_id               ,group_nm               ,grade_gbn               ,gender                              ,user_id               ,login_id               ,p_login_id               ,p_nm_kor               ,nm_kor               ,tel               ,mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,pur_start_de               ,pur_end_de               ,product_no               ,last_dt               ,student_consult_dt               ,student_consult_gbn               ,student_consult_content               ,parent_consult_dt               ,parent_consult_gbn               ,parent_consult_content               ,product_nm               ,status               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status                   ,              (SELECT stat_day19 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day20 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day21 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day22 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day23 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day24 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day6         ,              (SELECT stat_day25 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day7         ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day8         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day9         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day10         ,              (SELECT stat_day29 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day11         ,              (SELECT stat_day30 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day12         ,              (SELECT stat_day1 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day13         ,              '-'                       as stat_day14                       FROM (               SELECT a.student_no                   ,a.student_id                   ,c.parent_id                   ,a.teacher_id                   ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm                   ,a.grade_gbn                   ,CASE WHEN c.gender = 'M' THEN '남'                         WHEN c.gender = 'F' THEN '여'                         ELSE '-'                   END AS gender                                  ,c.user_id                   ,c.login_id                   ,p.login_id AS p_login_id                   ,p.nm_kor AS p_nm_kor                   ,c.nm_kor                   ,CONCAT(c.tel1,'-',c.tel2,'-',c.tel3) AS tel                   ,CONCAT(c.mobile1,'-',c.mobile2,'-',c.mobile3) AS mobile                   ,c.blacklist_yn                   ,IFNULL(a.manage_start_de,'9999.99.99') as manage_start_de                   ,DATE_FORMAT(a.start_de, '%Y.%m.%d') AS start_de                   ,DATE_FORMAT(a.end_de, '%Y.%m.%d') AS end_de                   ,DATE_FORMAT(pur.start_de, '%Y.%m.%d') AS pur_start_de                   ,DATE_FORMAT(pur.end_de, '%Y.%m.%d') AS pur_end_de                   ,pur.product_no                   ,(SELECT MAX(login_dt)   FROM ishomedb.tz_connect_log WHERE user_id = a.student_id) AS last_dt                   ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=c.user_id                      AND content IS NOT NULL) AS student_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=c.user_id                      AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=c.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_content                         ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=p.user_id                       AND content IS NOT NULL) AS parent_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=p.user_id                     AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=p.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_content                   ,ishomedb.uf_study_product_nm(a.student_no) as product_nm                   ,CASE WHEN c.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보 */                         'Android'                         WHEN COALESCE(s.user_id, -1) > 0 THEN 'ON'                          ELSE 'OFF'                     END AS status                                      ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                   ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                   ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                   ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                   ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                   ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                   ,tee.app_reason             FROM ishomedb.tz_student a                             	            INNER JOIN ishomedb.tz_purchase_student pch 	            ON a.student_no = pch.temp_student_no 	            INNER JOIN ishomedb.tz_purchase pur 	            ON pch.purchase_no = pur.purchase_no 	            INNER JOIN tz_product pd 	            ON pur.product_no = pd.product_no 	                                        AND pd.service_com_yn = 'Y'                               INNER JOIN ishomedb.tz_member c             ON a.student_id = c.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = c.parent_id             INNER JOIN ishomedb.tz_teacher d             ON a.teacher_id = d.teacher_id             LEFT OUTER JOIN ishomedb.tz_connect_session s             ON a.student_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = a.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de             LEFT OUTER JOIN ishomedb.tz_experience tee              ON tee.purchase_no = pur.purchase_no and tee.parent_id = pur.purchase_no and tee.student_id = pur.student_id                            WHERE               c.search_yn = 'Y'             AND a.teacher_id = 555386             AND IFNULL(c.user_gbn_cls, '10001') != '10002'                                	             	              	                AND ( 	                    a.end_de is not null 	                    AND 	                    date_format(a.end_de, '%Y%m%d')   >=   date_format(NOW(), '%Y%m%d') 	                )  	                  	                                                                                                                                                                                                                                              GROUP BY a.student_no         ) A           ORDER BY manage_start_de DESC; "
2015-05-01 02:37:51,ishome[ishome],192.168.150.41,204.882844,0.000290,1,1,"SELECT IF(tch.teacher_id != '', 'Y', 'N') AS teacher_yn,    /* 선생님 여부 */                tch.teacher_id,                                      /* 선생님 아이디 */                tm.nm_kor,                                           /* 선생님 성명 */                               tc.corp_no,                                          /* 제휴사 코드 */                tc.corp_nm,                                          /* 제휴사 명*/                tc.leader_id AS corp_leader_id,                      /* 제휴사 관리자 아이디 */                tt.team_no,                                          /* 팀 코드 */                tt.team_nm,                                          /* 팀 명 */                tt.leader_id AS team_leader_id,                      /* 팀 관리자 아이디 */                tp.part_no,                                          /* 파트 코드 */                tp.part_nm,                                          /* 파트 명 */                tp.leader_id AS part_leader_id                       /* 파트 관리자 아이디 */           FROM ishomedb.tz_member tm                LEFT OUTER JOIN ishomedb.tz_teacher tch                   ON tch.teacher_id = tm.user_id AND tch.active_yn = 'Y'                LEFT OUTER JOIN ishomedb.tz_teacher_team_part tp                   ON tp.part_no = tch.part_no AND tp.use_yn = 'Y'                LEFT OUTER JOIN ishomedb.tz_teacher_team tt                   ON tt.team_no = tp.team_no AND tt.use_yn = 'Y'                LEFT OUTER JOIN ishomedb.tz_teacher_corp tc                   ON tc.corp_no = tt.corp_no AND tt.use_yn = 'Y'          WHERE tm.user_id = '392415'; "
2015-05-01 02:37:51,ishome[ishome],192.168.150.41,195.509708,0.001488,10,1065,"SELECT paid.split_paid_no               ,CASE WHEN paid.reg_gbn = 'homepage' THEN 'ⓗ' ELSE '' END AS reg_gbn_nm               ,pur.purchase_no               ,pb.nm_kor AS paid_nm_kor               ,p_mem.user_id AS parent_id               ,s_mem.user_id AS student_id               ,mng_std.student_no               ,CONCAT(p_mem.nm_kor, '<br />(' ,p_mem.login_id,')') AS p_mem_info /* 학부모정보 */               ,CONCAT(s_mem.nm_kor, '<br />(' ,s_mem.login_id,')') AS s_mem_info /* 학습자정보 */               ,prd.product_no /* 상품명 */               ,prd.product_nm /* 상품명 */               ,CASE WHEN paid.reg_gbn = 'homepage' THEN '오프라인'    /* 2013-06-17 JHSUN 홈페이지->오프라인으로 변경 */                     WHEN paid.reg_gbn = 'online' THEN '온라인'                     ELSE '오프라인'                END AS paid_gubun               ,paid.batch_key /* 결제식별키 */               ,paid.paid_day /* 청구일 */               ,DATE_FORMAT(paid.reg_dt, '%Y-%m-%d') AS app_reg_dt               ,DATE_FORMAT(MIN(auth_ymd),'%Y-%m-%d') AS first_batch_dt /* 최초결제일 */               ,DATE_FORMAT(MAX(pb.auth_ymd),'%Y-%m-%d') AS last_batch_dt /* 최근승인일 */               ,SUM(IF(pb.progress = 'Y', 1, 0)) AS succ_cnt               ,paid.split_month               ,pb.error_cnt + 1 AS paid_request_cnt /* 승인시도횟수 */               ,pb.result_msg AS last_paid_status /* 최근승인요청결과 */               ,purchase_code.code_nm AS status_gbn /* 구매상태 */               ,CASE WHEN paid.del_yn = 'Y' Then '삭제'                     ELSE code.code_nm                END AS code_nm               ,upd_mem.nm_kor AS upd_nm_kor /* 담당선생님 */               ,CONCAT(manage_mem.nm_kor,  '<br />(' , manage_mem.login_id, ')') AS manage_info               ,manage_dt               ,pb.result_code                ,CASE WHEN pur_ref.device_return_gbn = 'Y' THEN '기기반납'                     WHEN pur_ref.device_return_gbn = 'N' THEN '기기양도'                     WHEN pur_ref.device_return_gbn = 'U' THEN '해당없음'                END AS device_return_gbn_nm               ,h.code_nm AS purchase_device_gbn /* 구매단말기구분 */               ,tdm.model_gbn as model_gbn /* 기기구분 */               ,uf_code_nm(10230,tdm.model_gbn) as model_gbn_nm /* 기기구분명 */               ,ishomedb.uf_purchase_side_delivery_info(pur.purchase_no) as side_info               , prd.service_reuse_yn         FROM ishomedb.tz_split_paid paid          LEFT OUTER JOIN ishomedb.tz_purchase pur          ON paid.purchase_no = pur.purchase_no         LEFT OUTER JOIN ishomedb.tz_purchase_batch pb         ON paid.split_paid_no = pb.split_paid_no         /* 신청자정보 */         LEFT JOIN ishomedb.tz_member p_mem         ON paid.parent_id = p_mem.user_id         /* 학습자정보 */         LEFT JOIN ishomedb.tz_member s_mem         ON paid.student_id = s_mem.user_id         /* 담당자 - 담당선생  */         LEFT JOIN ishomedb.tz_student mng_std         ON paid.student_id = mng_std.student_id         LEFT JOIN ishomedb.tz_member upd_mem         ON mng_std.teacher_id = upd_mem.user_id         /* 상품정보 */         LEFT JOIN ishomedb.tz_product prd         ON prd.product_no = paid.product_no         /* 출하상태  10118 */         LEFT JOIN ishomedb.tz_code purchase_code         ON pur.status_gbn = purchase_code.code_no         AND purchase_code.code_gbn = 10118         /* 월결제상태  10177 */         LEFT JOIN ishomedb.tz_code code         ON paid.paid_status = code.code_no         AND code.code_gbn = 10177         LEFT OUTER JOIN ishomedb.tz_teacher tec         ON tec.teacher_id = upd_mem.user_id         LEFT OUTER JOIN ishomedb.tz_teacher_team_part ttp         ON ttp.part_no = tec.part_no         /* 담당자 정보 */         LEFT JOIN ishomedb.tz_member manage_mem         ON paid.manage_id = manage_mem.user_id         /* 단말기 반납여부 */         LEFT JOIN ishomedb.tz_purchase_refund pur_ref         ON paid.purchase_no = pur_ref.purchase_no         /* 구매단말기구분  10218 */         LEFT OUTER JOIN ishomedb.tz_code h          ON h.code_no = pur.purchase_device_gbn AND h.use_yn = 'Y' AND h.code_gbn = 10218         /* 단말기 정보 */         LEFT OUTER JOIN ishomedb.tz_device i         ON pur.purchase_no = i.purchase_no         AND i.status_gbn IN (10002, 10005, 10007)         /* 모델구분 */         LEFT OUTER JOIN ishomedb.tz_device_model tdm         ON i.model_code = tdm.model_code                                                  GROUP BY paid.split_paid_no         ORDER BY paid.split_paid_no DESC         LIMIT 0, 10; "
2015-05-01 02:52:54,ishome[ishome],192.168.150.80,291.960489,0.000101,1,15,"SELECT   subj_no, COUNT(1)         FROM    ishomedb.tz_lcms_subj         WHERE   school_study_yn = 'C'             AND subj_gbn = '10028'             AND grade_gbn = '5'             AND semester_gbn = '1'; "
2015-05-02 02:31:17,ishome[ishome],192.168.150.80,157.479418,0.000380,91,703,"SELECT ms.nm_kor 		      ,ms.user_id 		      ,ms.join_de 		      ,ms.blacklist_yn 		      ,s.group_no 		      ,s.student_no 		      ,s.student_id           /* 2013-07-12 JHSUN 메일보내기 문제로 student_id 추가 */ 		      ,s.teacher_id 		      ,s.grade_gbn 		      ,s.start_de 		      ,s.end_de 		      ,e.is_info /*체험단 인지 정보*/ 		      ,e.app_reason /*체험단 신청 사유*/ 		      ,(CASE WHEN ms.sms_yn = 'Y' THEN '허용' ELSE '거부' END) AS sms_yn_nm 		      ,mp.user_id AS parent_id 		      ,mp.login_id AS login_id 		      ,mp.nm_kor AS parent_nm_kor 		      ,CONCAT(mp.mobile1, '-', mp.mobile2, '-', mp.mobile3) AS tel 		      ,CONCAT(DATE_FORMAT(s.start_de, '%Y.%m.%d'), "~", DATE_FORMAT(s.end_de, '%Y.%m.%d')) AS use_de 		      ,(CASE WHEN ms.gender = 'M' THEN '남자' WHEN ms.gender = 'F' THEN '여자' ELSE '' END) AS gender 		      ,p.status_gbn 		      ,pd.product_nm 		      ,IFNULL(gcm.gcm_status, 'N') AS gcm_status /* 학부모앱 설치 유무 */                     		FROM ishomedb.tz_member mp 		INNER JOIN ishomedb.tz_member ms 		ON mp.user_id = ms.parent_id 		INNER JOIN ishomedb.tz_student s 		ON ms.user_id = s.student_id 		AND s.teacher_id = 555571 		INNER JOIN ishomedb.tz_purchase_student ps 		ON s.student_no = ps.temp_student_no 		INNER JOIN ishomedb.tz_purchase p 		ON ps.purchase_no = p.purchase_no 		AND p.status_gbn != 10010 		INNER JOIN ishomedb.tz_product pd 		ON p.product_no = pd.product_no 		LEFT JOIN ishomedb.tz_experience e 		ON mp.user_id = e.parent_id 		 		LEFT OUTER JOIN ishomedb.tz_android_gcm_parent gcm /* 2013.07.24 학부모앱 정보 이영무 */ 		ON mp.user_id = gcm.user_id 		                    WHERE  IFNULL(s.end_de, NOW()) >= DATE_FORMAT(NOW(), '%Y-%m-%d')                                                                              ORDER BY s.student_no DESC; "
2015-05-02 02:31:17,ishome[ishome],192.168.150.80,151.621957,0.000115,1,3497,"SELECT  COUNT(consult_no) as total_count             , IFNULL(SUM(CASE WHEN upd_dt IS NOT NULL THEN 1 END), 0) as complete_count             , IFNULL(SUM(CASE WHEN upd_dt IS NULL THEN 1 END), 0) as imperfect_count         FROM   ishomedb.tz_lms_consult         WHERE  consult_dt   >=   STR_TO_DATE('2015-05-01','%Y-%m-%d')         AND    consult_dt   <   date_add(STR_TO_DATE('2015-05-01','%Y-%m-%d'), interval +1 day)         AND    teacher_id = 555571; "
2015-05-02 02:31:17,ishome[ishome],192.168.150.80,169.625455,0.000361,22,3179,"SELECT  l.consult_no     /* 상담 번호 */                ,l.teacher_id     /* 교사ID */                ,l.student_no     /* 학생ID */                ,l.consult_dt     /* 상담일시 */                ,l.target_id      /* 상담대상ID */                ,l.tel_gbn        /* 연락처 구분 */                ,l.tel_no         /* 연락 전화번호 */                ,l.consult_gbn    /* 상담 구분 (공통코드 : 10130) */                ,CASE  WHEN l.consult_mat='10211' THEN                     '첫상담'                WHEN l.consult_mat='10212' THEN                     '학습상담'                WHEN l.consult_mat='10213' THEN                     '구매상담'                WHEN l.consult_mat='10214' THEN                     '첫상담'                   WHEN l.consult_mat='10215' THEN                     '학습상담'                WHEN l.consult_mat='10216' THEN                     '결제상담'                END AS consult_mat                ,l.consult_detail                ,l.repetition_no                ,l.upd_dt                ,c.code_nm                ,s.student_id                ,s.grade_gbn                ,s.group_no                ,g.group_nm                ,m.nm_kor                ,m.login_id                ,m.user_id                ,CASE WHEN m.user_gbn_cls = '10004' THEN                        'Android'                      WHEN COALESCE((SELECT DISTINCT user_id FROM ishomedb.tz_connect_session WHERE user_id = m.user_id), -1) > 0 THEN 'ON'                      ELSE 'OFF'                 END AS status          FROM   ishomedb.tz_lms_consult l         LEFT OUTER JOIN tz_student s         ON     l.student_no = s.student_no         LEFT OUTER JOIN ishomedb.tz_connect_session sc         ON l.target_id = sc.user_id          LEFT OUTER JOIN tz_student_group g         ON     s.group_no = g.group_no         LEFT OUTER JOIN tz_member m         ON     s.student_id = m.user_id         LEFT OUTER JOIN tz_code c         ON     l.consult_gbn = c.code_no         AND    c.code_gbn = 10130         WHERE  l.consult_dt   >=   '2015-05-26'         AND    l.consult_dt   <   date_add('2015-05-26', interval +1 day)         AND    l.teacher_id = 555571                                    ORDER BY l.consult_dt DESC; "
2015-05-02 02:31:18,ishome[ishome],192.168.150.80,151.046318,0.001751,91,83147,"SELECT student_no               ,student_id               ,parent_id               ,teacher_id               ,group_nm               ,grade_gbn               ,gender                              ,user_id               ,login_id               ,p_login_id               ,p_nm_kor               ,nm_kor               ,tel               ,mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,pur_start_de               ,pur_end_de               ,product_no               ,last_dt               ,student_consult_dt               ,student_consult_gbn               ,student_consult_content               ,parent_consult_dt               ,parent_consult_gbn               ,parent_consult_content               ,product_nm               ,status               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status                   ,              (SELECT stat_day19 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day20 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day21 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day22 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day23 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day24 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day6         ,              (SELECT stat_day25 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day7         ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day8         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day9         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day10         ,              (SELECT stat_day29 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day11         ,              (SELECT stat_day30 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day12         ,              (SELECT stat_day1 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day13         ,              (SELECT stat_day2 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day14                       FROM (               SELECT a.student_no                   ,a.student_id                   ,c.parent_id                   ,a.teacher_id                   ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm                   ,a.grade_gbn                   ,CASE WHEN c.gender = 'M' THEN '남'                         WHEN c.gender = 'F' THEN '여'                         ELSE '-'                   END AS gender                                  ,c.user_id                   ,c.login_id                   ,p.login_id AS p_login_id                   ,p.nm_kor AS p_nm_kor                   ,c.nm_kor                   ,CONCAT(c.tel1,'-',c.tel2,'-',c.tel3) AS tel                   ,CONCAT(c.mobile1,'-',c.mobile2,'-',c.mobile3) AS mobile                   ,c.blacklist_yn                   ,IFNULL(a.manage_start_de,'9999.99.99') as manage_start_de                   ,DATE_FORMAT(a.start_de, '%Y.%m.%d') AS start_de                   ,DATE_FORMAT(a.end_de, '%Y.%m.%d') AS end_de                   ,DATE_FORMAT(pur.start_de, '%Y.%m.%d') AS pur_start_de                   ,DATE_FORMAT(pur.end_de, '%Y.%m.%d') AS pur_end_de                   ,pur.product_no                   ,(SELECT MAX(login_dt)   FROM ishomedb.tz_connect_log WHERE user_id = a.student_id) AS last_dt                   ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=c.user_id                      AND content IS NOT NULL) AS student_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=c.user_id                      AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=c.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_content                         ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=p.user_id                       AND content IS NOT NULL) AS parent_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=p.user_id                     AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=p.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_content                   ,ishomedb.uf_study_product_nm(a.student_no) as product_nm                   ,CASE WHEN c.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보 */                         'Android'                         WHEN COALESCE(s.user_id, -1) > 0 THEN 'ON'                          ELSE 'OFF'                     END AS status                                      ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                   ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                   ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                   ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                   ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                   ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                   ,tee.app_reason             FROM ishomedb.tz_student a                             	            INNER JOIN ishomedb.tz_purchase_student pch 	            ON a.student_no = pch.temp_student_no 	            INNER JOIN ishomedb.tz_purchase pur 	            ON pch.purchase_no = pur.purchase_no 	            INNER JOIN tz_product pd 	            ON pur.product_no = pd.product_no 	                                        AND pd.service_com_yn = 'Y'                               INNER JOIN ishomedb.tz_member c             ON a.student_id = c.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = c.parent_id             INNER JOIN ishomedb.tz_teacher d             ON a.teacher_id = d.teacher_id             LEFT OUTER JOIN ishomedb.tz_connect_session s             ON a.student_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = a.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de             LEFT OUTER JOIN ishomedb.tz_experience tee              ON tee.purchase_no = pur.purchase_no and tee.parent_id = pur.purchase_no and tee.student_id = pur.student_id                            WHERE               c.search_yn = 'Y'             AND a.teacher_id = 555571             AND IFNULL(c.user_gbn_cls, '10001') != '10002'                                	             	              	                AND ( 	                    a.end_de is not null 	                    AND 	                    date_format(a.end_de, '%Y%m%d')   >=   date_format(NOW(), '%Y%m%d') 	                )  	                  	                                                                                                                                                                                                                                              GROUP BY a.student_no         ) A           ORDER BY manage_start_de DESC; "
2015-05-02 02:38:05,ishome[ishome],192.168.150.41,63.921223,0.000618,1,996,"SELECT                  qna_group.student_no                 ,qna_group.group_no                 ,prt.nm_kor AS parent_nm                 ,prt.login_id AS parent_login_id                 ,child.nm_kor AS child_nm                 ,child.login_id AS child_login_id                 ,(select nm_kor from ishomedb.tz_member mem where mem.user_id = stu.teacher_id) AS teacher_nm                 ,IFNULL(grp.group_nm, '미지정') AS group_nm                 ,ishomedb.uf_code_grade_nm(stu.grade_gbn) AS grade_gbn                 ,(                      SELECT qna_type                     FROM ishomedb.tz_child_qna_new                     WHERE student_no = qna_group.student_no                          AND group_no = qna_group.group_no                         AND qna_gbn = 'Q'                     ORDER BY qna_no DESC LIMIT 1                  ) AS qna_type                 ,(                      SELECT                     CASE WHEN qna_type = 'T' THEN                         IF(CHAR_LENGTH(qna_content) > 30, CONCAT(LEFT(qna_content, 30), '...'), qna_content)                     ELSE                         qna_content                     END AS qna_content                     FROM ishomedb.tz_child_qna_new                     WHERE student_no = qna_group.student_no                          AND group_no = qna_group.group_no                         AND qna_gbn = 'Q'                     ORDER BY qna_no DESC LIMIT 1                  ) AS question_content                 ,(                     SELECT count(qna_no)                     FROM ishomedb.tz_child_qna_new                      WHERE student_no = qna_group.student_no                          AND group_no = qna_group.group_no                         AND qna_gbn = 'Q'                 ) AS question_count                 ,CONCAT(qna_group.question_date, ' ', qna_group.question_time) AS question_dt                 ,IF(qna_group.answer_yn = 'Y', '답변완료', '답변대기') AS complete_gbn                 ,IF(qna_group.answer_date is null, '', CONCAT(qna_group.answer_date, ' ', qna_group.answer_time)) AS answer_dt                 ,(select nm_kor from ishomedb.tz_member mem where mem.user_id = qna_group.answer_id) AS answer_nm                 ,stu.student_id         FROM ishomedb.tz_child_qna_group AS qna_group                  INNER JOIN ishomedb.tz_student stu /* 학생 */                 ON stu.student_no = qna_group.student_no                          INNER JOIN ishomedb.tz_member child /* 자녀 */                 ON child.user_id = stu.student_id                          INNER JOIN ishomedb.tz_member prt /* 부모 */                 ON prt.user_id = child.parent_id          LEFT OUTER JOIN ishomedb.tz_student_group grp /* 자녀그룹 */                 ON stu.group_no = grp.group_no                                                                          		 WHERE  qna_group.del_yn = 'N' AND qna_group.is_last = 'Y' 		     			 			 			  			     AND qna_group.answer_yn = 'N' 			  			  			  			         AND stu.teacher_id = '555507'                         ORDER   BY                                        qna_group.question_date DESC, qna_group.question_time DESC                     LIMIT  0, 25; "
2015-05-02 02:53:00,ishome[ishome],192.168.150.41,270.039849,0.000419,98,175819,"SELECT   modu.module_no AS code                 ,modu.course_no                 ,modu.schedule_plan_de                 ,modu.sort                 ,sub.module_no AS sub_no                  ,sub.subj_lesson_no                 ,sub.head_gbn                 ,(SELECT code_nm FROM ishomedb.tz_code WHERE code_gbn = 10129 AND code_no = sub.head_gbn) AS head_gbn_nm                 ,sub.contents_table                 ,sub.upper_no                 ,sub.sort AS sub_sort                 ,CONCAT('[', (SELECT code_nm FROM ishomedb.tz_code WHERE code_gbn = 10129 AND code_no = sub.head_gbn), ']',                      CASE                     	WHEN les.lesson_gbn = 10001 AND sbj.subj_gbn = '10023' AND sub.useq = 1 THEN CONCAT(les.sort, '. ', les.subj_lesson_nm, ' (단원중급)')   						WHEN les.lesson_gbn = 10001 AND sbj.subj_gbn = '10023' AND sub.useq = 2 THEN CONCAT(les.sort, '. ', les.subj_lesson_nm, ' (단원상급)')  						WHEN les.lesson_gbn = 10001 AND sbj.subj_gbn = '10023' AND sub.useq = 3 THEN CONCAT(les.sort, '. ', les.subj_lesson_nm, ' (단원기본)')                       	WHEN les.lesson_gbn = 10001 THEN CONCAT(les.sort, '. ', les.subj_lesson_nm, ' (', sub.useq, '회차)') ELSE                         CASE WHEN (les.lesson_gbn = 10002 OR les.lesson_gbn = 10003) THEN CONCAT(les.subj_lesson_nm, ' (', sub.useq, '회차)') ELSE                         CONCAT(CASE                                 WHEN les.subj_no = 174 OR les.subj_no = 175 THEN CONCAT(les.chapter_key, '장. ')                                 ELSE CASE                                     WHEN                                         les.use_chapter_key = 'Y'                                             AND les.contents_xml_type >= 'C'                                             AND (les.contents_xml_type != 'O'                                             AND les.contents_xml_type != 'N')                                     THEN                                         CONCAT(les.chapter_key, '장. ')                                     WHEN                                         les.use_chapter_key = 'N'                                             AND les.contents_xml_type >= 'C'                                             AND (les.contents_xml_type != 'O'                                             AND les.contents_xml_type != 'N')                                     THEN                                         CONCAT(les1.sort, '단원. ')                                     ELSE CONCAT(les.sort, '장. ')                                 END                             END,                             les.subj_lesson_nm) END END) AS label         FROM    ishomedb.tz_lms_module modu         INNER   JOIN ishomedb.tz_lms_module sub         ON      modu.module_no = sub.upper_no         INNER   JOIN ishomedb.tz_lcms_study_lesson les         ON      sub.subj_lesson_no = les.subj_lesson_no         LEFT OUTER JOIN	ishomedb.tz_lcms_study_lesson les1          ON les.upper_no = les1.subj_lesson_no         LEFT OUTER JOIN ishomedb.tz_lcms_subj sbj          ON les.subj_no = sbj.subj_no         /* AND les.use_yn = 'Y' */         WHERE   modu.course_no = 1628         ORDER   BY sort ASC, code ASC, sub_sort ASC, sub_no ASC; "
2015-05-03 23:00:00,ishome[ishome],192.168.150.41,11.673571,0.000667,10,10595830,"SELECT paid.split_paid_no               ,CASE WHEN paid.reg_gbn = 'homepage' THEN 'ⓗ' ELSE '' END AS reg_gbn_nm               ,pur.purchase_no               ,pb.nm_kor AS paid_nm_kor               ,p_mem.user_id AS parent_id               ,s_mem.user_id AS student_id               ,mng_std.student_no               ,CONCAT(p_mem.nm_kor, '<br />(' ,p_mem.login_id,')') AS p_mem_info /* 학부모정보 */               ,CONCAT(s_mem.nm_kor, '<br />(' ,s_mem.login_id,')') AS s_mem_info /* 학습자정보 */               ,prd.product_no /* 상품명 */               ,prd.product_nm /* 상품명 */               ,CASE WHEN paid.reg_gbn = 'homepage' THEN '오프라인'    /* 2013-06-17 JHSUN 홈페이지->오프라인으로 변경 */                     WHEN paid.reg_gbn = 'online' THEN '온라인'                     ELSE '오프라인'                END AS paid_gubun               ,paid.batch_key /* 결제식별키 */               ,paid.paid_day /* 청구일 */               ,DATE_FORMAT(paid.reg_dt, '%Y-%m-%d') AS app_reg_dt               ,DATE_FORMAT(MIN(auth_ymd),'%Y-%m-%d') AS first_batch_dt /* 최초결제일 */               ,DATE_FORMAT(MAX(pb.auth_ymd),'%Y-%m-%d') AS last_batch_dt /* 최근승인일 */               ,SUM(IF(pb.progress = 'Y', 1, 0)) AS succ_cnt               ,paid.split_month               ,pb.error_cnt + 1 AS paid_request_cnt /* 승인시도횟수 */               ,pb.result_msg AS last_paid_status /* 최근승인요청결과 */               ,purchase_code.code_nm AS status_gbn /* 구매상태 */               ,CASE WHEN paid.del_yn = 'Y' Then '삭제'                     ELSE code.code_nm                END AS code_nm               ,upd_mem.nm_kor AS upd_nm_kor /* 담당선생님 */               ,CONCAT(manage_mem.nm_kor,  '<br />(' , manage_mem.login_id, ')') AS manage_info               ,manage_dt               ,pb.result_code                ,CASE WHEN pur_ref.device_return_gbn = 'Y' THEN '기기반납'                     WHEN pur_ref.device_return_gbn = 'N' THEN '기기양도'                     WHEN pur_ref.device_return_gbn = 'U' THEN '해당없음'                END AS device_return_gbn_nm               ,h.code_nm AS purchase_device_gbn /* 구매단말기구분 */               ,tdm.model_gbn as model_gbn /* 기기구분 */               ,uf_code_nm(10230,tdm.model_gbn) as model_gbn_nm /* 기기구분명 */               ,ishomedb.uf_purchase_side_delivery_info(pur.purchase_no) as side_info               , prd.service_reuse_yn         FROM ishomedb.tz_split_paid paid          LEFT OUTER JOIN ishomedb.tz_purchase pur          ON paid.purchase_no = pur.purchase_no         LEFT OUTER JOIN ishomedb.tz_purchase_batch pb         ON paid.split_paid_no = pb.split_paid_no         /* 신청자정보 */         LEFT JOIN ishomedb.tz_member p_mem         ON paid.parent_id = p_mem.user_id         /* 학습자정보 */         LEFT JOIN ishomedb.tz_member s_mem         ON paid.student_id = s_mem.user_id         /* 담당자 - 담당선생  */         LEFT JOIN ishomedb.tz_student mng_std         ON paid.student_id = mng_std.student_id         LEFT JOIN ishomedb.tz_member upd_mem         ON mng_std.teacher_id = upd_mem.user_id         /* 상품정보 */         LEFT JOIN ishomedb.tz_product prd         ON prd.product_no = paid.product_no         /* 출하상태  10118 */         LEFT JOIN ishomedb.tz_code purchase_code         ON pur.status_gbn = purchase_code.code_no         AND purchase_code.code_gbn = 10118         /* 월결제상태  10177 */         LEFT JOIN ishomedb.tz_code code         ON paid.paid_status = code.code_no         AND code.code_gbn = 10177         LEFT OUTER JOIN ishomedb.tz_teacher tec         ON tec.teacher_id = upd_mem.user_id         LEFT OUTER JOIN ishomedb.tz_teacher_team_part ttp         ON ttp.part_no = tec.part_no         /* 담당자 정보 */         LEFT JOIN ishomedb.tz_member manage_mem         ON paid.manage_id = manage_mem.user_id         /* 단말기 반납여부 */         LEFT JOIN ishomedb.tz_purchase_refund pur_ref         ON paid.purchase_no = pur_ref.purchase_no         /* 구매단말기구분  10218 */         LEFT OUTER JOIN ishomedb.tz_code h          ON h.code_no = pur.purchase_device_gbn AND h.use_yn = 'Y' AND h.code_gbn = 10218         /* 단말기 정보 */         LEFT OUTER JOIN ishomedb.tz_device i         ON pur.purchase_no = i.purchase_no         AND i.status_gbn IN (10002, 10005, 10007)         /* 모델구분 */         LEFT OUTER JOIN ishomedb.tz_device_model tdm         ON i.model_code = tdm.model_code                       WHERE  manage_mem.nm_kor LIKE CONCAT('박현아', '%')                           GROUP BY paid.split_paid_no         ORDER BY paid.split_paid_no DESC         LIMIT 340, 10; "
2015-05-04 02:31:30,ishome[ishome],192.168.150.80,202.835396,0.001743,0,0,"SELECT A.student_no               ,s_user_id               ,s_user_id AS user_id /* 안드로이드 접속정보 조회용 */               ,parent_id               ,teacher_id               ,s_nm_kor               ,p_nm_kor               ,group_nm               ,team_nm               ,part_nm               ,grade_gbn               ,gender                              ,s_user_id               ,s_login_id               ,p_login_id               ,s_tel               ,s_mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,last_dt               ,STR_TO_DATE(SUBSTRING(student_consult_info, 1, 16), '%Y%m%d%H:%i:%s') AS student_consult_dt               ,student_gbn_code.code_nm AS student_consult_gbn               ,SUBSTRING(student_consult_info, 22) AS student_consult_content               ,STR_TO_DATE(SUBSTRING(parent_consult_info, 1, 16), '%Y%m%d%H:%i:%s') AS parent_consult_dt               ,parent_gbn_code.code_nm AS parent_consult_gbn               ,SUBSTRING(parent_consult_info, 22) AS parent_consult_content               ,status               ,product_nm               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status               ,product_no               ,web_start_de               ,web_end_de               ,first_login_dt                       ,  (SELECT 100*(SUM(CASE WHEN act.clear_dt IS NULL THEN 0 ELSE 1 END)/COUNT(lpm.module_no))                 FROM ishomedb.tz_lms_plan_module lpm                 LEFT OUTER JOIN ishomedb.tz_lms_act_module act                 ON lpm.student_no = act.student_no                 AND lpm.plan_de = act.plan_de                 AND lpm.module_no = act.module_no                 WHERE lpm.student_no = A.student_no                     AND lpm.plan_de >= '2015.04.28'                     AND lpm.plan_de <= '2015.05.04'                 GROUP BY lpm.student_no                ) AS act_rate_week                 ,  (SELECT 100*(SUM(CASE WHEN act.clear_dt IS NULL THEN 0 ELSE 1 END)/COUNT(lpm.module_no))                 FROM ishomedb.tz_lms_plan_module lpm                 LEFT OUTER JOIN ishomedb.tz_lms_act_module act                 ON lpm.student_no = act.student_no                 AND lpm.plan_de = act.plan_de                 AND lpm.module_no = act.module_no                 WHERE lpm.student_no = A.student_no                     AND lpm.plan_de >= '2015.04.05'                     AND lpm.plan_de <= '2015.05.04'                 GROUP BY lpm.student_no                ) AS act_rate_month                  ,cp_reg_dt                   ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day29 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day30 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day1 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day6         ,              (SELECT stat_day2 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day7         ,              (SELECT stat_day3 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day8         ,              (SELECT stat_day4 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day9         ,              '-'                       as stat_day10         ,              '-'                       as stat_day11         ,                         '-'                       as stat_day12         ,                         '-'                      as stat_day13         ,              '-'                       as stat_day14                                FROM (             SELECT s.user_id AS s_user_id                 ,s.nm_kor AS s_nm_kor                 ,s.parent_id                 ,s.login_id AS s_login_id                 ,p.user_id AS p_user_id                 ,p.nm_kor AS p_nm_kor                 ,p.login_id AS p_login_id                 ,s.blacklist_yn                 ,CONCAT(s.tel1, '-', s.tel2, '-', s.tel3) AS s_tel                 ,CONCAT(s.mobile1, '-', s.mobile2, '-', s.mobile3) AS s_mobile                                ,CASE WHEN s.gender = 'M' THEN '남'                       WHEN s.gender = 'F' THEN '여'                       ELSE '-'                  END AS gender                                ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = stu.group_no), '미지정') AS group_nm                 ,stu.student_no                 ,stu.teacher_id                 ,ttt.team_nm                 ,ttp.part_nm                 ,stu.grade_gbn                 ,CASE WHEN s.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보. 이영무 */                             'Android'                       WHEN COALESCE(cs.user_id, -1) > 0 THEN 'ON'                       ELSE 'OFF'                  END AS status                 ,s.user_gbn_cls /* 안드로이드 사용자 구분용. 이영무 */                 ,(SELECT MAX(login_dt) FROM ishomedb.tz_connect_log WHERE user_id = stu.student_id) AS last_dt                 ,                  (                   SELECT                    MAX(CONCAT(DATE_FORMAT(consult_org_dt, '%Y%m%d%H:%i:%s'), IFNULL(consult_gbn, 'ZZZZZ'), substring(content, 1, 30) ))                    FROM ishomedb.tz_lms_consult con                      WHERE student_no = stu.student_no                          AND target_id=s.user_id                         AND content IS NOT NULL                 ) AS student_consult_info                 ,                 (                   SELECT                    MAX(CONCAT(DATE_FORMAT(consult_org_dt, '%Y%m%d%H:%i:%s'), IFNULL(consult_gbn, 'ZZZZZ'), substring(content, 1, 30) ))                    FROM ishomedb.tz_lms_consult                       WHERE student_no = stu.student_no                          AND target_id=p.user_id                         AND content IS NOT NULL                 ) AS parent_consult_info                 ,IFNULL(stu.manage_start_de, '9999.99.99') AS manage_start_de                 ,DATE_FORMAT(stu.start_de, '%Y.%m.%d') AS start_de                 ,DATE_FORMAT(stu.end_de, '%Y.%m.%d') AS end_de                 ,ishomedb.uf_study_product_nm(stu.student_no) as product_nm                 ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                 ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                 ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                 ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                 ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                 ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                 ,pur.product_no                 ,DATE_FORMAT(stu.web_start_de, '%Y.%m.%d') AS web_start_de                 ,DATE_FORMAT(stu.web_end_de, '%Y.%m.%d') AS web_end_de                 ,(SELECT DATE_FORMAT(MIN(login_dt), '%Y.%m.%d %H:%i:%s') FROM tz_connect_log WHERE user_id = s.user_id) AS first_login_dt                 ,(SELECT reg_dt  				 	FROM ishomedb.tz_complain  					WHERE  						student_id = stu.student_id  						AND use_yn = 'Y'  					ORDER BY idx DESC  					LIMIT 1) AS cp_reg_dt             FROM ishomedb.tz_student stu             INNER JOIN ishomedb.tz_purchase_student pch             ON pch.temp_student_no = stu.student_no             INNER JOIN ishomedb.tz_purchase pur             ON pur.purchase_no = pch.purchase_no             INNER JOIN tz_product pd             ON pur.product_no = pd.product_no                           INNER JOIN ishomedb.tz_member s             ON stu.student_id = s.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = s.parent_id             INNER JOIN ishomedb.tz_teacher d             ON d.teacher_id = stu.teacher_id             LEFT OUTER JOIN ishomedb.tz_teacher_team_part ttp             ON ttp.part_no = d.part_no             LEFT OUTER JOIN ishomedb.tz_teacher_team ttt             ON ttt.team_no = ttp.team_no                     LEFT OUTER JOIN ishomedb.tz_connect_session cs             ON cs.user_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = stu.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de                                WHERE 1=1             AND IFNULL(s.user_gbn_cls, '10001') != '10002'             AND IFNULL(p.user_gbn_cls, '10001') != '10002'                                         AND IFNULL(stu.end_de, NOW())  >=  DATE_FORMAT(NOW(), '%Y-%m-%d')                                                                                                             AND ttt.team_no = '###'                                                                                                                                   GROUP BY student_no         ) A         LEFT OUTER JOIN tz_code student_gbn_code ON student_gbn_code.code_gbn = '10130' AND student_gbn_code.code_no = SUBSTRING(student_consult_info, 17, 5)         LEFT OUTER JOIN tz_code parent_gbn_code ON parent_gbn_code.code_gbn = '10130' AND parent_gbn_code.code_no = SUBSTRING(parent_consult_info, 17, 5)                    ORDER BY manage_start_de DESC                                                                                                                                                                                                                            LIMIT   0, 100; "
2015-05-04 02:31:30,ishome[ishome],192.168.150.80,223.243549,0.000116,7,6742,"SELECT  group_no AS code                ,group_nm AS label         FROM   ishomedb.tz_student_group          WHERE  teacher_id = '321941'         ORDER  BY group_nm ASC; "
2015-05-04 02:31:31,ishome[ishome],192.168.150.41,167.712914,0.001685,111,206693,"SELECT student_no               ,student_id               ,parent_id               ,teacher_id               ,group_nm               ,grade_gbn               ,gender                              ,user_id               ,login_id               ,p_login_id               ,p_nm_kor               ,nm_kor               ,tel               ,mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,pur_start_de               ,pur_end_de               ,product_no               ,last_dt               ,student_consult_dt               ,student_consult_gbn               ,student_consult_content               ,parent_consult_dt               ,parent_consult_gbn               ,parent_consult_content               ,product_nm               ,status               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status                   ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day29 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day30 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day1 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day6         ,              (SELECT stat_day2 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day7         ,              (SELECT stat_day3 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day8         ,              (SELECT stat_day4 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day9         ,              '-'                       as stat_day10         ,              '-'                       as stat_day11         ,                         '-'                       as stat_day12         ,                         '-'                      as stat_day13         ,              '-'                       as stat_day14                       FROM (               SELECT a.student_no                   ,a.student_id                   ,c.parent_id                   ,a.teacher_id                   ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm                   ,a.grade_gbn                   ,CASE WHEN c.gender = 'M' THEN '남'                         WHEN c.gender = 'F' THEN '여'                         ELSE '-'                   END AS gender                                  ,c.user_id                   ,c.login_id                   ,p.login_id AS p_login_id                   ,p.nm_kor AS p_nm_kor                   ,c.nm_kor                   ,CONCAT(c.tel1,'-',c.tel2,'-',c.tel3) AS tel                   ,CONCAT(c.mobile1,'-',c.mobile2,'-',c.mobile3) AS mobile                   ,c.blacklist_yn                   ,IFNULL(a.manage_start_de,'9999.99.99') as manage_start_de                   ,DATE_FORMAT(a.start_de, '%Y.%m.%d') AS start_de                   ,DATE_FORMAT(a.end_de, '%Y.%m.%d') AS end_de                   ,DATE_FORMAT(pur.start_de, '%Y.%m.%d') AS pur_start_de                   ,DATE_FORMAT(pur.end_de, '%Y.%m.%d') AS pur_end_de                   ,pur.product_no                   ,(SELECT MAX(login_dt)   FROM ishomedb.tz_connect_log WHERE user_id = a.student_id) AS last_dt                   ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=c.user_id                      AND content IS NOT NULL) AS student_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=c.user_id                      AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=c.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_content                         ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=p.user_id                       AND content IS NOT NULL) AS parent_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=p.user_id                     AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=p.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_content                   ,ishomedb.uf_study_product_nm(a.student_no) as product_nm                   ,CASE WHEN c.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보 */                         'Android'                         WHEN COALESCE(s.user_id, -1) > 0 THEN 'ON'                          ELSE 'OFF'                     END AS status                                      ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                   ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                   ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                   ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                   ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                   ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                   ,tee.app_reason             FROM ishomedb.tz_student a                             	            INNER JOIN ishomedb.tz_purchase_student pch 	            ON a.student_no = pch.temp_student_no 	            INNER JOIN ishomedb.tz_purchase pur 	            ON pch.purchase_no = pur.purchase_no 	            INNER JOIN tz_product pd 	            ON pur.product_no = pd.product_no 	                                        AND pd.service_com_yn = 'Y'                               INNER JOIN ishomedb.tz_member c             ON a.student_id = c.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = c.parent_id             INNER JOIN ishomedb.tz_teacher d             ON a.teacher_id = d.teacher_id             LEFT OUTER JOIN ishomedb.tz_connect_session s             ON a.student_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = a.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de             LEFT OUTER JOIN ishomedb.tz_experience tee              ON tee.purchase_no = pur.purchase_no and tee.parent_id = pur.purchase_no and tee.student_id = pur.student_id                            WHERE               c.search_yn = 'Y'             AND a.teacher_id = 343645             AND IFNULL(c.user_gbn_cls, '10001') != '10002'                                	             	              	                AND ( 	                    a.end_de is not null 	                    AND 	                    date_format(a.end_de, '%Y%m%d')   >=   date_format(NOW(), '%Y%m%d') 	                )  	                  	                                                                                                                                                                                                                                              GROUP BY a.student_no         ) A           ORDER BY manage_start_de DESC; "
2015-05-04 02:31:31,ishome[ishome],192.168.150.80,210.103163,0.001809,100,437816,"SELECT A.student_no               ,s_user_id               ,s_user_id AS user_id /* 안드로이드 접속정보 조회용 */               ,parent_id               ,teacher_id               ,s_nm_kor               ,p_nm_kor               ,group_nm               ,team_nm               ,part_nm               ,grade_gbn               ,gender                              ,s_user_id               ,s_login_id               ,p_login_id               ,s_tel               ,s_mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,last_dt               ,STR_TO_DATE(SUBSTRING(student_consult_info, 1, 16), '%Y%m%d%H:%i:%s') AS student_consult_dt               ,student_gbn_code.code_nm AS student_consult_gbn               ,SUBSTRING(student_consult_info, 22) AS student_consult_content               ,STR_TO_DATE(SUBSTRING(parent_consult_info, 1, 16), '%Y%m%d%H:%i:%s') AS parent_consult_dt               ,parent_gbn_code.code_nm AS parent_consult_gbn               ,SUBSTRING(parent_consult_info, 22) AS parent_consult_content               ,status               ,product_nm               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status               ,product_no               ,web_start_de               ,web_end_de               ,first_login_dt                       ,  (SELECT 100*(SUM(CASE WHEN act.clear_dt IS NULL THEN 0 ELSE 1 END)/COUNT(lpm.module_no))                 FROM ishomedb.tz_lms_plan_module lpm                 LEFT OUTER JOIN ishomedb.tz_lms_act_module act                 ON lpm.student_no = act.student_no                 AND lpm.plan_de = act.plan_de                 AND lpm.module_no = act.module_no                 WHERE lpm.student_no = A.student_no                     AND lpm.plan_de >= '2015.04.28'                     AND lpm.plan_de <= '2015.05.04'                 GROUP BY lpm.student_no                ) AS act_rate_week                 ,  (SELECT 100*(SUM(CASE WHEN act.clear_dt IS NULL THEN 0 ELSE 1 END)/COUNT(lpm.module_no))                 FROM ishomedb.tz_lms_plan_module lpm                 LEFT OUTER JOIN ishomedb.tz_lms_act_module act                 ON lpm.student_no = act.student_no                 AND lpm.plan_de = act.plan_de                 AND lpm.module_no = act.module_no                 WHERE lpm.student_no = A.student_no                     AND lpm.plan_de >= '2015.04.05'                     AND lpm.plan_de <= '2015.05.04'                 GROUP BY lpm.student_no                ) AS act_rate_month                  ,cp_reg_dt                   ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day29 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day30 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day1 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day6         ,              (SELECT stat_day2 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day7         ,              (SELECT stat_day3 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day8         ,              (SELECT stat_day4 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day9         ,              '-'                       as stat_day10         ,              '-'                       as stat_day11         ,                         '-'                       as stat_day12         ,                         '-'                      as stat_day13         ,              '-'                       as stat_day14                                FROM (             SELECT s.user_id AS s_user_id                 ,s.nm_kor AS s_nm_kor                 ,s.parent_id                 ,s.login_id AS s_login_id                 ,p.user_id AS p_user_id                 ,p.nm_kor AS p_nm_kor                 ,p.login_id AS p_login_id                 ,s.blacklist_yn                 ,CONCAT(s.tel1, '-', s.tel2, '-', s.tel3) AS s_tel                 ,CONCAT(s.mobile1, '-', s.mobile2, '-', s.mobile3) AS s_mobile                                ,CASE WHEN s.gender = 'M' THEN '남'                       WHEN s.gender = 'F' THEN '여'                       ELSE '-'                  END AS gender                                ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = stu.group_no), '미지정') AS group_nm                 ,stu.student_no                 ,stu.teacher_id                 ,ttt.team_nm                 ,ttp.part_nm                 ,stu.grade_gbn                 ,CASE WHEN s.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보. 이영무 */                             'Android'                       WHEN COALESCE(cs.user_id, -1) > 0 THEN 'ON'                       ELSE 'OFF'                  END AS status                 ,s.user_gbn_cls /* 안드로이드 사용자 구분용. 이영무 */                 ,(SELECT MAX(login_dt) FROM ishomedb.tz_connect_log WHERE user_id = stu.student_id) AS last_dt                 ,                  (                   SELECT                    MAX(CONCAT(DATE_FORMAT(consult_org_dt, '%Y%m%d%H:%i:%s'), IFNULL(consult_gbn, 'ZZZZZ'), substring(content, 1, 30) ))                    FROM ishomedb.tz_lms_consult con                      WHERE student_no = stu.student_no                          AND target_id=s.user_id                         AND content IS NOT NULL                 ) AS student_consult_info                 ,                 (                   SELECT                    MAX(CONCAT(DATE_FORMAT(consult_org_dt, '%Y%m%d%H:%i:%s'), IFNULL(consult_gbn, 'ZZZZZ'), substring(content, 1, 30) ))                    FROM ishomedb.tz_lms_consult                       WHERE student_no = stu.student_no                          AND target_id=p.user_id                         AND content IS NOT NULL                 ) AS parent_consult_info                 ,IFNULL(stu.manage_start_de, '9999.99.99') AS manage_start_de                 ,DATE_FORMAT(stu.start_de, '%Y.%m.%d') AS start_de                 ,DATE_FORMAT(stu.end_de, '%Y.%m.%d') AS end_de                 ,ishomedb.uf_study_product_nm(stu.student_no) as product_nm                 ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                 ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                 ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                 ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                 ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                 ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                 ,pur.product_no                 ,DATE_FORMAT(stu.web_start_de, '%Y.%m.%d') AS web_start_de                 ,DATE_FORMAT(stu.web_end_de, '%Y.%m.%d') AS web_end_de                 ,(SELECT DATE_FORMAT(MIN(login_dt), '%Y.%m.%d %H:%i:%s') FROM tz_connect_log WHERE user_id = s.user_id) AS first_login_dt                 ,(SELECT reg_dt  				 	FROM ishomedb.tz_complain  					WHERE  						student_id = stu.student_id  						AND use_yn = 'Y'  					ORDER BY idx DESC  					LIMIT 1) AS cp_reg_dt             FROM ishomedb.tz_student stu             INNER JOIN ishomedb.tz_purchase_student pch             ON pch.temp_student_no = stu.student_no             INNER JOIN ishomedb.tz_purchase pur             ON pur.purchase_no = pch.purchase_no             INNER JOIN tz_product pd             ON pur.product_no = pd.product_no                               AND pd.service_com_yn = 'Y'                               INNER JOIN ishomedb.tz_member s             ON stu.student_id = s.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = s.parent_id             INNER JOIN ishomedb.tz_teacher d             ON d.teacher_id = stu.teacher_id             LEFT OUTER JOIN ishomedb.tz_teacher_team_part ttp             ON ttp.part_no = d.part_no             LEFT OUTER JOIN ishomedb.tz_teacher_team ttt             ON ttt.team_no = ttp.team_no                     LEFT OUTER JOIN ishomedb.tz_connect_session cs             ON cs.user_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = stu.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de                                WHERE 1=1             AND IFNULL(s.user_gbn_cls, '10001') != '10002'             AND IFNULL(p.user_gbn_cls, '10001') != '10002'                                         AND IFNULL(stu.end_de, NOW())  >=  DATE_FORMAT(NOW(), '%Y-%m-%d')                                                                                                             AND ttt.team_no = '48'                                         AND ttp.part_no = '170'                                         AND stu.teacher_id = '321941'                                                                                                       GROUP BY student_no         ) A         LEFT OUTER JOIN tz_code student_gbn_code ON student_gbn_code.code_gbn = '10130' AND student_gbn_code.code_no = SUBSTRING(student_consult_info, 17, 5)         LEFT OUTER JOIN tz_code parent_gbn_code ON parent_gbn_code.code_gbn = '10130' AND parent_gbn_code.code_no = SUBSTRING(parent_consult_info, 17, 5)                                                                                                                                                                                                                                      ORDER BY act_rate_month ASC          LIMIT   0, 100; "
2015-05-04 02:38:15,ishome[ishome],192.168.150.80,289.598808,0.000545,10,280208,"SELECT qna.qna_no               ,mem.nm_kor               ,mem.login_id               ,IFNULL(grp.group_nm, '미지정') AS group_nm               ,ishomedb.uf_code_grade_nm(stu.grade_gbn) AS grade_gbn               ,(select nm_kor from ishomedb.tz_member mem where mem.user_id = stu.teacher_id) AS teacher_nm_kor               ,stu.student_no               ,stu.student_id               ,qna.question_content               ,qna.question_dt               ,qna.answer_dt               ,qna.toss_id               ,(select nm_kor from ishomedb.tz_member mem where mem.user_id = qna.toss_id) AS toss_nm_kor                 ,qna.toss_id               ,CASE WHEN qna.toss_id IS NOT NULL THEN '0'                      ELSE '1'                     END AS toss_gbn               ,qna.question_gbn         FROM ishomedb.tz_student stu         INNER   JOIN ishomedb.tz_member mem         ON      stu.student_id = mem.user_id         INNER JOIN ishomedb.tz_lms_qna qna         ON stu.student_no = qna.student_no         LEFT    OUTER JOIN ishomedb.tz_student_group grp         ON      stu.group_no = grp.group_no                                                                 ORDER   BY                                       qna.question_dt DESC                        LIMIT  0, 10; "
2015-05-04 02:38:15,ishome[ishome],192.168.150.80,270.588597,0.000255,1,0,"SELECT IFNULL(COUNT(a.f_errreport_id), 0)         FROM edubasestudydb.t_bank_errreport a         INNER JOIN edubasestudydb.t_test_problem tp         ON a.f_test_id = tp.f_test_id         AND a.f_problem_id = tp.f_problem_id         INNER JOIN edubasestudydb.t_test t         ON t.f_test_id = tp.f_test_id AND t.f_isdelete = 'N'         INNER JOIN ishomedb.tz_student s          ON a.f_user_cd = s.student_no         INNER JOIN ishomedb.tz_member m          ON s.student_id = m.user_id         LEFT  JOIN edubasestudydb.t_student_test stt         ON stt.f_test_id = t.f_test_id         AND stt.f_user_cd = s.student_no         LEFT JOIN ishomedb.tz_member mt         ON mt.user_id = s.teacher_id         /* 선생님 정보 */         LEFT OUTER JOIN ishomedb.tz_teacher tt          ON tt.teacher_id = s.teacher_id         /* 선생님 팀정보 */         LEFT OUTER JOIN ishomedb.tz_teacher_team_part ttp          ON ttp.part_no = tt.part_no          /* 선생님 파트정보 */         LEFT OUTER JOIN ishomedb.tz_teacher_team ttt ON ttt.team_no = ttp.team_no                           LEFT JOIN (             SELECT l.*             FROM ishomedb.tz_errreport_log l             LEFT JOIN ishomedb.tz_member m             ON l.reg_id = m.user_id               WHERE  1 = 1              GROUP BY l.errreport_id         ) l         ON a.f_errreport_id = l.errreport_id                                      WHERE  m.login_id = '###'                                                                                       AND s.teacher_id = 236215; "
2015-05-04 02:38:17,ishome[ishome],192.168.150.80,274.030878,0.001362,10,1243217,"SELECT a.f_stu_test_id 		    ,a.f_test_id 		    ,a.f_user_cd 		    ,a.f_point 		    ,a.f_ischeckpoint 		    ,c.f_subject_cd  /*과목CD */ 		    ,c.f_grade_cd    /*학년CD */ 		    ,c.f_kind_cd 		    ,date_format(a.f_test_dt, '%Y.%m.%d %H:%i:%s') f_test_dt /*평가일*/ 		    ,ifnull(date_format(a.f_checkpoint_dt, '%Y.%m.%d %H:%i:%s'), '미채점') f_checkpoint_dt /*채점일*/ 		    ,edubasestudydb.testNmCreate (c.f_grade_cd, c.f_term_cd, c.f_test_nm, c.f_no) f_test_nm 		    ,edubasestudydb.testNmCreateA(c.f_grade_cd, c.f_term_cd, c.f_test_nm, c.f_no) f_test_nm_all 		    ,m.login_id 		    ,m.nm_kor user_nm 		    ,a.student_no 		    ,a.student_id 		    ,mem.nm_kor as teacher_name   /* 선생님 성함 */ 		    ,a.teacher_id 		    ,x.f_caption f_kind_cd_nm    /*평가구분*/ 		    ,y.f_caption f_grade_cd_nm   /*학년구분*/ 		    ,z.f_caption f_subject_cd_nm /*과목구분*/ 		    ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm  		    ,c.f_problem_cnt 		    ,SUM(IF(stp.f_result='0', 0, 1)) AS r_cnt 		    ,SUM(IF(stp.f_result='0', 1, 0)) AS w_cnt 		FROM ( 		    SELECT st.* 		        ,ist.student_no 		        ,ist.student_id 		        ,ist.teacher_id 		        ,ist.group_no 		    FROM edubasestudydb.t_student_test st 		    INNER JOIN ( 		        SELECT MAX(f_stu_test_id) AS f_stu_test_id, s.* 		        FROM edubasestudydb.t_student_test st 		        INNER JOIN ishomedb.tz_student s  		        ON st.f_user_cd = s.student_no 		        INNER JOIN ishomedb.tz_teacher t 		        ON t.teacher_id = s.teacher_id 		        INNER JOIN ishomedb.tz_teacher_team_part ttp 		        ON ttp.part_no = t.part_no 		        WHERE DATE_FORMAT(IFNULL(s.end_de, NOW()), '%Y-%m-%d') >= DATE_FORMAT(NOW(), '%Y-%m-%d')                                       AND ttp.team_no = '7'                                                       		        GROUP BY f_test_id, f_user_cd 		    ) ist 		    ON st.f_stu_test_id = ist.f_stu_test_id 		) a 		INNER JOIN ishomedb.tz_purchase_student pch  		ON a.student_no = pch.temp_student_no 		INNER JOIN ishomedb.tz_purchase pur 		ON pch.purchase_no = pur.purchase_no 		INNER JOIN ishomedb.tz_member m 		ON a.student_id = m.user_id 		LEFT OUTER JOIN ishomedb.tz_member mem         ON a.teacher_id = mem.user_id     		INNER JOIN edubasestudydb.t_test c 		ON a.f_test_id = c.f_test_id 		INNER JOIN edubasestudydb.t_code_ref x 		ON c.f_kind_cd = CONCAT(x.f_group_id, x.f_detail_id) AND x.f_group_id = 'T1' 		INNER JOIN edubasestudydb.t_code_ref y  		ON c.f_grade_cd = CONCAT(y.f_group_id, y.f_detail_id) AND y.f_group_id = 'GR' 		INNER JOIN edubasestudydb.t_code_ref z  		ON c.f_subject_cd = CONCAT(z.f_group_id, z.f_detail_id) AND z.f_group_id = 'SB' 		LEFT OUTER JOIN edubasestudydb.t_student_test_problem stp 		ON stp.f_stu_test_id = a.f_stu_test_id 		WHERE IFNULL(pur.status_gbn, '') != 10010 /* 환불완료 제외 */                                 AND a.f_ischeckpoint = 'N'                     		  		  		          		GROUP BY a.f_stu_test_id         ORDER BY                    f_ischeckpoint DESC, f_test_dt DESC, c.f_grade_cd, c.f_term_cd, c.f_subject_cd, c.f_kind_cd, c.f_no                   LIMIT 0, 10; "
2015-05-04 02:43:35,ishome[ishome],192.168.150.80,212.937479,0.000178,1,3,"select  user_id                ,login_id                ,nm_kor                ,jumin_no1                ,tel1                ,tel2                ,tel3                ,mobile1                ,mobile2                ,mobile3                ,email                ,zipcode                ,addr1                ,addr2                ,(select reg_dt from ishomedb.tz_teacher where teacher_id = user_id) as reg_dt                ,(select recom_id from ishomedb.tz_teacher where teacher_id = user_id) as recom_id           from  ishomedb.tz_member          where  user_id = 281360; "
2015-05-04 02:43:35,ishome[ishome],192.168.150.80,214.116305,0.000090,571,1420,"SELECT  a.teacher_id AS code                ,par.nm_kor AS label                         FROM   ishomedb.tz_teacher a            LEFT OUTER JOIN ishomedb.tz_member par         ON   a.teacher_id = par.user_id                   WHERE  a.active_yn = "Y"; "
2015-05-04 02:43:35,ishome[ishome],192.168.150.80,211.325488,0.001114,1,1,"SELECT x.board_num               ,ADDDATE(DATE_FORMAT(x.reg_dt, '%Y%m%d'), x.new_days) - DATE_FORMAT(NOW(), '%Y%m%d') AS new_day               ,x.nm /* 게시글구분 - 1(공지글), 2(게시글) */               ,x.master_no               ,x.board_no               ,x.category_no               ,x.upper_no               ,x.ref_sort /* 답변정렬순서 */               ,x.ref_lvl /* 답변 레벨 */               ,x.title               ,x.content               ,x.top_yn /* 최상단 표시 여부 */               ,x.use_yn               ,x.summary               ,x.file_attach_cnt               ,IFNULL(x.read_cnt, 0) AS read_cnt               ,x.view_gbn /* 공개여부 */               ,x.reg_id               ,x.reg_dt               ,DATE_FORMAT(x.reg_dt, '%Y.%m.%d')as reg_date               ,x.user_nm               ,upd.nm_kor as nm_kor_upd               ,x.main_team               ,x.status /* 처리상황 */               ,x.as_status /* AS증상 */               ,(SELECT category_nm FROM ishomedb.tz_board_category WHERE category_no = x.category_no AND master_no = x.master_no) AS category_nm               ,(SELECT sort FROM ishomedb.tz_board_category WHERE category_no = x.category_no AND master_no = x.master_no) AS sort               ,mem.nm_kor               ,mem.login_id               ,mem.addr1               ,x.count_no /* 게시물 답변 갯수 */               ,x.recom_cnt               ,x.down_cnt               ,(SELECT DISTINCT upload_seq FROM ishomedb.tz_education_column_simage_file_seq WHERE upload_seq = x.sub_thumbnail_file_seq) AS sub_thumbnail_upload_seq /* 메인 썸네일 업로드 일련번호 */               ,(SELECT DISTINCT file_seq FROM ishomedb.tz_education_column_simage_file_seq WHERE upload_seq = x.sub_thumbnail_file_seq) AS sub_thumbnail_file_seq /* 메인 썸네일 파일 일련번호 */               ,upb.reg_id AS upper_reg_id               ,x.board_cnt               ,x.nickname               ,x.read_auth               ,x.sub_category_no               ,DATE_FORMAT(x.upd_dt, '%Y.%m.%d') as upd_date               ,x.upd_dt         FROM (             SELECT 1 AS nm                   ,NULL AS board_num                              ,bm.new_days                   ,b.master_no                   ,b.board_no                   ,b.category_no                   ,b.upper_no                   ,b.ref_sort                   ,b.ref_lvl                   ,b.title                   ,b.content                    ,b.top_yn                   ,b.summary                   ,b.file_seq                   ,b.file_attach_cnt                   ,b.sub_thumbnail_file_seq                   ,b.read_cnt                   ,b.view_gbn                   ,b.use_yn                   ,b.reg_id                   ,b.reg_dt                   ,b.upd_id                   ,b.user_nm                   ,c.code_nm as main_team                   ,b.status                   ,b.as_status                   ,b.read_auth                   ,b.upd_dt                   ,p.nickname                   ,(SELECT COUNT(1) FROM tz_board_recommend WHERE board_no = b.board_no) AS recom_cnt                   ,(SELECT SUM(download_cnt) FROM ishomedb.tz_board_file_seq WHERE upload_seq = b.file_seq) AS down_cnt                   ,(SELECT COUNT(1) FROM tz_board_comment WHERE board_no = b.board_no) AS board_cnt                   ,(SELECT COUNT(1) FROM ishomedb.tz_board WHERE upper_no = b.upper_no) AS count_no /* 게시물 답변 갯수 */                   ,b.sub_category_no             FROM ishomedb.tz_board b             LEFT JOIN ishomedb.tz_code c             ON b.main_team = c.code_no             AND c.code_gbn = '10168'             LEFT OUTER JOIN ishomedb.tz_board_master bm             ON b.master_no = bm.master_no             LEFT JOIN ishomedb.tz_profile p             ON b.reg_id = p.reg_id             WHERE b.top_yn = 'Y'                  AND b.master_no = '143'                      UNION ALL                      (SELECT 2 AS nm                             ,((          SELECT COUNT(b.board_no)         FROM ishomedb.tz_board b         LEFT JOIN tz_member m         ON b.reg_id = m.user_id         LEFT JOIN tz_member mu         ON b.upd_id = mu.user_id         LEFT JOIN tz_code c         ON b.main_team = c.code_no         AND c.code_gbn = '10168'         LEFT JOIN ishomedb.tz_profile p         ON b.reg_id = p.reg_id         INNER JOIN tz_board upb         ON ABS(b.upper_no) = upb.board_no                    WHERE  IFNULL(b.top_yn, 'N') = 'N'                                                    AND b.master_no = '143'                                                                                      /* 기간  start */             AND DATE_FORMAT(b.reg_dt,'%Y.%m.%d')  >=  DATE_FORMAT('2015.02.03', '%Y.%m.%d')                           /* 기간  end */             AND DATE_FORMAT(b.reg_dt,'%Y.%m.%d')  <=  DATE_FORMAT('2015.05.04', '%Y.%m.%d')             ) - 0 - (@rownum := @rownum + 1)) + 1 AS board_num /*게시글일련번호*/                                  ,bm.new_days                   ,b.master_no                   ,b.board_no                   ,b.category_no                   ,b.upper_no                   ,b.ref_sort                   ,b.ref_lvl                   ,b.title                   ,b.content                        ,b.top_yn                   ,b.summary                   ,b.file_seq                   ,b.file_attach_cnt                   ,b.sub_thumbnail_file_seq                   ,b.read_cnt                   ,IF(ref_lvl >= 1, (                       SELECT view_gbn FROM ishomedb.tz_board WHERE board_no = ABS(b.upper_no)                    ), view_gbn) AS view_gbn /* 답변글일 경우 상위 글의 공개 여부를 가져옴 */                   ,b.use_yn                   ,b.reg_id                   ,b.reg_dt                   ,b.upd_id                   ,b.user_nm                    ,c.code_nm                   ,b.status                   ,b.as_status                   ,b.read_auth                   ,b.upd_dt                   ,p.nickname                   ,(SELECT COUNT(1) FROM tz_board_recommend WHERE board_no = b.board_no) AS recom_cnt                   ,(SELECT SUM(download_cnt) FROM ishomedb.tz_board_file_seq WHERE upload_seq = b.file_seq) AS down_cnt                   ,(SELECT COUNT(1) FROM tz_board_comment WHERE board_no = b.board_no) AS board_cnt                   ,(SELECT COUNT(1) FROM ishomedb.tz_board WHERE upper_no = b.upper_no) AS count_no /* 게시물 답변 갯수 */                   ,b.sub_category_no             FROM ishomedb.tz_board b             LEFT JOIN ishomedb.tz_member m             ON b.reg_id = m.user_id             LEFT JOIN ishomedb.tz_member mu             ON b.upd_id = mu.user_id             LEFT JOIN ishomedb.tz_code c             ON b.main_team = c.code_no             AND c.code_gbn = '10168'             LEFT JOIN ishomedb.tz_board_master bm             ON b.master_no = bm.master_no             AND bm.master_no = '143'             LEFT JOIN ishomedb.tz_profile p             ON b.reg_id = p.reg_id                           INNER JOIN (SELECT @rownum := 0) rownum                                                    WHERE  IFNULL(b.top_yn, 'N') = 'N'                                                    AND b.master_no = '143'                                                                                      /* 기간  start */             AND DATE_FORMAT(b.reg_dt,'%Y.%m.%d')  >=  DATE_FORMAT('2015.02.03', '%Y.%m.%d')                           /* 기간  end */             AND DATE_FORMAT(b.reg_dt,'%Y.%m.%d')  <=  DATE_FORMAT('2015.05.04', '%Y.%m.%d')                                  ORDER BY b.upper_no, b.ref_sort                             LIMIT 0, 15             )         ) x         LEFT OUTER JOIN tz_member mem         ON x.reg_id = mem.user_id         LEFT OUTER JOIN tz_member upd         ON x.upd_id = upd.user_id         INNER JOIN tz_board upb         ON ABS(x.upper_no) = upb.board_no                       ORDER BY nm, upper_no, ref_sort; "
2015-05-04 02:43:35,ishome[ishome],192.168.150.80,237.644682,0.000659,25,6298,"SELECT tp.purchase_no                                   /* 주문번호 */         , CONCAT(prt.nm_kor,'(',prt.login_id,')') as prt_nm     /* 학부모이름(아이디) */         , CONCAT(stu.nm_kor,'(',stu.login_id,')') as stu_nm     /* 학습자이름(아이디) */         , tpp.product_nm                                        /* 상품명 */         , tp.start_de as start_de                               /* 학습기간 시작일 */         , tp.end_de as end_de                                   /* 학습기간 종료일 */                   , h.code_nm as status_gbn_nm                               /* 단말기상태 */         , i.code_nm as device_gbn_nm                               /* 기기구분 */         , prt.user_id         , ts.student_no         , ts.student_id         , tp.withdraw_invoice_no         , DATE_FORMAT(tp.withdraw_req_dt, '%Y-%m-%d') AS withdraw_req_dt         , tp.status_gbn as p_status_gbn         , td.status_gbn as d_status_gbn         , uf_code_nm(10118,tp.status_gbn) as p_status_gbn_nm         FROM ishomedb.tz_student ts         /* 구매정보 */         INNER JOIN ishomedb.tz_purchase tp          ON tp.student_id = ts.student_id          /* 상품정보 */         INNER JOIN ishomedb.tz_product tpp          ON tpp.product_no = tp.product_no         /* 기기정보 */         LEFT OUTER JOIN ishomedb.tz_device td          ON td.purchase_no = tp.purchase_no         /* 학생정보 */          INNER JOIN ishomedb.tz_member stu          ON stu.user_id = ts.student_id         /* 학부모정보 */         INNER JOIN ishomedb.tz_member prt          ON prt.user_id = stu.parent_id                 /* 단말기상태  10200 */         LEFT OUTER JOIN ishomedb.tz_code h          ON h.code_no = td.status_gbn AND h.code_gbn = 10200         /* 기기구분  10218 */         LEFT OUTER JOIN ishomedb.tz_code i          ON i.code_no = td.device_gbn AND i.code_gbn = 10218         /* 교사정보 */         LEFT OUTER JOIN ishomedb.tz_teacher tec         ON tec.teacher_id = ts.teacher_id         /* 교사팀/파트 정보 */         LEFT OUTER JOIN ishomedb.tz_teacher_team_part ttp         ON ttp.part_no = tec.part_no                    WHERE  (             (tp.status_gbn = 10006 and td.status_gbn = 10006)             OR              (             DATEDIFF(NOW(),tp.ship_dt) > 15 AND tp.end_de is null AND tp.status_gbn != 10016 AND tp.status_gbn != 10014             )                          OR              (             tp.status_gbn = 10016 OR td.status_gbn = 10003              )                          )                                                                                               AND tec.teacher_id = '281360'                 ORDER BY tp.purchase_dt DESC         LIMIT 0, 25; "
2015-05-04 10:26:45,ishome[ishome],192.168.150.80,6.120451,0.000592,3697,2857721,"SELECT a.f_stu_test_id 		    ,a.f_test_id 		    ,a.f_user_cd 		    ,a.f_point 		    ,a.f_ischeckpoint 		    ,c.f_subject_cd /*과목CD */ 		    ,c.f_grade_cd /*학년CD */ 		    ,c.f_kind_cd 		    ,DATE_FORMAT(a.f_test_dt, '%Y.%m.%d') f_test_dt /*평가일*/ 		    ,IFNULL(DATE_FORMAT(a.f_checkpoint_dt, '%Y.%m.%d'), '미채점') f_checkpoint_dt /*채점일*/ 	        ,CONCAT('[', SUBSTRING(c.f_grade_cd, -1), '-', SUBSTRING(c.f_term_cd, -1), ' ', z.f_caption,  	          CASE WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN '] ' 	               ELSE CONCAT(' ', SUBSTRING(lsl.order_key, 1, 2), '] ') 	          END,  	            CASE WHEN lsl.lesson_gbn = 10001 THEN CONCAT(lsl.sort, '.') 	                 WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN '' 	                 ELSE CONCAT(lsl.sort, '장.')  	            END,  	            CASE WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN c.f_test_nm 	                 WHEN CHAR_LENGTH(c.f_test_nm) > 12 THEN CONCAT(SUBSTRING(c.f_test_nm, 1, 9), '...')  	                 ELSE c.f_test_nm END,  	            CONCAT('(', c.f_no, '회차)')) AS f_test_nm 	        ,CONCAT('[', SUBSTRING(c.f_grade_cd, -1), '-', SUBSTRING(c.f_term_cd, -1), ' ', z.f_caption,  	          CASE WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN '] ' 	               ELSE CONCAT(' ', SUBSTRING(lsl.order_key, 1, 2), '] ') 	          END,  	            CASE WHEN lsl.lesson_gbn = 10001 THEN CONCAT(lsl.sort, '.') 	                 WHEN (lsl.lesson_gbn = 10002 OR lsl.lesson_gbn = 10003) THEN '' 	                 ELSE CONCAT(lsl.sort, '장.')  	            END, c.f_test_nm,  	            CONCAT('(', c.f_no, '회차)')) AS f_test_nm_all 		    ,m.login_id 		    ,m.user_id 		    ,m.nm_kor user_nm 		    ,a.student_no 		    ,a.teacher_id 		    ,x.f_caption f_kind_cd_nm    /*평가구분*/ 		    ,y.f_caption f_grade_cd_nm   /*학년구분*/ 		    ,z.f_caption f_subject_cd_nm /*과목구분*/ 		    ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm  		    ,c.f_problem_cnt             ,SUM(IF(stp.f_result='0', 0, 1)) AS r_cnt             ,SUM(IF(stp.f_result='0', 1, 0)) AS w_cnt 	    FROM ( 	        SELECT st.* 	            ,ist.student_no 	            ,ist.student_id 	            ,ist.teacher_id 	            ,ist.group_no 	        FROM edubasestudydb.t_student_test st 	        INNER JOIN ( 	            SELECT MAX(f_stu_test_id) AS f_stu_test_id, s.* 	            FROM edubasestudydb.t_student_test st 	            INNER JOIN ishomedb.tz_student s  	            ON st.f_user_cd = s.student_no 	            WHERE s.teacher_id = 3235                 AND DATE_FORMAT(IFNULL(s.end_de, NOW()), '%Y-%m-%d') >= DATE_FORMAT(NOW(), '%Y-%m-%d') 	            GROUP BY f_test_id, f_user_cd 	        ) ist 	        ON st.f_stu_test_id = ist.f_stu_test_id 	    ) a 		INNER JOIN ishomedb.tz_purchase_student pch  		ON a.student_no = pch.temp_student_no 		INNER JOIN ishomedb.tz_purchase pur 		ON pch.purchase_no = pur.purchase_no 		INNER JOIN ishomedb.tz_member m 		ON a.student_id = m.user_id     		INNER JOIN edubasestudydb.t_test c 		ON a.f_test_id = c.f_test_id         INNER JOIN ishomedb.tz_lcms_study_lesson lsl         ON lsl.subj_lesson_no = c.f_chapter_cd 		INNER JOIN edubasestudydb.t_code_ref x 		ON c.f_kind_cd = CONCAT(x.f_group_id, x.f_detail_id) AND x.f_group_id = 'T1' 		INNER JOIN edubasestudydb.t_code_ref y  		ON c.f_grade_cd = CONCAT(y.f_group_id, y.f_detail_id) AND y.f_group_id = 'GR' 		INNER JOIN edubasestudydb.t_code_ref z  		ON c.f_subject_cd = CONCAT(z.f_group_id, z.f_detail_id) AND z.f_group_id = 'SB' 		LEFT OUTER JOIN edubasestudydb.t_student_test_problem stp 		ON stp.f_stu_test_id = a.f_stu_test_id         WHERE IFNULL(pur.status_gbn, '') != 10010                                                  AND a.f_ischeckpoint = 'Y'                                                               AND c.f_kind_cd = 'T120'                                                       GROUP BY a.f_stu_test_id         ORDER BY                    f_ischeckpoint DESC, f_test_dt DESC, c.f_grade_cd, c.f_term_cd, c.f_subject_cd, c.f_kind_cd, c.f_no; "
2015-05-05 02:31:15,ishome[ishome],192.168.150.80,248.955228,0.000240,1,1,"SELECT  		IFNULL(plan_day1,'0') as plan_day1 		, IFNULL(plan_day2,'0') as plan_day2 		, IFNULL(plan_day3,'0') as plan_day3 		, IFNULL(plan_day4,'0') as plan_day4 		, IFNULL(plan_day5,'0') as plan_day5 		, IFNULL(plan_day6,'0') as plan_day6 		, IFNULL(plan_day7,'0') as plan_day7 		, IFNULL(plan_day8,'0') as plan_day8 		, IFNULL(plan_day9,'0') as plan_day9 		, IFNULL(plan_day10,'0') as plan_day10 		, IFNULL(plan_day11,'0') as plan_day11 		, IFNULL(plan_day12,'0') as plan_day12 		, IFNULL(plan_day13,'0') as plan_day13 		, IFNULL(plan_day14,'0') as plan_day14 		, IFNULL(plan_day15,'0') as plan_day15 		, IFNULL(plan_day16,'0') as plan_day16 		, IFNULL(plan_day17,'0') as plan_day17 		, IFNULL(plan_day18,'0') as plan_day18 		, IFNULL(plan_day19,'0') as plan_day19 		, IFNULL(plan_day20,'0') as plan_day20 		, IFNULL(plan_day21,'0') as plan_day21 		, IFNULL(plan_day22,'0') as plan_day22 		, IFNULL(plan_day23,'0') as plan_day23 		, IFNULL(plan_day24,'0') as plan_day24 		, IFNULL(plan_day25,'0') as plan_day25 		, IFNULL(plan_day26,'0') as plan_day26 		, IFNULL(plan_day27,'0') as plan_day27 		, IFNULL(plan_day28,'0') as plan_day28 		, IFNULL(plan_day29,'0') as plan_day29 		, IFNULL(plan_day30,'0') as plan_day30 		, IFNULL(plan_day31,'0') as plan_day31 		, COUNT(1) 		FROM tz_stat_lms_plan 		WHERE student_no = '198132' 		and plan_month = '2015-04'; "
2015-05-05 02:31:15,ishome[ishome],192.168.150.80,245.097489,0.001485,0,162,"SELECT   stt.f_stu_test_id                                               /* 평가결과 ID */                 ,stt.f_user_cd                                                   /* 사용자 CD */                 ,stt.f_test_id                                                   /* 평가지 ID */                 ,stt.f_ischeckpoint                                              /* 채점완료 YN */                 ,stt.f_isstatic                                                  /* 통계완료 YN */                 ,stt.f_test_time                                                 /* 시험시간 */                  ,stt.f_test_dt                                                   /* 응시일 */                 ,sbj.grade_gbn                                                   /* 학년명 */                 ,ishomedb.uf_code_nm(10101, sbj.subj_gbn ) AS subj_gbn_nm        /* 과목명 */                 ,DATE_FORMAT(stt.f_test_dt,  '%m/%d') AS test_date               /* 응시 월/일 */                 ,stt.f_checkpoint_dt                                             /* 채점일 */                 ,stt.f_point                                                     /* 점수 */                  ,floor(tsts.f_10avg) as f_10avg                                  /* 상쉬 10%점수 */                 ,tst.f_chapter_cd                                                /* 학습단원 No */                 ,tst.f_no                                                        /* 회차 */                 ,tst.f_kind_cd                                                   /* 평가종류 CD */                 ,edubasestudydb.testNmCreate(tst.f_grade_cd, tst.f_term_cd, tst.f_test_nm, tst.f_no) f_test_nm          /* 평가명 */                 ,edubasestudydb.testNmCreateA(tst.f_grade_cd, tst.f_term_cd, tst.f_test_nm, tst.f_no) f_test_nm_all     /* 평가명 */                            ,les.subj_lesson_nm                                              /* 목차명 */                  ,CASE WHEN sbj.semester_gbn = 3 THEN '공통'                       ELSE sbj.semester_gbn                  END AS semester_gbn_nm                                          /* 학기명 */                 ,CASE WHEN tst.f_kind_cd = 'T110' THEN '실력평가'                                                                              WHEN tst.f_kind_cd = 'T120' THEN '단원평가'                                                                              WHEN tst.f_kind_cd = 'T130' THEN '중간고사대비'                                                                            WHEN tst.f_kind_cd = 'T135' THEN '기말고사대비'                                                                            WHEN tst.f_kind_cd = 'T140' THEN '수학심화평가'                                                                            WHEN tst.f_kind_cd = 'T150' THEN '수학경시대비'                                                                      END AS f_kind_nm                                                                                    /* 평가 종류명 */                 ,(SELECT porting_value FROM ishomedb.tz_lcms_contents WHERE contents_no = pt1.contents_no ) AS url1 /* 시험보기 */                 ,(SELECT porting_value FROM ishomedb.tz_lcms_contents WHERE contents_no = pt2.contents_no ) AS url2 /* 틀린문제 채점결과/풀이보기 */                 ,(SELECT porting_value FROM ishomedb.tz_lcms_contents WHERE contents_no = pt3.contents_no ) AS url3 /* 채점결과/풀이보기 */                 ,(SELECT porting_value FROM ishomedb.tz_lcms_contents WHERE contents_no = pt4.contents_no ) AS url4 /* 평가분석표 */                 ,(SELECT porting_value FROM ishomedb.tz_lcms_contents WHERE contents_no = pt5.contents_no ) AS url5 /* 틀린문제 다시풀기 */                          ,(SELECT COUNT(a.f_test_dt)                                                                                            FROM   edubasestudydb.t_student_test a                                            INNER  JOIN edubasestudydb.t_test b                   ON     a.f_test_id = b.f_test_id                    		          		                AND     b.f_kind_cd IN ('T110','T120','T130','T135','T150')  		                                                   INNER  JOIN ishomedb.tz_lcms_study_lesson d                   ON     b.f_chapter_cd = d.subj_lesson_no                     INNER  JOIN edubasestudydb.t_static_test c                   ON     c.f_test_id = b.f_test_id                    WHERE  a.f_user_cd =  '198132'                   AND    DATE_FORMAT(a.f_test_dt,  '%m/%d') = DATE_FORMAT(stt.f_test_dt,  '%m/%d')                   ) AS f_test_dt_cnt           /* 동일 컬럼 수 */                                    ,CASE WHEN DAYNAME(stt.f_test_dt) = 0 THEN '월'                                                                             WHEN DAYNAME(stt.f_test_dt) = 1 THEN '화'                                                                             WHEN DAYNAME(stt.f_test_dt) = 2 THEN '수'                                                                             WHEN DAYNAME(stt.f_test_dt) = 3 THEN '목'                                                                             WHEN DAYNAME(stt.f_test_dt) = 4 THEN '금'                                                                             WHEN DAYNAME(stt.f_test_dt) = 5 THEN '토'                                                                             WHEN DAYNAME(stt.f_test_dt) = 6 THEN '일'                                                                        END AS test_week                              ,tst.f_problem_cnt                 ,SUM(IF(stp.f_result != '1', 0, 1)) AS right_cnt         FROM    edubasestudydb.t_student_test stt              INNER   JOIN edubasestudydb.t_test tst         ON      stt.f_test_id = tst.f_test_id                           AND     tst.f_kind_cd IN ('T110','T120','T130','T135','T150')                             INNER JOIN edubasestudydb.t_student_test_problem stp         ON stp.f_stu_test_id = stt.f_stu_test_id         INNER   JOIN ishomedb.tz_lcms_study_lesson les         ON      tst.f_chapter_cd = les.subj_lesson_no                   INNER   JOIN edubasestudydb.t_static_test tsts         ON      tsts.f_test_id = tst.f_test_id          LEFT   OUTER JOIN ishomedb.tz_lcms_subj sbj         ON      les.subj_no = sbj.subj_no                  LEFT    OUTER JOIN ishomedb.tz_lcms_prepare_test pt1         ON      pt1.subj_lesson_no = tst.f_chapter_cd         AND     pt1.useq = tst.f_no         AND     pt1.test_url_gbn = '10001'                  LEFT    OUTER JOIN ishomedb.tz_lcms_prepare_test pt2         ON      pt2.subj_lesson_no = tst.f_chapter_cd         AND     pt2.useq = tst.f_no          AND     pt2.test_url_gbn = '10002'                  LEFT    OUTER JOIN ishomedb.tz_lcms_prepare_test pt3         ON      pt3.subj_lesson_no = tst.f_chapter_cd         AND     pt3.useq = tst.f_no          AND     pt3.test_url_gbn = '10003'                  LEFT    OUTER JOIN ishomedb.tz_lcms_prepare_test pt4         ON      pt4.subj_lesson_no = tst.f_chapter_cd         AND     pt4.useq = tst.f_no         AND     pt4.test_url_gbn = '10004'                  LEFT    OUTER JOIN ishomedb.tz_lcms_prepare_test pt5         ON      pt5.subj_lesson_no = tst.f_chapter_cd         AND     pt5.useq = tst.f_no         AND     pt5.test_url_gbn = '10005'                  WHERE   stt.f_user_cd =  '198132'                                                   AND    DATE_FORMAT(stt.f_test_dt, '%Y') = '2015'                                  AND    DATE_FORMAT(stt.f_test_dt, '%m') = '02'                   GROUP BY f_stu_test_id         ORDER   BY stt.f_test_dt DESC, tst.f_kind_cd ASC, tst.f_chapter_cd ASC                 LIMIT   0, 10; "
2015-05-05 02:31:15,ishome[ishome],192.168.150.41,304.741798,0.000178,2,539,"SELECT t1.f_stu_test_id         FROM edubasestudydb.t_student_test t1          WHERE t1.f_test_id IN (             SELECT tst.f_test_id             FROM ishomedb.tz_lms_module modu             INNER JOIN ishomedb.tz_lcms_study_lesson les              ON modu.subj_lesson_no = les.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lms_module lm              ON lm.subj_lesson_no = les.subj_lesson_no             AND lm.module_no = modu.module_no AND lm.useq = modu.useq AND lm.head_gbn != '10001'             LEFT OUTER JOIN ishomedb.tz_lcms_prepare_test ppe              ON ppe.subj_lesson_no = les.subj_lesson_no AND ppe.useq = lm.useq AND ppe.test_url_gbn = '10001'             LEFT OUTER JOIN edubasestudydb.t_test tst             ON tst.f_chapter_cd = les.subj_lesson_no AND tst.f_no = ppe.useq             AND tst.f_kind_cd IN ('T110', 'T120', 'T130', 'T135') AND tst.f_isopen = 'Y'             WHERE modu.upper_no IN (86252,86254)         ) AND f_ischeckpoint = 'Y'         AND f_user_cd = '251578'; "
2015-05-05 02:31:15,ishome[ishome],192.168.150.80,272.191615,0.000082,4,4,"SELECT code_gbn           ,code_gbn_nm           ,use_yn           ,reg_id           ,reg_dt           ,reg_ip           ,upd_id           ,upd_dt           ,upd_ip       FROM ishomedb.tz_code_gbn     WHERE code_gbn IN ('10131','10132','10133','10136'); "
2015-05-05 02:31:15,ishome[ishome],192.168.150.41,274.029461,0.000561,6,60,"SELECT   sbj.subj_gbn                 ,pln.plan_de                 ,DATE_FORMAT(pln.plan_time, '%H') AS plan_hour                 ,DATE_FORMAT(pln.plan_time, '%i') AS plan_minute                 ,DATE_FORMAT(pln.plan_time, '%H:%i') AS plan_time                 ,modu.module_no                 ,sbj.grade_gbn                 ,sbj.semester_gbn                 ,ishomedb.uf_code_nm(10129, modu.head_gbn) AS head_gbn_nm                 ,les.subj_lesson_no 		        ,CASE WHEN modu.head_gbn = 10001 THEN CONCAT(CASE                                 WHEN les.subj_no = 174 OR les.subj_no = 175 THEN CONCAT(les.chapter_key, '장. ')                                 ELSE CASE                                     WHEN                                         les.use_chapter_key = 'Y'                                             AND les.contents_xml_type >= 'C'                                             AND (les.contents_xml_type != 'O'                                             AND les.contents_xml_type != 'N')                                     THEN                                         CONCAT(les.chapter_key, '장. ')                                     WHEN                                         les.use_chapter_key = 'N'                                             AND les.contents_xml_type >= 'C'                                             AND (les.contents_xml_type != 'O'                                             AND les.contents_xml_type != 'N')                                     THEN                                         CONCAT(les1.sort, '단원. ')                                     ELSE CONCAT(les.sort, '장. ')                                 END                             END,                             les.subj_lesson_nm)                      WHEN modu.head_gbn = 10005 AND sbj.subj_gbn = 10023 AND modu.useq = 1 THEN CONCAT(IF(les.subj_no = 174 || les.subj_no = 175, les.chapter_key, les.sort), '장. ', les.subj_lesson_nm, ' (실력기본)') 		            WHEN modu.head_gbn = 10005 AND sbj.subj_gbn = 10023 AND modu.useq = 2 THEN CONCAT(IF(les.subj_no = 174 || les.subj_no = 175, les.chapter_key, les.sort), '장. ', les.subj_lesson_nm, ' (실력중급)') 		            WHEN modu.head_gbn = 10005 AND sbj.subj_gbn = 10023 AND modu.useq = 3 THEN CONCAT(IF(les.subj_no = 174 || les.subj_no = 175, les.chapter_key, les.sort), '장. ', les.subj_lesson_nm, ' (실력상급)') 					WHEN modu.head_gbn = 10005 AND sbj.subj_gbn != 10023 THEN CONCAT(IF(les.subj_no = 174 || les.subj_no = 175, les.chapter_key, les.sort), '장. ', les.subj_lesson_nm, ' (', modu.useq, '회차)')  		            WHEN modu.head_gbn = 10002 AND sbj.subj_gbn = 10023 AND modu.useq = 1 THEN CONCAT(les.sort, '. ', les.subj_lesson_nm, ' (단원중급)')  		            WHEN modu.head_gbn = 10002 AND sbj.subj_gbn = 10023 AND modu.useq = 2 THEN CONCAT(les.sort, '. ', les.subj_lesson_nm, ' (단원상급)')  		            WHEN modu.head_gbn = 10002 AND sbj.subj_gbn = 10023 AND modu.useq = 3 THEN CONCAT(les.sort, '. ', les.subj_lesson_nm, ' (단원기본)')  					WHEN modu.head_gbn = 10002 AND sbj.subj_gbn != 10023 THEN CONCAT(les.sort, '. ', les.subj_lesson_nm, ' (', modu.useq, '회차)')   		         END AS subj_lesson_nm                 ,CASE WHEN les.lesson_gbn = 10001 THEN '1'                                 ELSE                                    CASE WHEN (les.lesson_gbn = 10002 OR les.lesson_gbn = 10003) THEN '1'                                         ELSE '0'                                    END                            END AS lesson_gbn                                       ,act.act_dt                 ,act.clear_dt                 ,ishomedb.uf_code_nm(10101, sbj.subj_gbn) AS subj_gbn_nm         FROM    ishomedb.tz_lms_plan_module pln         INNER   JOIN ishomedb.tz_lms_module modu         ON      pln.module_no = modu.module_no         LEFT    OUTER JOIN ishomedb.tz_lms_act_module act         ON      pln.student_no = act.student_no         AND     pln.plan_de = act.plan_de         AND     pln.module_no = act.module_no         INNER   JOIN ishomedb.tz_lcms_study_lesson les         ON      modu.subj_lesson_no = les.subj_lesson_no                 LEFT OUTER JOIN             ishomedb.tz_lcms_study_lesson les1 ON les.upper_no = les1.subj_lesson_no         INNER   JOIN ishomedb.tz_lms_course cou         ON      modu.course_no = cou.course_no         INNER   JOIN ishomedb.tz_lcms_subj sbj         ON      cou.subj_no = sbj.subj_no         /* AND     sbj.use_yn = 'Y' 임시제거 (3,4학년 구교과/개정교과 같이 표시) */         WHERE   pln.student_no = '251578'         AND     pln.plan_de >= '2015.05.05'         AND     pln.plan_de <= '2015.08.05'                             AND  sbj.grade_gbn = '5'                             AND  sbj.semester_gbn = '1'                   ORDER   BY pln.plan_de ASC, sbj.subj_gbn ASC; "
2015-05-05 02:31:15,ishome[ishome],192.168.150.41,149.145522,0.001950,3,3708,"SELECT student_no               ,student_id               ,parent_id               ,teacher_id               ,group_nm               ,grade_gbn               ,gender                              ,user_id               ,login_id               ,p_login_id               ,p_nm_kor               ,nm_kor               ,tel               ,mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,pur_start_de               ,pur_end_de               ,product_no               ,last_dt               ,student_consult_dt               ,student_consult_gbn               ,student_consult_content               ,parent_consult_dt               ,parent_consult_gbn               ,parent_consult_content               ,product_nm               ,status               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status                   ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day29 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day30 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day1 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day6         ,              (SELECT stat_day2 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day7         ,              (SELECT stat_day3 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day8         ,              (SELECT stat_day4 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day9         ,              (SELECT stat_day5 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day10         ,              '-'                       as stat_day11         ,                         '-'                       as stat_day12         ,                         '-'                      as stat_day13         ,              '-'                       as stat_day14                       FROM (               SELECT a.student_no                   ,a.student_id                   ,c.parent_id                   ,a.teacher_id                   ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm                   ,a.grade_gbn                   ,CASE WHEN c.gender = 'M' THEN '남'                         WHEN c.gender = 'F' THEN '여'                         ELSE '-'                   END AS gender                                  ,c.user_id                   ,c.login_id                   ,p.login_id AS p_login_id                   ,p.nm_kor AS p_nm_kor                   ,c.nm_kor                   ,CONCAT(c.tel1,'-',c.tel2,'-',c.tel3) AS tel                   ,CONCAT(c.mobile1,'-',c.mobile2,'-',c.mobile3) AS mobile                   ,c.blacklist_yn                   ,IFNULL(a.manage_start_de,'9999.99.99') as manage_start_de                   ,DATE_FORMAT(a.start_de, '%Y.%m.%d') AS start_de                   ,DATE_FORMAT(a.end_de, '%Y.%m.%d') AS end_de                   ,DATE_FORMAT(pur.start_de, '%Y.%m.%d') AS pur_start_de                   ,DATE_FORMAT(pur.end_de, '%Y.%m.%d') AS pur_end_de                   ,pur.product_no                   ,(SELECT MAX(login_dt)   FROM ishomedb.tz_connect_log WHERE user_id = a.student_id) AS last_dt                   ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=c.user_id                      AND content IS NOT NULL) AS student_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=c.user_id                      AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=c.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_content                         ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=p.user_id                       AND content IS NOT NULL) AS parent_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=p.user_id                     AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=p.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_content                   ,ishomedb.uf_study_product_nm(a.student_no) as product_nm                   ,CASE WHEN c.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보 */                         'Android'                         WHEN COALESCE(s.user_id, -1) > 0 THEN 'ON'                          ELSE 'OFF'                     END AS status                                      ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                   ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                   ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                   ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                   ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                   ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                   ,tee.app_reason             FROM ishomedb.tz_student a                             	            INNER JOIN ishomedb.tz_purchase_student pch 	            ON a.student_no = pch.temp_student_no 	            INNER JOIN ishomedb.tz_purchase pur 	            ON pch.purchase_no = pur.purchase_no 	            INNER JOIN tz_product pd 	            ON pur.product_no = pd.product_no 	                                        AND pd.service_com_yn = 'Y'                               INNER JOIN ishomedb.tz_member c             ON a.student_id = c.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = c.parent_id             INNER JOIN ishomedb.tz_teacher d             ON a.teacher_id = d.teacher_id             LEFT OUTER JOIN ishomedb.tz_connect_session s             ON a.student_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = a.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de             LEFT OUTER JOIN ishomedb.tz_experience tee              ON tee.purchase_no = pur.purchase_no and tee.parent_id = pur.purchase_no and tee.student_id = pur.student_id                            WHERE               c.search_yn = 'Y'             AND a.teacher_id = 123491             AND IFNULL(c.user_gbn_cls, '10001') != '10002'                                	             	              	                AND ( 	                    a.end_de is not null 	                    AND 	                    date_format(a.end_de, '%Y%m%d')   >=   date_format(NOW(), '%Y%m%d') 	                )  	                  	                                                                                                                AND c.nm_kor   LIKE CONCAT('김민서', '%')                                                                                                                                                                                                                                                   GROUP BY a.student_no         ) A           ORDER BY manage_start_de DESC; "
2015-05-05 02:31:16,ishome[ishome],192.168.150.80,139.041653,0.001694,105,92183,"SELECT student_no               ,student_id               ,parent_id               ,teacher_id               ,group_nm               ,grade_gbn               ,gender                              ,user_id               ,login_id               ,p_login_id               ,p_nm_kor               ,nm_kor               ,tel               ,mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,pur_start_de               ,pur_end_de               ,product_no               ,last_dt               ,student_consult_dt               ,student_consult_gbn               ,student_consult_content               ,parent_consult_dt               ,parent_consult_gbn               ,parent_consult_content               ,product_nm               ,status               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status                   ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day29 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day30 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day1 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day6         ,              (SELECT stat_day2 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day7         ,              (SELECT stat_day3 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day8         ,              (SELECT stat_day4 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day9         ,              (SELECT stat_day5 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day10         ,              '-'                       as stat_day11         ,                         '-'                       as stat_day12         ,                         '-'                      as stat_day13         ,              '-'                       as stat_day14                       FROM (               SELECT a.student_no                   ,a.student_id                   ,c.parent_id                   ,a.teacher_id                   ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = a.group_no), '미지정') AS group_nm                   ,a.grade_gbn                   ,CASE WHEN c.gender = 'M' THEN '남'                         WHEN c.gender = 'F' THEN '여'                         ELSE '-'                   END AS gender                                  ,c.user_id                   ,c.login_id                   ,p.login_id AS p_login_id                   ,p.nm_kor AS p_nm_kor                   ,c.nm_kor                   ,CONCAT(c.tel1,'-',c.tel2,'-',c.tel3) AS tel                   ,CONCAT(c.mobile1,'-',c.mobile2,'-',c.mobile3) AS mobile                   ,c.blacklist_yn                   ,IFNULL(a.manage_start_de,'9999.99.99') as manage_start_de                   ,DATE_FORMAT(a.start_de, '%Y.%m.%d') AS start_de                   ,DATE_FORMAT(a.end_de, '%Y.%m.%d') AS end_de                   ,DATE_FORMAT(pur.start_de, '%Y.%m.%d') AS pur_start_de                   ,DATE_FORMAT(pur.end_de, '%Y.%m.%d') AS pur_end_de                   ,pur.product_no                   ,(SELECT MAX(login_dt)   FROM ishomedb.tz_connect_log WHERE user_id = a.student_id) AS last_dt                   ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=c.user_id                      AND content IS NOT NULL) AS student_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=c.user_id                      AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=c.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS student_consult_content                         ,(SELECT MAX(consult_org_dt) FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no                      AND target_id=p.user_id                       AND content IS NOT NULL) AS parent_consult_dt                 ,(SELECT code.code_nm                      FROM ishomedb.tz_lms_consult con                     LEFT JOIN tz_code code                     ON con.consult_gbn = code.code_no                     AND code.code_gbn = '10130'                     WHERE con.student_no = a.student_no AND target_id=p.user_id                     AND con.content IS NOT NULL                     ORDER BY con.consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_gbn                 ,(SELECT substring(content, 1, 30)                      FROM ishomedb.tz_lms_consult                      WHERE student_no = a.student_no AND target_id=p.user_id                     AND content IS NOT NULL                     ORDER BY consult_org_dt DESC                     LIMIT 1                  ) AS parent_consult_content                   ,ishomedb.uf_study_product_nm(a.student_no) as product_nm                   ,CASE WHEN c.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보 */                         'Android'                         WHEN COALESCE(s.user_id, -1) > 0 THEN 'ON'                          ELSE 'OFF'                     END AS status                                      ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                   ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                   ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                   ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                   ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                   ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                   ,tee.app_reason             FROM ishomedb.tz_student a                             	            INNER JOIN ishomedb.tz_purchase_student pch 	            ON a.student_no = pch.temp_student_no 	            INNER JOIN ishomedb.tz_purchase pur 	            ON pch.purchase_no = pur.purchase_no 	            INNER JOIN tz_product pd 	            ON pur.product_no = pd.product_no 	                                        AND pd.service_com_yn = 'Y'                               INNER JOIN ishomedb.tz_member c             ON a.student_id = c.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = c.parent_id             INNER JOIN ishomedb.tz_teacher d             ON a.teacher_id = d.teacher_id             LEFT OUTER JOIN ishomedb.tz_connect_session s             ON a.student_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = a.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de             LEFT OUTER JOIN ishomedb.tz_experience tee              ON tee.purchase_no = pur.purchase_no and tee.parent_id = pur.purchase_no and tee.student_id = pur.student_id                            WHERE               c.search_yn = 'Y'             AND a.teacher_id = 298102             AND IFNULL(c.user_gbn_cls, '10001') != '10002'                                	             	              	                AND ( 	                    a.end_de is not null 	                    AND 	                    date_format(a.end_de, '%Y%m%d')   >=   date_format(NOW(), '%Y%m%d') 	                )  	                  	                                                                                                                                                                                                                                              GROUP BY a.student_no         ) A           ORDER BY manage_start_de DESC; "
2015-05-05 02:38:08,ishome[ishome],192.168.150.80,236.794558,0.001399,0,0,"SELECT A.student_no               ,s_user_id               ,s_user_id AS user_id /* 안드로이드 접속정보 조회용 */               ,parent_id               ,teacher_id               ,s_nm_kor               ,p_nm_kor               ,group_nm               ,team_nm               ,part_nm               ,grade_gbn               ,gender                              ,s_user_id               ,s_login_id               ,p_login_id               ,s_tel               ,s_mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,last_dt               ,STR_TO_DATE(SUBSTRING(student_consult_info, 1, 16), '%Y%m%d%H:%i:%s') AS student_consult_dt               ,student_gbn_code.code_nm AS student_consult_gbn               ,SUBSTRING(student_consult_info, 22) AS student_consult_content               ,STR_TO_DATE(SUBSTRING(parent_consult_info, 1, 16), '%Y%m%d%H:%i:%s') AS parent_consult_dt               ,parent_gbn_code.code_nm AS parent_consult_gbn               ,SUBSTRING(parent_consult_info, 22) AS parent_consult_content               ,status               ,product_nm               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status               ,product_no               ,web_start_de               ,web_end_de               ,first_login_dt                       ,  (SELECT 100*(SUM(CASE WHEN act.clear_dt IS NULL THEN 0 ELSE 1 END)/COUNT(lpm.module_no))                 FROM ishomedb.tz_lms_plan_module lpm                 LEFT OUTER JOIN ishomedb.tz_lms_act_module act                 ON lpm.student_no = act.student_no                 AND lpm.plan_de = act.plan_de                 AND lpm.module_no = act.module_no                 WHERE lpm.student_no = A.student_no                     AND lpm.plan_de >= '2015.04.29'                     AND lpm.plan_de <= '2015.05.05'                 GROUP BY lpm.student_no                ) AS act_rate_week                 ,  (SELECT 100*(SUM(CASE WHEN act.clear_dt IS NULL THEN 0 ELSE 1 END)/COUNT(lpm.module_no))                 FROM ishomedb.tz_lms_plan_module lpm                 LEFT OUTER JOIN ishomedb.tz_lms_act_module act                 ON lpm.student_no = act.student_no                 AND lpm.plan_de = act.plan_de                 AND lpm.module_no = act.module_no                 WHERE lpm.student_no = A.student_no                     AND lpm.plan_de >= '2015.04.06'                     AND lpm.plan_de <= '2015.05.05'                 GROUP BY lpm.student_no                ) AS act_rate_month                  ,cp_reg_dt                   ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day29 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day30 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day1 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day6         ,              (SELECT stat_day2 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day7         ,              (SELECT stat_day3 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day8         ,              (SELECT stat_day4 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day9         ,              (SELECT stat_day5 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day10         ,              '-'                       as stat_day11         ,                         '-'                       as stat_day12         ,                         '-'                      as stat_day13         ,              '-'                       as stat_day14                                FROM (             SELECT s.user_id AS s_user_id                 ,s.nm_kor AS s_nm_kor                 ,s.parent_id                 ,s.login_id AS s_login_id                 ,p.user_id AS p_user_id                 ,p.nm_kor AS p_nm_kor                 ,p.login_id AS p_login_id                 ,s.blacklist_yn                 ,CONCAT(s.tel1, '-', s.tel2, '-', s.tel3) AS s_tel                 ,CONCAT(s.mobile1, '-', s.mobile2, '-', s.mobile3) AS s_mobile                                ,CASE WHEN s.gender = 'M' THEN '남'                       WHEN s.gender = 'F' THEN '여'                       ELSE '-'                  END AS gender                                ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = stu.group_no), '미지정') AS group_nm                 ,stu.student_no                 ,stu.teacher_id                 ,ttt.team_nm                 ,ttp.part_nm                 ,stu.grade_gbn                 ,CASE WHEN s.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보. 이영무 */                             'Android'                       WHEN COALESCE(cs.user_id, -1) > 0 THEN 'ON'                       ELSE 'OFF'                  END AS status                 ,s.user_gbn_cls /* 안드로이드 사용자 구분용. 이영무 */                 ,(SELECT MAX(login_dt) FROM ishomedb.tz_connect_log WHERE user_id = stu.student_id) AS last_dt                 ,                  (                   SELECT                    MAX(CONCAT(DATE_FORMAT(consult_org_dt, '%Y%m%d%H:%i:%s'), IFNULL(consult_gbn, 'ZZZZZ'), substring(content, 1, 30) ))                    FROM ishomedb.tz_lms_consult con                      WHERE student_no = stu.student_no                          AND target_id=s.user_id                         AND content IS NOT NULL                 ) AS student_consult_info                 ,                 (                   SELECT                    MAX(CONCAT(DATE_FORMAT(consult_org_dt, '%Y%m%d%H:%i:%s'), IFNULL(consult_gbn, 'ZZZZZ'), substring(content, 1, 30) ))                    FROM ishomedb.tz_lms_consult                       WHERE student_no = stu.student_no                          AND target_id=p.user_id                         AND content IS NOT NULL                 ) AS parent_consult_info                 ,IFNULL(stu.manage_start_de, '9999.99.99') AS manage_start_de                 ,DATE_FORMAT(stu.start_de, '%Y.%m.%d') AS start_de                 ,DATE_FORMAT(stu.end_de, '%Y.%m.%d') AS end_de                 ,ishomedb.uf_study_product_nm(stu.student_no) as product_nm                 ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                 ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                 ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                 ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                 ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                 ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                 ,pur.product_no                 ,DATE_FORMAT(stu.web_start_de, '%Y.%m.%d') AS web_start_de                 ,DATE_FORMAT(stu.web_end_de, '%Y.%m.%d') AS web_end_de                 ,(SELECT DATE_FORMAT(MIN(login_dt), '%Y.%m.%d %H:%i:%s') FROM tz_connect_log WHERE user_id = s.user_id) AS first_login_dt                 ,(SELECT reg_dt  				 	FROM ishomedb.tz_complain  					WHERE  						student_id = stu.student_id  						AND use_yn = 'Y'  					ORDER BY idx DESC  					LIMIT 1) AS cp_reg_dt             FROM ishomedb.tz_student stu             INNER JOIN ishomedb.tz_purchase_student pch             ON pch.temp_student_no = stu.student_no             INNER JOIN ishomedb.tz_purchase pur             ON pur.purchase_no = pch.purchase_no             INNER JOIN tz_product pd             ON pur.product_no = pd.product_no                           INNER JOIN ishomedb.tz_member s             ON stu.student_id = s.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = s.parent_id             INNER JOIN ishomedb.tz_teacher d             ON d.teacher_id = stu.teacher_id             LEFT OUTER JOIN ishomedb.tz_teacher_team_part ttp             ON ttp.part_no = d.part_no             LEFT OUTER JOIN ishomedb.tz_teacher_team ttt             ON ttt.team_no = ttp.team_no                     LEFT OUTER JOIN ishomedb.tz_connect_session cs             ON cs.user_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = stu.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de                                WHERE 1=1             AND IFNULL(s.user_gbn_cls, '10001') != '10002'             AND IFNULL(p.user_gbn_cls, '10001') != '10002'                                         AND IFNULL(stu.end_de, NOW())  >=  DATE_FORMAT(NOW(), '%Y-%m-%d')                                                                                                             AND ttt.team_no = '###'                                                                                                                                   GROUP BY student_no         ) A         LEFT OUTER JOIN tz_code student_gbn_code ON student_gbn_code.code_gbn = '10130' AND student_gbn_code.code_no = SUBSTRING(student_consult_info, 17, 5)         LEFT OUTER JOIN tz_code parent_gbn_code ON parent_gbn_code.code_gbn = '10130' AND parent_gbn_code.code_no = SUBSTRING(parent_consult_info, 17, 5)                    ORDER BY manage_start_de DESC                                                                                                                                                                                                                            LIMIT   0, 100; "
2015-05-06 02:38:37,ishome[ishome],192.168.150.41,130.349636,0.000285,1,5,"SELECT  a.teacher_id                 ,par.nm_kor                 ,a.work_de                 ,a.attend_dt                 ,a.leave_dt                 ,if(substring(a.work_de,9,9)  <  10,substring(a.work_de,10,10),substring(a.work_de,9,9)) AS  attnd_day                 ,b.part_no                 ,c.part_nm                 ,d.team_nm         FROM    ishomedb.tz_teacher_attend a            LEFT    OUTER JOIN ishomedb.tz_member par         ON      a.teacher_id = par.user_id                  LEFT    OUTER JOIN ishomedb.tz_teacher b         ON      a.teacher_id = b.teacher_id                  LEFT    OUTER JOIN ishomedb.tz_teacher_team_part c         ON      b.part_no = c.part_no                  LEFT    OUTER JOIN ishomedb.tz_teacher_team d         ON      c.team_no = d.team_no                    ORDER BY a.teacher_id,a.work_de         LIMIT 1; "
2015-05-06 10:58:21,ishome[ishome],192.168.150.80,19.384782,0.001700,100,15661837,"SELECT A.student_no               ,s_user_id               ,s_user_id AS user_id /* 안드로이드 접속정보 조회용 */               ,parent_id               ,teacher_id               ,s_nm_kor               ,p_nm_kor               ,group_nm               ,team_nm               ,part_nm               ,grade_gbn               ,gender                              ,s_user_id               ,s_login_id               ,p_login_id               ,s_tel               ,s_mobile               ,blacklist_yn               ,manage_start_de               ,start_de               ,end_de               ,last_dt               ,STR_TO_DATE(SUBSTRING(student_consult_info, 1, 16), '%Y%m%d%H:%i:%s') AS student_consult_dt               ,student_gbn_code.code_nm AS student_consult_gbn               ,SUBSTRING(student_consult_info, 22) AS student_consult_content               ,STR_TO_DATE(SUBSTRING(parent_consult_info, 1, 16), '%Y%m%d%H:%i:%s') AS parent_consult_dt               ,parent_gbn_code.code_nm AS parent_consult_gbn               ,SUBSTRING(parent_consult_info, 22) AS parent_consult_content               ,status               ,product_nm               ,plan_cnt + math_plan_cnt + theme_plan_cnt AS plan_cnt               ,act_cnt + math_act_cnt + theme_act_cnt AS act_cnt               ,CASE WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = 0 THEN ''                      WHEN plan_cnt + math_plan_cnt + theme_plan_cnt = act_cnt + math_act_cnt + theme_act_cnt THEN 'O'                     WHEN act_cnt + math_act_cnt + theme_act_cnt = 0 THEN 'X'                     ELSE 'U'                END AS study_status               ,product_no               ,web_start_de               ,web_end_de               ,first_login_dt                       ,  (SELECT 100*(SUM(CASE WHEN act.clear_dt IS NULL THEN 0 ELSE 1 END)/COUNT(lpm.module_no))                 FROM ishomedb.tz_lms_plan_module lpm                 LEFT OUTER JOIN ishomedb.tz_lms_act_module act                 ON lpm.student_no = act.student_no                 AND lpm.plan_de = act.plan_de                 AND lpm.module_no = act.module_no                 WHERE lpm.student_no = A.student_no                     AND lpm.plan_de >= '2015.04.30'                     AND lpm.plan_de <= '2015.05.06'                 GROUP BY lpm.student_no                ) AS act_rate_week                 ,  (SELECT 100*(SUM(CASE WHEN act.clear_dt IS NULL THEN 0 ELSE 1 END)/COUNT(lpm.module_no))                 FROM ishomedb.tz_lms_plan_module lpm                 LEFT OUTER JOIN ishomedb.tz_lms_act_module act                 ON lpm.student_no = act.student_no                 AND lpm.plan_de = act.plan_de                 AND lpm.module_no = act.module_no                 WHERE lpm.student_no = A.student_no                     AND lpm.plan_de >= '2015.04.07'                     AND lpm.plan_de <= '2015.05.06'                 GROUP BY lpm.student_no                ) AS act_rate_month                  ,cp_reg_dt                   ,              (SELECT stat_day26 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day1         ,              (SELECT stat_day27 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day2         ,              (SELECT stat_day28 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day3         ,              (SELECT stat_day29 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day4         ,              (SELECT stat_day30 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-04')                      as stat_day5         ,              (SELECT stat_day1 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day6         ,              (SELECT stat_day2 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day7         ,              (SELECT stat_day3 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day8         ,              (SELECT stat_day4 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day9         ,              (SELECT stat_day5 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day10         ,              (SELECT stat_day6 FROM tz_stat_lms_study_complete_mgnt WHERE student_no = A.student_no AND plan_month = '2015-05')                      as stat_day11         ,                         '-'                       as stat_day12         ,                         '-'                      as stat_day13         ,              '-'                       as stat_day14                                FROM (             SELECT s.user_id AS s_user_id                 ,s.nm_kor AS s_nm_kor                 ,s.parent_id                 ,s.login_id AS s_login_id                 ,p.user_id AS p_user_id                 ,p.nm_kor AS p_nm_kor                 ,p.login_id AS p_login_id                 ,s.blacklist_yn                 ,CONCAT(s.tel1, '-', s.tel2, '-', s.tel3) AS s_tel                 ,CONCAT(s.mobile1, '-', s.mobile2, '-', s.mobile3) AS s_mobile                                ,CASE WHEN s.gender = 'M' THEN '남'                       WHEN s.gender = 'F' THEN '여'                       ELSE '-'                  END AS gender                                ,IFNULL((SELECT group_nm FROM ishomedb.tz_student_group WHERE group_no = stu.group_no), '미지정') AS group_nm                 ,stu.student_no                 ,stu.teacher_id                 ,ttt.team_nm                 ,ttp.part_nm                 ,stu.grade_gbn                 ,CASE WHEN s.user_gbn_cls = '10004' THEN   /* 안드로이드 사용자 접속 정보. 이영무 */                             'Android'                       WHEN COALESCE(cs.user_id, -1) > 0 THEN 'ON'                       ELSE 'OFF'                  END AS status                 ,s.user_gbn_cls /* 안드로이드 사용자 구분용. 이영무 */                 ,(SELECT MAX(login_dt) FROM ishomedb.tz_connect_log WHERE user_id = stu.student_id) AS last_dt                 ,                  (                   SELECT                    MAX(CONCAT(DATE_FORMAT(consult_org_dt, '%Y%m%d%H:%i:%s'), IFNULL(consult_gbn, 'ZZZZZ'), substring(content, 1, 30) ))                    FROM ishomedb.tz_lms_consult con                      WHERE student_no = stu.student_no                          AND target_id=s.user_id                         AND content IS NOT NULL                 ) AS student_consult_info                 ,                 (                   SELECT                    MAX(CONCAT(DATE_FORMAT(consult_org_dt, '%Y%m%d%H:%i:%s'), IFNULL(consult_gbn, 'ZZZZZ'), substring(content, 1, 30) ))                    FROM ishomedb.tz_lms_consult                       WHERE student_no = stu.student_no                          AND target_id=p.user_id                         AND content IS NOT NULL                 ) AS parent_consult_info                 ,IFNULL(stu.manage_start_de, '9999.99.99') AS manage_start_de                 ,DATE_FORMAT(stu.start_de, '%Y.%m.%d') AS start_de                 ,DATE_FORMAT(stu.end_de, '%Y.%m.%d') AS end_de                 ,ishomedb.uf_study_product_nm(stu.student_no) as product_nm                 ,COUNT(DISTINCT lpm.module_no) AS plan_cnt                 ,COUNT(DISTINCT lph.category_no) AS math_plan_cnt                 ,COUNT(DISTINCT lpt.material_no) AS theme_plan_cnt                 ,COUNT(DISTINCT lam.clear_dt) AS act_cnt                 ,COUNT(DISTINCT lph.clear_dt) AS math_act_cnt                 ,COUNT(DISTINCT lpt.clear_dt) AS theme_act_cnt                 ,pur.product_no                 ,DATE_FORMAT(stu.web_start_de, '%Y.%m.%d') AS web_start_de                 ,DATE_FORMAT(stu.web_end_de, '%Y.%m.%d') AS web_end_de                 ,(SELECT DATE_FORMAT(MIN(login_dt), '%Y.%m.%d %H:%i:%s') FROM tz_connect_log WHERE user_id = s.user_id) AS first_login_dt                 ,(SELECT reg_dt  				 	FROM ishomedb.tz_complain  					WHERE  						student_id = stu.student_id  						AND use_yn = 'Y'  					ORDER BY idx DESC  					LIMIT 1) AS cp_reg_dt             FROM ishomedb.tz_student stu             INNER JOIN ishomedb.tz_purchase_student pch             ON pch.temp_student_no = stu.student_no             INNER JOIN ishomedb.tz_purchase pur             ON pur.purchase_no = pch.purchase_no             INNER JOIN tz_product pd             ON pur.product_no = pd.product_no                               AND pd.service_com_yn = 'Y'                               INNER JOIN ishomedb.tz_member s             ON stu.student_id = s.user_id             INNER JOIN ishomedb.tz_member p             ON p.user_id = s.parent_id             INNER JOIN ishomedb.tz_teacher d             ON d.teacher_id = stu.teacher_id             LEFT OUTER JOIN ishomedb.tz_teacher_team_part ttp             ON ttp.part_no = d.part_no             LEFT OUTER JOIN ishomedb.tz_teacher_team ttt             ON ttt.team_no = ttp.team_no                     LEFT OUTER JOIN ishomedb.tz_connect_session cs             ON cs.user_id = s.user_id             LEFT OUTER JOIN ishomedb.tz_lms_plan_module lpm             ON lpm.student_no = stu.student_no             AND DATE_FORMAT(DATE_ADD(NOW(), INTERVAL -1 DAY), '%Y%m%d') = DATE_FORMAT(lpm.plan_de, '%Y%m%d')             LEFT OUTER JOIN ishomedb.tz_lms_module lm             ON lm.module_no = lpm.module_no             LEFT OUTER JOIN ishomedb.tz_lms_act_module lam             ON lam.module_no = lm.module_no             AND lpm.plan_de = lam.plan_de             AND lpm.student_no = lam.student_no             LEFT OUTER JOIN ishomedb.tz_lcms_study_lesson lsl             ON lsl.subj_lesson_no = lm.subj_lesson_no             LEFT OUTER JOIN ishomedb.tz_lcms_plan_math lph             ON lpm.student_no = lph.student_no             AND lpm.plan_de = lph.plan_de             LEFT OUTER JOIN ishomedb.tz_lms_plan_theme lpt             ON lpm.student_no = lpt.student_no             AND lpm.plan_de = lpt.plan_de                                WHERE 1=1             AND IFNULL(s.user_gbn_cls, '10001') != '10002'             AND IFNULL(p.user_gbn_cls, '10001') != '10002'                                                       AND IFNULL(stu.end_de, NOW())  <  DATE_FORMAT(NOW(), '%Y-%m-%d')                                                                                               AND ttt.team_no = '43'                                         AND ttp.part_no = '159'                                         AND stu.teacher_id = '157'                                                                                                       GROUP BY student_no         ) A         LEFT OUTER JOIN tz_code student_gbn_code ON student_gbn_code.code_gbn = '10130' AND student_gbn_code.code_no = SUBSTRING(student_consult_info, 17, 5)         LEFT OUTER JOIN tz_code parent_gbn_code ON parent_gbn_code.code_gbn = '10130' AND parent_gbn_code.code_no = SUBSTRING(parent_consult_info, 17, 5)                    ORDER BY manage_start_de DESC                                                                                                                                                                                                                            LIMIT   0, 100; "
2015-05-06 11:23:21,ishome[ishome],192.168.150.41,12.358055,0.000532,25,18824123,"SELECT             tph.history_no,             tph.student_id,             tph.point,             uf_common_replaceHTML(tph.comment) AS comment,             tph.reg_dt,             tph.show_yn,             tph.top_yn,             tm.nm_kor,             tm.login_id,             DATE_FORMAT(tph.reg_dt,'%Y') AS reg_year         FROM             ishomedb.tz_point_history tph                 INNER JOIN             ishomedb.tz_member tm ON tph.student_id = tm.user_id                    WHERE  tph.guide_no = '83'                ORDER BY           tph.history_no DESC         LIMIT 0, 25; "
